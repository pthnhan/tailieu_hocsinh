


\chapter{Tổ hợp}
\Opensolutionfile{ans}[ans/ansToHop]
\section{Bài toán chia kẹo Euler và một số vấn đề liên quan}

 Trong tổ hợp, bài toán chia kẹo Euler hay còn được biết đến với tên gọi \textit{``stars and bars''} hoặc \textit{``balls and urns''} là một bổ đề, một kết quả hết sức quen thuộc. Nó cho ta biết số cách chia các viên kẹo giống nhau cho các em bé khác nhau, và để phân biệt hai cách chia kẹo, ta dựa vào số kẹo mà mỗi em bé có trong từng cách chia. Trong bài viết này, tác giả xin giới thiệu và phân loại một số tính huống cũng như cách tiếp cận vấn đề.
 
 
%\subsection{Tóm tắt lý thuyết}

 \subsection{Về bài toán chia kẹo Euler và lời giải}
 Trước hết, ta đếm số cách chia kẹo mà mỗi em đều có kẹo: \textit{Xếp $n$ viên kẹo lên một đường thẳng.}
 $$\ast\ast\ast\ast\ast\ast\ast\ast\ast\ast\ast\ast\ast\ast\ast\ast\ast$$
 Giữa các viên kẹo có đúng $n-1$ khoảng trống, ta tìm cách đặt các thanh chắn vào giữa chúng để chia các viên kẹo thành $k$ phần. Ta lấy phần đầu tiên chia cho em bé thứ nhất, phần thứ hai chia cho em bé thứ hai và cứ thế, phần cuối cùng chia cho em bé thứ $k$. Như thế thì rõ ràng số cách chia kẹo cũng chính là số cách đặt các thanh chắn ở trên.
 $$\ast\ast\ast\ast|\ast\ast\ast\ast|\ast\ast\ast\ast\ast\ast\ast\ast|\ast$$
 Chọn $k-1$ khoảng trống trong $n-1$ khoảng trống để đặt các thanh chắn, có  $\displaystyle{n-1 \choose k-1}$  cách. Đây cũng chính là đáp số cho bài toán.\\
 Trường hợp mỗi em không nhất thiết có kẹo, ta sẽ mượn thêm $n$ viên kẹo nữa rồi cho trước mỗi em $1$ viên, khi đó, ta đưa về đếm số cách chia thành các phần có số lượng phần tử dương và tổng phần tử là $n+k$. Kết quả là $\displaystyle{n+k-1 \choose n-1}$ \\
 Bài toán chia kẹo còn phát biểu dưới dạng tương đương như sau: \textit{Gọi $x_1,x_2,\ldots, x_k$ là số kẹo mà các em được chia thì}
 $$x_1+x_2+x_3+\cdots+x_k=n.$$
 Rõ ràng số cách chia kẹo cũng chính là số nghiệm (nguyên dương hoặc không âm) của phương trình trên.
 
 \subsection{Tổ hợp lặp của một tập hợp cho trước}
 Ta biết rằng, một bộ số gồm $k$ phần tử lấy ra từ $n$ phần tử phân biệt thỏa mãn $2$ điều kiện:
 \begin{itemize}
 	\item Không tính thứ tự.
 	\item Một phần tử có thể được chọn nhiều hơn một lần.
 \end{itemize} 
 Chính là một tổ hợp lặp chập $k$ của $n$ phần tử (còn gọi là \textit{đa tập} hay \textit{multiset}, vì nó cho phép một số xuất hiện nhiều lần).\\
 Để xác định số tổ hợp lặp này, ta có nhận xét rằng: \textit{Hai tổ hợp khác nhau khi có một số lượng một phần tử nào đó trong $n$ phần tử của chúng là khác nhau.}\\
 Gọi $x_1,x_2,\ldots,x_n$ lần lượt là số lần mà phần tử thứ $1,2,\ldots,n$ được chọn. Ta có hệ điều kiện
 $$\heva{&x_1,x_2,\ldots,x_n\in \mathbb{N}\\
 	&x_1+x_2+\cdots+x_n=k}$$
 Đây là phương trình được đề cập ở phần trên, và vì thế, số tổ hợp lặp chập $k$ của $n$ phần tử là $\displaystyle{n+k-1 \choose n-1} $ hay $\displaystyle{n+k-1 \choose k}$.
 
\subsection{Các bài toán áp dụng}
 Lập luận dạng trên cũng như kết quả đã nêu có khá nhiều ứng dụng trong các bài toán đếm tổ hợp. Dưới đây, ta sẽ cùng tìm hiểu một số ứng dụng như thế. Mở đầu bằng một số bài toán đơn giản, áp dụng trực tiếp công thức nghiệm của phương trình chia kẹo Euler.
 
 \begin{bt}%[Lê Thanh Hải, Dự án EX_TapChi04]%[9D0G2]
 Tính số nghiệm tự nhiên của các phương trình, bất phương trình sau
 \begin{enumerate}
 			\item $ x_1+x_2+x_3+x_4+x_5=2016 $ với $ x_1 \ge 5$, $x_2 \ge 4$, $x_3 \ge 3$, $x_4 \ge 2$, $x_5 \ge 1 $.
 			\item $ x_1+x_2+x_3+x_4+x_5+x_6=100 $ với $ x_i \,\vdots \,5, i=\overline{1,6}$.
 			\item $ x_1+x_2+x_3=1000 $ với $ x_1 \le 100 $.
 			\item $ x_1+x_2+x_3+x_4+x_5=2016 $ với $ x_i $ không chia hết cho $ 3 $, $ i=\overline{1,5} $.
 			\item $ x_1+x_2+x_3+x_4+x_5 \le 44  $.
 			\item $x_1+x_2+x_3=10  $ với $ x_3 \ne 3 $.
 			\item $ 100 \le  x_1+x_2+x_3+x_4+x_5+x_6 \le 200$.
 			\item $ (x_1+x_2+x_3)(y_1+y_2+y_3+y_4)=2017 $.
 \end{enumerate}
 	\loigiai{
 		\begin{enumerate}
 			\item Đặt $ y_1=x_1-5$, $y_2=x_2-4$, $y_3=x_3-3$, $y_4=x_4-2$, $y_5=x_5-1$ thì 
 			\[y_1+y_2+y_3+y_4+y+5=2001.\]
 			Số nghiệm là $ \displaystyle{2001+5-1 \choose 5-1} = {2005 \choose 4} $.
 			
 			\item Đặt $ x_i=5y_i,i=\overline{1,6}$ thì $ y_1+y_2+y_3+y_4+y_5+y_6=20 $. \\Số nghiệm là $\displaystyle{20+6-1 \choose 6-1} = {25 \choose 5}  $.
 			
 			\item Số nghiệm không âm của phương trình $ x_1+x_2+x_3=1000 $ là 
 			$$\displaystyle {1000+3-1 \choose 3-1} ={1002 \choose 2}.$$ Nếu $ x_1 \ge 101 $ thì đặt $ y_1=x_1-101 $, đưa về phương trình 
 			$$ y_1+x_2+x_3=899,$$
 			số nghiệm là $\displaystyle {901 \choose 2} $.
 			Do đó, số nghiệm của phương trình cần tìm là $\displaystyle {1002 \choose 2} -{901 \choose 2}$.
 			
 			\item Đặt $ x_i=3y_i+r_i $ với $ i=\overline{1,5} $ và $ 1 \le r_i \le 2, i = \overline{1,5} $. Vì $ 2016 \equiv 0 ~(\bmod~ 3)$ nên 
 			\[\heva{& r_1+r_2+r_3+r_4+r_5 \equiv 0 ~(\bmod~ 3) \\& 5 \le r_1+r_2+r_3+r_4+r_5  \le 10} \Rightarrow r_1+r_2+r_3+r_4+r_5 = 6 \text{ hoặc } 9 .\]  
 			Ta xét hai trường hợp
 			\begin{itemize}
 				\item  Nếu $ r_1+r_2+r_3+r_4+r_5 =6  $ thì có $ 4 $ số $ 1 $ và $ 1 $ số $ 2 $, chọn $ 4 $ số trong $ 5 $ số, có $\displaystyle {5 \choose 4} $ cách chọn. Ngoài ra, ta cũng có 
 				\[3(y_1+y_2+y_3+y_4+y_5)=2010 \Leftrightarrow y_1+y_2+y_3+y_4+y_5=670 .\]
 				Số nghiệm của phương trình trên là $\displaystyle {670+5-1 \choose 5-1} = {674 \choose 4} $. Trường hợp này có tổng cộng $\displaystyle {5 \choose 4} {674 \choose 4} $ nghiệm.
 				\item Nếu $  r_1+r_2+r_3+r_4+r_5 =9 $ thì có $ 4 $ số $ 2 $ và $ 1 $ số $ 1 $ nên tương tự, ta cũng có $\displaystyle {5 \choose 4} $ cách chọn. Ngoài ra, ta cũng có 
 				\[3(y_1+y_2+y_3+y_4+y_5)=2007 \Leftrightarrow y_1+y_2+y_3+y_4+y_5=669 .\]
 				Số nghiệm của phương trình trên là $\displaystyle {669+5-1 \choose 5-1} = {673 \choose 4} $. Trường hợp này có tổng cộng $\displaystyle {5 \choose 4} {673 \choose 4} $ nghiệm.
 			\end{itemize}
 			Vậy số nghiệm của phương trình ban đầu là
 			$\displaystyle {5 \choose 4} {674 \choose 4} + {5 \choose 4} {673 \choose 4}$.
 			\item Xét phương trình $x_1+x_2+x_3+x_4+x_5 +a =44  $ trong đó $ a $ là số tự nhiên thì rõ ràng số nghiệm của phương trình này bằng với số nghiệm của phương trình ban đầu. Do đó, số nghiệm cần tìm là $\displaystyle {44+6-1 \choose 6-1}={49 \choose 5}$.
 			\item Số nghiệm tùy ý của phương trình $ x_1+x_2+x_3=10 $ là $\displaystyle {10+3-1 \choose 3-1}={12 \choose 2}=66$. \\
 			Nếu $ x_3=3 $ thì ta đưa về xét $ x_1+x_2=7 $ với số nghiệm là $\displaystyle {7+2-1 \choose 2-1} = {8 \choose 1} =8$. \\
 			Số nghiệm cần tìm là $ 66-8=58$.
 			\item Tương tự, số nghiệm của bất phương trình $ x_1+x_2+x_3+x_4+x_5+x_6 \le 200$ là $\displaystyle {206 \choose 6} $. Ngoài ra, số nghiệm của bất phương trình $ x_1+x_2+x_3+x_4+x_5+x_6 \le 99 $ là $\displaystyle {105 \choose 6} .$\\
 			Vậy số nghiệm của bất phương trình đã cho là $\displaystyle {206 \choose 6} - {105 \choose 6}$.
 			\item Do $ 2017 $ là số nguyên tố nên ta chỉ có $ 2 $ trường hợp
 			\begin{itemize}
 				\item Nếu $ x_1+x_2+x_3=1 , y_1+y_2+y_3+y_4=2017$ có
 				\[ {1+3-1 \choose 3-1} {2017 +4-1 \choose 4-1}={3\choose 2}{2020 \choose 3} .\]
 				\item Nếu $ x_1+x_2+x_3=2017 , y_1+y_2+y_3+y_4=1$ có
 				\[{2017+3-1 \choose 3-1}{1+4-1\choose 4-1}={2019 \choose 2}{4 \choose 3}. \]
 			\end{itemize}
 			Vậy số nghiệm của phương trình là $\displaystyle {3\choose 2} {2020 \choose 3} +{2019 \choose 2} {4 \choose 3} .$
 		\end{enumerate}
 	}
 \end{bt}

 \begin{bt}%[Lê Thanh Hải, Dự án EX_TapChi04]%[9D0G8]
 Với $ k $ là số nguyên dương, xét $ a_1,a_2,\ldots,a_k $ là các số thực phân biệt. Ta đặt $\break A= \{ (a_i,n_i) | 1 \le i \le k \} $ là một multiset với cặp $ (a_i,n_i) $ cho biết số $ a_i $ xuất hiện $ n_i $ lần trong đó. Hỏi có bao nhiêu multiset $ B $ là tập con của $ A $, trong đó mỗi phần tử của $ B $ cũng là của $ A $ và số lần xuất hiện của nó trong $ B $ không nhiều hơn trong $ A $?
 	\loigiai{
 	Ta thấy multiset $ B $ có dạng $ B=\{(a_i,m_i)|1\le i \le k\} $ với $ 0 \le m_i \le n_i , i =\overline{1,k}$. Như thế, có $ n_i+1 $ cách chọn $ m_i$ và mỗi cách chọn như thế cho ta tập hợp $ B $ khác nhau nên số tập con cần tìm là $ (n_1+1)(n_2+1)\cdots (n_k+1) $.
  }
 \end{bt}

\begin{bt}%[Lê Thanh Hải, Dự án EX_TapChi04]%[9D0G4]
 Cho $ A=\{1,2,3,\ldots,n\} $. Chứng minh rằng tổng số các multiset có các phần tử lấy từ $ A $ và có số phần tử không vượt quá $ n $ thì chia hết cho $ n+1 $.
 \loigiai
 {
 Gọi $ x_1,x_2,\ldots,x_n $ là số lần xuất hiện của $ 1,2,\ldots,n $ trong multiset đã nêu thì
 \[x_1+x_2+\cdots +x_n \le n.\]
 Xét phương trình tương ứng là $ x_0+x_1+x_2+\cdots +x_n =n $ trong đó $ x_0$ chỉ chênh lệch của tổng $ x_1+x_2+\cdots +x_n $ và $ n $. Số nghiệm của phương trình này là
 \[{n+1+n-1 \choose n+1-1} = {2n \choose n}.\]
 Ta cần chứng minh rằng $ n+1 \mid \displaystyle{2n \choose n}  $. Ta có
 \begin{eqnarray*}
  \dfrac{1}{n+1}{2n \choose n} & = & \dfrac{(2n)!}{(n+1)n!n!}=\dfrac{(2n)!(n+1-n)!}{(n+1)n!n!} \\
  & = & \dfrac{(2n)!}{n!n!}-\dfrac{(2n)!}{(n+1)!(n-1)!} \\
  & = & {2n \choose n} - {2n \choose n+1}.
 \end{eqnarray*}
 Đẳng thức cuối cho ta điều phải chứng minh.
 }
\end{bt}
 
\begin{bt}%[Lê Thanh Hải, Dự án EX_TapChi04]%[9D0G8]
 Hỏi có bao nhiêu số tự nhiên có $7$ chữ số $\overline{a_1a_2a_3a_4a_5a_6a_7}$ thỏa mãn $$a_1\geq a_2\geq a_3\geq a_4\geq a_5\geq a_6\geq a_7?$$
 	\loigiai{
 		Ta thấy rằng số các số cần tìm chính là tổ hợp lặp chập $7$ của $10$ chữ số và là $\displaystyle {10+7-1 \choose 7}$. Nhưng phải trừ ra trường hợp toàn bộ là số $0$ nên đáp số là $\displaystyle {16\choose 7}-1=11439$.
 	}
 \end{bt}

\begin{bt}[Uzbekistan, 2012]%[Lê Thanh Hải, Dự án EX_TapChi04]%[9D0G8]
 Gọi $S$ là tập hợp các số tự nhiên có $6$ chữ số mà trong biểu diễn thập phân của nó có chữ số $7$. Biết rằng nếu $x\in S$ thì số $y$ tạo thành bằng cách hoán đổi các chữ số của $x$ sẽ không thuộc $S$. Tính giá trị lớn nhất của $|S|$.
 \loigiai
 {
 Với tính chất của tập hợp $S$, không mất tính tổng quát, ta có thể giả sử rằng tất cả các số thuộc tập hợp $S$ đều bắt đầu bằng số $7$. Khi đó, $5$ số còn lại là một tổ hợp có tính lặp của tập hợp $\{0,1,2,\ldots ,9 \}$ và để đạt được giá trị lớn nhất, ta sẽ chọn hết các tổ hợp lặp đó. Vậy kết quả cần tìm là $\displaystyle {10+5-1\choose 5}=2002$ số.
 }
\end{bt}
 
 \begin{bt}%[Lê Thanh Hải,Dự án EX_TapChi04]%[9D0G8]
 Trên một đoạn đường, có $11$ địa điểm bao gồm một trung tâm ở chính giữa và $10$ nơi để tham quan, mua sắm; hai địa điểm cạnh nhau thì cách nhau $100$ mét. Những người khách xuất phát từ trung tâm và muốn đi tham quan tổng cộng $3$ lượt, mỗi đi một nơi khác nhau (họ đến địa điểm đó tham quan sau đó quay về trung tâm và chuẩn bị cho lần đi tiếp theo). Hỏi có bao nhiêu cách chọn ra ba địa điểm, có thứ tự và không nhất thiết phân biệt, sao cho tổng quãng đường cả đi lẫn về không vượt quá $1$ km? 				
 	\loigiai{
 Ta có sơ đồ sau
 			\begin{center}
 				\begin{tikzpicture}
 				\tkzDefPoints{1/0/1,2/0/2,3/0/3,4/0/4,5/0/5,6/0/6,7/0/7,8/0/8,9/0/9,10/0/10,11/0/11}  
 				\tkzLabelPoints[above](2,4,6,8,10)
 				\tkzLabelPoints[below](1,3,5,7,9,11)
 				\tkzDrawSegments[line width=1.5pt,blue](1,11)
 				\tkzDrawPoints[size=12,color=black,fill=red](1,2,3,4,5,6,7,8,9,10,11) 
 				\tkzDrawPoints[size=18,fill=white!5!blue](6)
 				\end{tikzpicture}
 			\end{center}
 			Giả sử tọa độ của trung tâm là $0$ thì tọa độ các điểm tham quan là $-5$, $-4$, $-3$, $-2$, $-1$, $1$, $2$, $3$, $4$, $5$.
 			\\ Gọi $x$, $y$, $z$ là tọa độ của các nơi họ đến thì theo đề bài, ta có $$2(|x|+|y|+|z|)\leq 10,$$
 			hay $$|x|+|y|+|z|\leq 5.$$
 			Bất phương trình này có $${5-1\choose 3-1}+{4-1\choose 3-1}+{3-1\choose 3-1}=6+3+1=10,$$
 			nghiệm nguyên dương. Tuy nhiên, với mỗi giá trị $|x|$, $|y|$, $|z|$ ta đều có hai cách chọn là $-x$ hay $x$. Vì thế tổng số cách chọn là $2^3\cdot 10 =80$ cách.			
 	}
 \end{bt}

\begin{bt}%[Lê Thanh Hải, Dự án EX_TapChi04]%[9D0G8]
 Robinson Crusoe lạc trên đảo hoang hơn $28$ năm. Trong chừng ấy quãng thời gian, mỗi năm, ông ta tìm một cái cây nào đó rồi khắc lên thân nó một hình đa giác lồi thật lớn để kỷ niệm. Biết rằng tổng tất cả các góc của các đa giác lồi ấy vừa đúng $1687\pi$, năm mà ông ấy được cứu thoát, đưa trở về thế giới loài người. Bạn hãy cho biết có bao nhiêu cách ông khắc các đa giác lên cây thỏa mãn yêu cầu trên, biết rằng trong $10$ năm đầu tiên, mỗi năm, ông ấy khắc lên cây một đa giác có ít nhất $100$ cạnh.
 \loigiai
 {
 Đa giác có $n$ cạnh thì có tổng các góc trong là $(n-2)\pi$. Do đó, ta cần điểm số nghiệm của phương trình sau $$\heva{& \displaystyle\sum\limits_{i=1}^{28}(x_i-2)\pi=1687\pi, x_i\in \mathbb{N}\\& x_i\geq 100, i=\overline{1,10}, x_i\geq 3, i=\overline{11,28}.}$$
 Ta có $$\displaystyle\sum\limits_{i=1}^{28}(x_i-2)\pi=1687\pi \Leftrightarrow \displaystyle\sum\limits_{i=1}^{28}x_i=1743.$$
 Đặt $x_i=y_i+100, i=\overline{1,10}$ và $x_i=y_i+3,i=\overline{11,28}$, ta có phương trình $$\displaystyle\sum\limits_{i=1}^{10}y_i+10\cdot 100+\displaystyle\sum\limits_{i=11}^{28}+18\cdot 3=1743 \Leftrightarrow \displaystyle\sum\limits_{i=1}^{28}y_1=689.$$
 Vậy số nghiệm nguyên không âm của phương trình là $\displaystyle {689+28-1\choose 28-1}={716\choose 27}$.
 }
\end{bt}

\begin{bt}%[Trần Duy Khương, Dự án EX_TapChi04]%[1D0G6]
Có bao nhiêu xâu nhị phân có độ dài $20$ sao cho sau mỗi số $0$, có ít nhất $3$ chữ số $1$? 
 \loigiai
 {Ta thấy nếu có $x$ số $0$ trong xâu thì có thêm ít nhất $3x$ số $1$. Ngoài ra, ta phải có $x+3x\le 20$, tức $x \le 5$.\\
			Giả sử có $k$ số $0$ thì đặt $a_0,a_1,\ldots,a_k$ lần lượt là số các số $1$ nằm trước số $0$ thứ nhất, giữa số $0$ thứ nhất và thứ hai,$\ldots$, sau số $0$ cuối cùng. Ta phải có $a_0+a_1+\cdots+a_k=20-k$ và $a_1,a_2,\ldots,a_k\ge 3$.\\
			Đặt $b_i=a_i-3,i = \overline {1,k}$ thì ta đưa về $a_0+b_1+\cdots+b_k=20-4k$. Số nghiệm của phương trình này là $\displaystyle {20-4k+k \choose k}={20-3k \choose k}$.
			Do đó, số xâu nhị phân cần tìm là $5$.}
\end{bt}

\begin{bt}[Ấn Độ, 2012]%[Trần Duy Khương, Dự án EX_TapChi04]%[1D0G6]
 Cho tam giác $ABC$ và điểm $P$ gọi là \textit{tốt} nếu tìm được $27$ tia chung gốc $P$ cắt tam giác thành $27$ tam giác con có diện tích bằng nhau. Đếm số điểm tốt.
 \loigiai
 {
Trước hết ta thấy rằng $PA$, $PB$, $PC$ phải là $3$ trong $27$ tia nêu trong đề bài (nếu không thì sẽ có một phần trong các phần của tam giác $ABC$).\\
			Giả sử $S_{ABC}=27$ thì diện tích mỗi tam giác nhỏ đều bằng $1$.\\
			Đặt $S_{PBC}=x$, $S_{P CA}=y$, $S_{PAB}=z$ thì rõ ràng, các tam giác
			$PBC$, $PCA$, $PAB$ đều phải chứa trong đó một số nguyên các tam giác có diện tích bằng $1$ nên ta có $x,y,z\in \mathbb{Z}^+ $ và
			\begin{equation}\label{EXTCh4.TH.1}
			 x+y+z=27.
			\end{equation}
			Chú ý rằng với mỗi $P$ nằm trong tam giác thì 
			\[\overrightarrow{PA} \cdot S_{PBC}+\overrightarrow{PB} \cdot S_{PCA}+\overrightarrow{PC} \cdot S_{PAB}=\overrightarrow{0}\]
			và ngược lại với mỗi bộ $\left(S_{PBC},S_{PCA},S_{PAB}\right)$ như thế thì tồn tại duy nhất $P$ thỏa mãn.(Ở đây ta còn có thể chứng minh tính duy nhất này bằng cách kẻ các đường thăng song song với cạnh của tam giác).
			
			\begin{center}
				\begin{tikzpicture}[scale=0.8]
				\draw (-1.3,3.9)-- (-3.2,-2)-- (6,-2)-- (-1.3,3.9);
				\draw [dashed] (-1.3,3.9)-- (0,0)-- (-3.2,-2);
				\draw [dashed](0,0)-- (6,-2);
				\fill (-1.3,3.9) circle (.1) node [above]{$A$};
				\fill (-3.2,-2) circle (.1) node [below]{$B$};
				\fill (6,-2) circle (.1) node [below right]{$C$};
				\fill (0,0) circle (.1) node [below]{$P$};
				\node at (-1.4,1) {$z$};
				\node at (0.4,-1.2) {$x$};
				\node at (1,0.6) {$y$};
				\end{tikzpicture}
			\end{center}
		Vậy số điểm cần tìm chính là số nghiệm của phương trình \eqref{EXTCh4.TH.1} và là $\displaystyle {27-1 \choose 3-1}={26 \choose 2}=325$.}
\end{bt}

\begin{bt}%[Trần Duy Khương, Dự án EX_TapChi04]%[1D0G6]
Cho dãy số tự nhiên $\left( a_n \right)$ với $a_n=a_{\lfloor \frac{n}{3} \rfloor}+a_{\lceil \frac{n}{2} \rceil}$ với $n>3$. Hỏi có bao nhiêu dãy số như trên thỏa mãn điều kiện $a_1+a_2+a_3+a_4+a_5+a_6=15$? Kí hiệu $\lfloor x \rfloor$ là số nguyên lớn nhất lớn nhất không vượt quá $x$, còn $\lceil x \rceil$ là số nguyên nhỏ nhất không nhỏ hơn $x$.
	\loigiai
	{Theo giả thiết thì $a_4=a_1+a_2$, $a_5=a_1+a_3$, $a_6=a_2+a_3$. Do đó 
			\[a_1+a_2+a_3+a_4+a_5+a_6=15,\]
			tương đương với $3\left( a_1+a_2+a_3 \right)=15$ hay $a_1+a_2+a_3=5$ . Phương trình này có $\displaystyle {5+3-1 \choose 3-1}=21$ nghiệm tự nhiên, tương ứng với 21 dãy số thỏa mãn đề bài.
	}
\end{bt}

\begin{bt}[Tây Ban Nha, 2012]%[Trần Duy Khương, Dự án EX_TapChi04]%[1D0G6]
 Cho $x$ và $n$ là những số nguyên dương sao cho $1\le x\le n$. Người ta có $x+1$ cái hộp phân biệt và $n-x$ quả bóng giống nhau. Gọi $f\left( n,x\right)$ là số cách phân phối $n-x$ quả bóng vào $x+1$ hộp. Với $p$ là một số nguyên tố cho trước, hãy tìm số nguyên $n$ lớn hơn $1$ sao cho số nguyên tố $p$ là ước của $f \left( n,x\right)$ với mọi $x\in \left\{ 1;2;\ldots ;n-1 \right\}$.
 \loigiai
 {
 Theo công thức đã nêu, ta dễ dàng có được $f \left( n,x \right)=\displaystyle {n \choose x}$. Do đó, ta cần tìm $n$ sao cho $p \mid \displaystyle {n \choose x}$ với mọi $x\in \left\{ 1;2;\ldots ;n-1 \right\}$.\\
 Theo định lý Lucas thì 
 \[{n \choose x}\equiv {n_1 \choose x_1}{n_2 \choose x_2}{n_3 \choose x_3}\cdots {n_k \choose x_k} \; \pmod{p}\]
 trong đó $n_1,n_2,\ldots ,n_k$ và $x_1,x_2,\ldots ,x_k$ là các chữ số của $n$, $x$ trong biểu diễn $p$ phân. Nếu tồn tại một chữ số $n_i \ge 1$ thì tương ứng, ta chọn $x_i=0$ và tất cả các chữ số còn lại của $n$, $x$ giống nhau thì rõ ràng $\displaystyle {n \choose x} \not\equiv 0 \pmod{p}$, không thỏa mãn.\\
 Do đó, tất cả các chữ số của $n$, trừ chữ số đầu tiên, là phải khác $0$. Ngoài ra, chữ số đầu tiên của $n$ phải bằng $1$ vì nếu không, $n_1>1$ thì ta chọn $x_1=1$ cũng dẫn đến trường hợp không thỏa mãn.\\
 Suy ra $n=\overline{100\ldots 0}_{( p )}$ hay nói cách khác, $n$ là lũy thừa của $p$.
 }
\end{bt}

\begin{bt}[Trường Đông TPHCM, 2014]%[Trần Duy Khương, Dự án EX_TapChi04]%[1D0G6]
 Cho $n\ge 2$ là một số nguyên dương. Xét tập hợp các đường đi ngắn nhất trên lưới nguyên từ điểm $A\left( 0;0 \right)$ đến điểm $B\left( n;n \right)$ (độ dài đường đi là số lượng các bước đi). Một đường đi như thế sẽ tương ứng với một dãy gồm $n$ lệnh $T$ (lên trên) và $n$ lệnh $P$ (sang phải). Trong dãy đó, một cặp lệnh $\left( T,P \right)$ kề nhau được gọi là một bước chuyển (lưu ý, cặp $\left( P,T \right)$ không được gọi là bước chuyển). Ví dụ dãy $PTTPTPPT$ có $2$ bước chuyển. Hãy tìm số các đường đi từ $A$ đến $B$ sao cho có đúng:
	\begin{enumerate}
		\item $1$ bước chuyển.
		\item $2$ bước chuyển.
	\end{enumerate}
	\loigiai{\begin{enumerate}
			\item Ta phát biểu lại bài toán là: \textit{Cho xâu nhị phân có độ dài $2n$ với $n$ số $0$ và $n$ số $1$. Xác định số xâu nhị phân thỏa mãn cặp $10$ chỉ xuất hiện đúng một lần.}\\
			Gọi $A$ là các xâu nhị phân chứa toàn số $1$, $B$ là các xâu nhị phân chứa toàn số $0$. Rõ ràng chỉ có các xâu dạng sau thỏa mãn đề bài: $AB$, $ABA$, $BAB$, $BABA$.
			\begin{itemize}
				\item Dạng $1$ có $1$ xâu.
				\item Dạng $2$ có $\displaystyle {n-1 \choose 2-1}=n-1$ xâu (ta đếm số nghiệm nguyên dương của $x+y=n$).
				\item Dạng $3$ có $n-1$ xâu.
				\item Dạng $4$ có $\left( n-1 \right)^2$ xâu (ta đếm số nghiệm nguyên dương của cặp phương trình $x+y=n$ rồi nhân lại vì $BA$ phía trước xây dựng độc lập với $BA$ phía sau).
			\end{itemize}
			Vậy tổng cộng có $\left( n-1 \right)^2+2\left( n-1 \right)+1=n^2$.
			
			\begin{center}
				\begin{tikzpicture}[scale=1.2]
				\draw [dashed] (0,0) grid (4,4);
				\foreach \x in {0,1,2,3,4}
				\foreach \y in {0,1,2,3,4}
				{\fill (\x,\y) circle(.1);}
				\draw[line width=1.5] (0,0)-- (1,0)-- (1,3)-- (3,3)-- (3,4)-- (4,4);
				\draw (1,3) circle (0.3);
				\draw (3,4) circle (0.3);
				\end{tikzpicture}
			\end{center}
			
			\item Tương tự trên, ta có các dạng $ABAB$, $ABABA$, $BABAB$, $BABABA$.
			\begin{itemize}
				\item Dạng $1$ có $\left( n-1 \right)^2$ xâu.
				\item Dạng $2$ có $\displaystyle {n-1 \choose 3-1}{n-1 \choose 2-1}=\dfrac{\left( n-1 \right)^2 \left( n-2 \right)}{2}$ xâu.
				\item Dạng $3$ có $\dfrac{\left( n-1 \right)^2\left( n-2 \right)}{2}$ xâu.
				\item Dạng $4$ có $\displaystyle {n-1 \choose 3-1}{n-1 \choose 3-1}=\dfrac{\left( n-1 \right)^2 \left( n-2 \right)^2}{4}$ xâu.
			\end{itemize}
			Vậy số đường đi tổng cộng thỏa mãn là
			\begin{eqnarray*}
			 \dfrac{(n-1)^2 (n-2)^2}{4}+2\cdot \dfrac{(n-1)^2(n-2)}{2}+(n-1)^2 & = & \dfrac{(n-1)^2}{4}\left[(n-2)^2+4(n-2)+4 \right]\\
			 & = & \dfrac{\left( n-1 \right)^2n^2}{4}.
			\end{eqnarray*}
			Lời giải hoàn tất.
		\end{enumerate}
	}
\end{bt}

\begin{bt}%[Trần Duy Khương, Dự án EX_TapChi04]%[1D0G6]
 Với $m$ là số nguyên dương lớn hơn $1$, cô giáo phát $7m$ viên kẹo cho $7$ học sinh sao cho em nào cũng có kẹo nhưng không xảy ra trường hợp tất cả các học sinh nhận được số kẹo bằng nhau. Chứng minh rằng số cách phát kẹo là bội của $49$.
 \loigiai
 {Rõ ràng số cách chia kẹo chính là $\displaystyle {7m-1 \choose 6} -1$. Ta sẽ chứng minh rằng số này chia hết cho $49$, thật vậy
			\[\dfrac{\left( 7m-1 \right)!}{6!\left( 7m-7 \right)!}-1=\dfrac{\left( 7m-6 \right)\left( 7m-5 \right)\cdots \left( 7m-1 \right)-6!}{6!}.\]
			Do $\left( 6!,7 \right)=1$ nên ta chỉ cần chứng minh tử số trên chia hết cho $49$.\\
			Nếu coi $\left( 7m-6 \right)\left( 7m-5 \right)\cdots \left( 7m-1 \right)$ là đa thức theo $m$ thì nó có số hạng tự do là $6!$ (triệt tiêu với $6!$ có sẵn), hơn thế nữa, hệ số bậc nhất trong khai triển sẽ là
			\[\left( 7m \right)6!\left( \dfrac{1}{1}+\dfrac{1}{2}+\cdots +\dfrac{1}{6} \right)=7!\left( \dfrac{7}{1 \cdot 6}+\dfrac{7}{2 \cdot 5}+\dfrac{7}{3 \cdot 4} \right)m\]
			chia hết cho $49$.\\
			Các hệ số bậc cao hơn của $m$ đều có chứa lũy thừa cao hơn của $7$ tương ứng nên rõ ràng chia hết cho $49$. Từ đó suy ra tử số của phân số trên chia hết cho $49$, ta có điều phải chứng minh.
	}
\end{bt}

\begin{bt}%[Trần Duy Khương, Dự án EX_TapChi04]%[1D0G6]
 Xét các số tự nhiên $a_1$, $a_2$, $a_3$, $a_4$, $a_5$ và một bảng ô vuông có kích thước $5 \times 5$. Người ta điền vào ô ở hàng $i$ cột $j$ của bảng này số $a_ia_j$ với mọi $1 \le i,j \le 5$. Gọi $m$ là tổng các số điền trên bảng. Hỏi có bao nhiêu dãy các số như trên sao cho $0\le m\le 2017$?
 \loigiai
 {
 Tổng các số trên bảng là
 \begin{eqnarray*}
  m=\sum\limits_{1\le i,j\le 5,i= j} a_ia_j+\sum\limits_{1\le i,j \le 5,i\neq j} a_ia_j=\sum\limits_{1\le i\le 5} a_i^2+2\sum\limits_{1\le i<j\le 5} a_ia_j=\left( a_1+a_2+a_3+a_4+a_5 \right)^2.
 \end{eqnarray*}
 Do đó, tổng $m$ là các số chính phương không vượt quá $2017$. Chú ý rằng $44^2<2017<45^2$ nên $m$ nhận các giá trị chính phương không vượt quá $44^2$.\\
 Suy ra
 \[0\le a_1+a_2+a_3+a_4+a_5\le 44.\]
 Số nghiệm của bất phương trình này cũng chính là số dãy khác nhau và là $\displaystyle {44+6-1 \choose 6-1}={49 \choose 5}$.
 \begin{nx}
  Với các bài toán trên, ta thấy các trường hợp áp dụng bài toán chia kẹo Euler khá phong phú. Vấn đề có thể được phát biểu dưới nhiều hình thức khác nhau, thậm chí còn có thể tiếp cận theo hướng khác.
 \end{nx}
 }
\end{bt}
\noindent Trong phần tiếp theo, ta xét một số bài toán khá quen thuộc của việc ứng dụng chia kẹo Euler vào việc chọn lựa các phần tử với ràng buộc ``không đứng cạnh nhau”. Ý tưởng quan trọng mấu chốt là gọi ra các khoảng cách giữa các phần tử.

\begin{bt}%[Trần Duy Khương, Dự án EX_TapChi04]%[1D0G6]
Có bao nhiêu cách chọn từ $2016$ số nguyên dương đầu tiên ra $10$ số $a_1,a_2,\ldots ,a_{10}$ sao cho $\vert a_i-a_j\vert >1$ với mọi $i\neq j$?
\loigiai
{Không mất tính tổng quát, giả sử $a_1<a_2<\cdots <a_{10}$ thì khi đó, ta có thể đưa ra giả thiết đã cho về $a_{i+1}-a_i \ge 2$ với $i=\overline{1,9}$.\\
			Như thế, các số $a_i$ này không đứng cạnh nhau. Gọi $x_1$ là số các số trước $a_1$, $x_{11}$ là các số sau $a_{10}$, còn lại $x_k$ là số các số nằm giữa $a_{k-1}$ và $a_k$.
			\begin{center}
				\begin{tikzpicture}[scale=1.7]
				\fill (0,0) circle (.05) node[above] {$1$};
				\fill (1,0) circle (.05) node[above] {$a_1$};
				\fill (2,0) circle (.05) node[above] {$a_2$};
				\fill (2.7,0) circle (.05) node[above] {$a_3$};
				\fill (4.7,0) circle (.05) node[above] {$a_{10}$};
				\fill (5.4,0) circle (.05) node[above] {$2016$};
				\node[below] at (0.5,0) {$x_1$};
				\node[below] at (1.5,0) {$x_2$};
				\node[below] at (2.35,0) {$x_3$};
				\node[below] at (5.05,0) {$x_{11}$};
				\draw (0,0)-- (5.4,0);
				\end{tikzpicture}
			\end{center}
 Theo giả thiết, ta phải có $x_1\ge 0, x_{11}\ge 0$ và $x_i\ge 1$ với $i=\overline{2,10}$. Ngoài ra,
			\[x_1+x_2+\cdots +x_{11}=2006.\]
			Đặt $y_i=x_i-1\ge 0,i=\overline{2,10}$ thì ta đưa về phương trình
			\[x_1+y_2+\cdots +y_{10}+x_{11}=1997.\]
			Số nghiệm của phương trình này là $\displaystyle {1997+11-1 \choose 11-1}={2007 \choose 10}$.\\
			Dễ thấy rằng một bộ nghiệm này cho ta một cách chọn ra một bộ $10$ số thỏa mãn đề bài. Do đó, số các bộ cần tìm là $\displaystyle {2007 \choose 10}$.
	}
\end{bt}

\begin{bt}%[Trần Duy Khương, Dự án EX_TapChi04]%[1D0G6]
 Trên một bờ hồ, người ta muốn trồng các cây: hồng, cúc, lan, cau và tre. Biết rằng chu vi bờ hồ là $100$ m và khoảng cách giữa các cây là các số nguyên dương. Giả sử kích thước của các gốc cây là không đáng kể. Hỏi có bao nhiêu cách sắp xếp các cây này trên bờ hồ?
 \loigiai
 {
 Xét $5$ vị trí trên bờ hồ để trồng các cây $a$, $b$, $c$, $d$, $e$ lần lượt là khoảng cách giữa các cây $1$ và $2$, $2$ và $3$, $3$ và $4$, $4$ và $5$, $5$ và $1$. Ta có  $a+b+c+d+e=100$ và $a,b,c,d,e>0$.\\
 Số nghiệm của phương trình này là $\displaystyle {100+5-1 \choose 5-1}={104 \choose 4}$. Hoán vị vòng $5$ cây trong $5$ vị trí, ta có $4!$ cách.\\
 Vậy số cách sắp xếp cần tìm là $4!\displaystyle{104 \choose 4}$.
 \begin{nx}
  Một cách tương tự, ta có thể giải bài toán tổng quát là: Số cách chọn ra $k$ số từ $n$ số nguyên dương đầu tiên sao cho không có hai số nào đứng cạnh nhau là $\displaystyle {n-k+1 \choose k}$.
 \end{nx}
 }
\end{bt}

\noindent Tiếp theo, chúng ta xét một số bài toán cần phải đếm gián tiếp, kết hợp với nguyên lí bù trừ, khi các ràng buộc về nghiệm dạng ``không lớn hơn một số'' thay vì ``không nhỏ hơn một số''.

\begin{bt}%[Trần Duy Khương, Dự án EX_TapChi04]%[1D0G6]
 Có bao nhiêu số nguyên dương nhỏ hơn $10^6$ mà tổng các chữ số bằng $23$?
\loigiai{Số cần tìm có dạng $\overline{a_1a_2a_3a_4a_5a_6}$ với 
			\begin{equation}\label{EXTCh4.TH.2}
			a_1+a_2+a_3+a_4+a_5+a_6=23,
			\end{equation}
			và $0\le a_i \le 9, i=\overline{1,6}$.\\
			Gọi $\vert A_i \vert ,i=\overline{1,6}$ là tập hợp các nghiệm không âm của \eqref{EXTCh4.TH.2} nhưng $a_i\ge 10$.\\
			Trước hết, ta thấy số nghiệm của \eqref{EXTCh4.TH.2} là $\displaystyle {23+6-1 \choose 6-1}={28 \choose 5}$. Ta sẽ tính $\left|  \displaystyle\bigcup\limits_{i=1}^6 A_i\right|$ với chú ý rằng $\left| A_i\cap A_j \cap A_k \right| =0$ với $1\le i<j<k\le 6$ vì tổng các số là $23$.
			\begin{itemize}
				\item Tính $| A_1|$\\
				Đặt $a_1'=a_1-10\ge 0$ thì $a_1'+a_2+a_3+a_4+a_5+a_6=13$. Phương trình này có số nghiệm là $\displaystyle {13+6-1 \choose 6-1}={18 \choose 5}$.\\
				Tương tự với $|A_i| ,i=\overline{2,6}$.
				\item Tính $| A_1 \cap A_2|$\\
				Đặt $a_1'=a_1-10\ge 0$, $a_2'=a_2-10\ge 0$ thì $a_1'+a_2'+a_3+a_4+a_5+a_6=3$. Phương trình này có số nghiệm là $\displaystyle {3+6-1 \choose 6-1}={8 \choose 5}$.\\
				Tương tự với $| A_i \cap A_j|$ mà $1\le i<j\le 6$ khác.
			\end{itemize}
			Do đó 
			\[\left|  \bigcup\limits_{i=1}^6 A_i\right| =\sum\limits_{i=1}^6 |A_i| -\sum\limits_{1\le i<j\le 6} |A_i \cap A_j| =6\cdot {18 \choose 5}-{6 \choose 2}{8 \choose 5}.\]
			Vậy số lượng các số cần tìm là 
			\[{28 \choose 5}-{6 \choose 2}\cdot {8 \choose 5}-\left( 6 \cdot {18 \choose 5}-{6 \choose 2}{8 \choose 5} \right)=47712.\]
	}
\end{bt}

\begin{bt}%[Trần Duy Khương, Dự án EX_TapChi04]%[1D0G6]
 Tìm số cách chọn ra $4$ số nguyên phân biệt từ $24$ số nguyên dương đầu tiên sao cho trong lựa chọn đó, không có hai số cùng số dư khi chia cho $3$ liên tiếp.
 \loigiai
 {
 Gọi $x_1,x_2,\ldots,x_5$ lần lượt là số các số nằm trước số thứ nhất được chọn, giữa số thứ nhất và
 số thứ hai,$\ldots$, sau số thứ tư.\\
 Ta có
 \[\begin{cases}
 x_1+x_2+\cdots +x_5=20\\
 x_1\ge 0,x_5\ge 0,x_i\neq 2,i=\overline{2,4}.
 \end{cases}\]
 Số nghiệm tự nhiên của phương trình ban đầu và không có điều kiện ràng buộc là $\displaystyle {24 \choose 4}$.\\
 Gọi $A$, $B$, $C$ lần lượt là các cách chọn mà $x_2=2$, $x_3=2$, $x_4=2$ thì ta cần tính 
 \[{24 \choose 4}-\vert A\cup B\cup C\vert\]\\
 Ta có $| A| =\displaystyle{20-2+4-1 \choose 4-1}={21 \choose 3}$ và tương tự với $B$, $C$.\\
 Lại có
 \[|A\cap B|={20-4+3-1 \choose 3-1}={18\choose 2},\]
 và tương tự với $B\cap C$, $C\cap A$.\\
 Mà 
 \[\vert A\cap B\cap C\vert={20-6+2-1\choose 2-1}={15\choose 1}\]
 Do đó số cách chọn cần tìm là $\displaystyle {24\choose 4}-\left[ 3{21 \choose 3}-3{18 \choose 2}+{15 \choose 1} \right]=7080$.
 }
\end{bt}

\begin{bt}%[Trần Công Duy, Dự án EX_TapChi04]%[1D0G6]
 Trong không gian $Oxyz$, gọi $S$ là tập hợp các điểm nguyên nằm phía trong hoặc ở trên đỉnh, cạnh và mặt của hình lập phương cạnh $999$, trong đó các cạnh song song hoặc vuông góc với trục tọa độ một đỉnh là ($0;0;0$) và một đỉnh đối với nó là ($999;999;999$). Hỏi mặt phẳng $x + y + z = 2016$ đi qua bao nhiêu điểm trong tập hợp $S$?
	\loigiai{
		Rõ ràng các điểm thuộc $S$ có dạng $\{(x;y;z)|x,y,z \in [0,999] \cap \mathbb{Z}\}$. Ta cần đếm số nghiệm nguyên không âm của phương trình sau $x + y + z = 2016$ thỏa mãn $0 \leq x,y,z \leq 999$. Tương tự các bài toán chia kẹo Euler có ràng buộc ở trên, dùng nguyên lý bù trừ, ta có
		\begin{eqnarray*}
		 {2018 \choose 2} - \left(3\cdot {1018 \choose 2}-3\cdot {18 \choose 2} \right)=482653.
		\end{eqnarray*}
	}
\end{bt}

\begin{bt}%[Trần Công Duy, Dự án EX_TapChi04]%[1D0G6]
 Cho $m$, $n$ là các số nguyên dương. Xét $2n$ quả táo, $2n$ quả đào, $2n$ quả cam, $3m$ quả xoài, $3m$ quả nho và các quả cùng loại thì giống nhau. Gọi $s_n$ là số cách chia số quả táo, đào, cam cho $2$ người mà mỗi người nhận  được $3n$ quả; $t_m$ là số cách chia số quả xoài, nho cho $1$ người và sử dụng ít hơn $3m$ quả. Chứng minh rằng $s_n \neq t_m$ với mọi $n$, $m$ nguyên dương.
 \loigiai
 {
 Với cách chia táo - đào - cam, ta cần xét phương trình $x + y + z = 3n $ với $0 \leq x,y,z \leq 2n$. Tương tự như trên, ta đếm được
 \begin{eqnarray*}
  s_n={3n+2 \choose 2}-3\cdot {n+1 \choose 2} = \dfrac{(3n+2)(3n+1)}{2}-\dfrac{3n(n+1)}{2}=3n^2+3n+1.
 \end{eqnarray*}
 Tiếp theo, để đếm $t_m$, ta chỉ cần đếm số nghiệm của $x + y \leq 3m - 1$ với $0 \leq x,y \leq 3m$. Tương tự, ta có số cách chia là
 \begin{eqnarray*}
  t_m={3m-1+3-1 \choose 3-1} = \dfrac{3m(3m+1)}{2}.
 \end{eqnarray*}
 Dễ thấy rằng với mọi $n$ thì $s_n$ không chia hết cho $3$, còn $t_m$ chia hết cho $3$ nên $s_n \neq t_m$ với mọi số nguyên dương $m$, $n$.
 }
\end{bt}
\noindent Tiếp theo một bài toán khá ``kinh điển'' về chủ đề này, bài toán ``vé hành phúc''. Một vé hạnh phúc có $6$ chữ số và tổng của nhóm $3$ số đầu bằng tổng của nhóm $3$ số cuối. Mục tiêu là cần đếm số vé hạnh phúc. Ở bài này, trước khi đưa về chia kẹo Euler, ta cần thực hiện một song ánh.

\begin{bt}%[Trần Công Duy, Dự án EX_TapChi04]%[1D0G6]
	Vé xe buýt có dạng $\overline{abcdef}$ với $a,b,c,d,e,f \in \{0,1,2, \ldots , 9\}$. Một vé như trên thỏa mãn điều kiện $a + b + c = d + e + f$ được gọi là ``vé hạnh phúc''.
	\begin{enumerate}
		\item Chứng minh rằng số nghiệm của phương trình $a + b + c = d + e + f$ bằng số nghiệm của phương trình $a + b + c + d + e + f = 27 $ với $0 \leq a,b,c,d,e,f \leq 9$.
		\item Tính số vé hạnh phúc.
	\end{enumerate}
	\loigiai{
		\begin{enumerate}
			\item Gọi $A$, $B$ lần lượt là số nghiệm của phương trình $a + b + c = d + e + f $ và phương trình $a + b + c + d + e + f=27$. Ta thấy rằng
			\begin{align*}
			a + b + c + d + e + f = 27 \Leftrightarrow a + b + c = (9 - d) + (9 - e) + (9 - f). 
			\end{align*}
			Nếu đặt $d' = 9  - d$, $e' = 9 - e$, $f' =  9 - f$ thì ta được $a + b + c = d' + e' + f'$.\\
			Do đó, một bộ nghiệm của phương trình $a + b + c + d + e + f = 27$ sinh ra một bộ nghiệm của phương trình $a + b+ c = d + e + f$ nên $|A| \leq |B|$. Chứng minh tương tự, ta có $|B| \leq |A|$ nên $|A| = |B|$.
			\item Đếm số nghiệm của phương trình
			\begin{equation}\label{EXTCh4.TH.3}
			 a + b + c + d + e + f = 27,
			\end{equation}
			với $0 \leq a,b,c,d,e,f \leq 9$.\\
			Gọi $A_1$, $A_2$, $A_3$, $A_4$, $A_5$, $A_6$ lần lượt là tập hợp nghiệm của phương trình \eqref{EXTCh4.TH.3} nhưng có các điều kiện $a \geq 10$, $b \geq 10$, $c \geq 10$, $c \geq 10$, $d \geq 10$, $e \geq 10$, $f \geq 10$.\\
			Số nghiệm của \eqref{EXTCh4.TH.3} là $\displaystyle {27+6-1 \choose 6-1}={32 \choose 5}$ nên ta cần tính $\displaystyle {32 \choose 5} - |A_1 \cup A_2 \cup \cdots \cup A_6|$.\\
			Xét $A_1$: Đặt $a' = a - 10 \geq 0$ thì ta có $a' + b + c + d + e + f = 17 $ dễ thấy $|A_1| = \dfrac{22}{5}$. Tương tự, ta cũng có $|A_2| = |A_3| = |A_4| = |A_5| = |A_6| = \displaystyle {22 \choose 5}$.\\
			Xét $A_1 \cap A_2$: Đặt $a' = a - 10 \geq 0$, $b' = b - 10 \geq 0$ thì ta có $a' + b' + c + d + e + f = 7$ và dễ thấy $|A_1 \cap A_2| = \displaystyle{12 \choose 5}$.\\
			Ngoài ra, ta thấy rằng $|A_i \cap A_j \cap A_k| = 0$ với mọi $1 \leq i < j < k \leq 6$ nên
			\begin{align*}
			|A_1 \cup A_2 \cup \cdots \cup A_6| = \sum\limits_{i = 1}^{6} |A_i| - {6 \choose 2}
			\sum\limits_{1 \leq i < j \leq 6} |A_i \cap A_j| = 6 \cdot {22 \choose 5} - 15 \cdot {12 \choose 5}.
			\end{align*}
			Vậy số các số may mắn là $\displaystyle {32 \choose 5} - \left[6\cdot{22 \choose 5}-15\cdot{12 \choose 5} \right] = 55252 $.
		\end{enumerate}
	}
\end{bt}
Như trong đầu bài đã giới thiệu, chia kẹo Euler còn có tên gọi là bài toán \textit{``balls and urns''}. Nó xuất phát từ bài toán đếm số vòng cổ necklace tạo ta bằng cách xâu nhiều viên hạt xanh và đỏ. Khi đó, các viên cùng màu sẽ tạo thành các vùng và số vị trí chuyển tiếp cũng bằng chính là số vùng đó. Trong đó phần còn lại, ta xét một trường hợp như thế.

\begin{bt}[Việt Nam, 2014]%[Trần Công Duy, Dự án EX_TapChi04]%[1D0G6]
 Cho đa giác đều $103$ cạnh. Tô màu đỏ $79$ đỉnh của đa giác và tô màu xanh các đỉnh còn lại. Gọi $A$ là số các cặp đỉnh đỏ kề nhau và $B$ là số cặp đỉnh xanh kề nhau.
	\begin{enumerate}
		\item Tìm tất cả các giá trị có thể nhận được của cặp $(A,B)$.
		\item Xác định số cách tô màu các đỉnh của đa giác để $B = 14$. Biết rằng hai cách tô màu được xem là như nhau nếu chúng có thể nhận được nhau qua một phép quay quanh tâm của đường tròn ngoại tiếp đa giác.
	\end{enumerate}
	\loigiai{\textrm{}
		\begin{enumerate}
			\item Gọi $k$ là số dãy gồm các đỉnh liên tiếp được tô xanh và bị chặn hai đầu bởi đỉnh màu đỏ và $h$ là số dãy gồm các đỉnh liên tiếp được tô đỏ và bị chặn hai đầu bởi đỉnh màu xanh. Dễ thấy giữa $2$ dãy đỏ là $1$ dãy xanh và giữa $2$ dãy xanh là $1$ dãy đỏ nên $h = k$.\\
			Gọi $a_1,a_2, \ldots ,a_k$ là số lượng các đỉnh trong các dãy xanh; $b_1, b_2, \ldots, b_k$ là số lượng đỉnh trong các dãy đỏ thì $\displaystyle\sum\limits_{i = 1}^k a_i = 24$, $\displaystyle\sum\limits_{i = 1}^k b_i = 79$.\\
			Ngoài ra, rõ ràng nếu một dãy cùng màu có số lượng $t$ thì có $t - 1$ cặp đỉnh liên tiếp cùng màu. Suy ra $A = \displaystyle\sum\limits_{i = 1}^{k} (a_i - 1) = 79 - k$ và tương tự $B = 24 - k$. Do đó, các cặp $(A,B)$ sẽ có dạng $(79 - k, 24 - k)$ với $0 \leq k \leq 24$. Có tổng cộng $25$ cặp như thế.
			\item Do $B = 14$ nên theo đẳng thức đã xây dựng ở trên thì $14 = 24 - k \Leftrightarrow k = 10$. Như thế, có tổng cộng $10$ dãy xanh và $10$ dãy đỏ.\\
			Số nghiệm nguyên dương của các phương trình sau $\displaystyle\sum\limits_{i = 1}^{10} a_i = 24$, $\displaystyle\sum\limits_{i = 1}^{10} b_i = 79$ lần lượt là $\displaystyle {23 \choose 9}$, $\displaystyle {78 \choose 9}$. Do xếp trên một vòng tròn nên chỉ xét vị trí tương đối của nhóm với nhau chứ không xét vị trí cố định của từng nhóm.\\
			Vậy số cách tô cần tìm là $\dfrac{1}{10}\displaystyle {23 \choose 9}{78 \choose 9}$.
		\end{enumerate}
	}
\end{bt}

\begin{bt}[AIME, 2011]%[Trần Công Duy, Dự án EX_TapChi04]%[1D0G6]
 Một học sinh có $5$ quả cầu màu xanh giống nhau và một số quả cầu màu đỏ giống nhau. Bạn ấy muốn xếp các quả cầu thành một dãy và nếu đặt $a$ là số quả cầu mà quả bên phải nó cùng màu với nó, $b$ là số quả cầu mà quả cầu bên phải nó khác màu với nó thì $a = b$. Gọi $m$ là số lớn nhất các quả cầu màu đỏ có thể dùng sao cho tồn tại cách xếp $m + 5$ quả cầu thành một dãy thỏa mãn điều kiện nêu trên.
	\begin{enumerate}
		\item Xác định $m$.
		\item Ứng với $m$ ở trên, tìm số cách xếp các quả cầu để có $a = b$.
	\end{enumerate}
	\loigiai{
		\begin{enumerate}
			\item Do có $5$ quả cầu màu xanh và mỗi quả sẽ đặt cạnh không quá hai quả cầu đỏ (khác màu với nó) nên số cặp quả cầu khác màu nhau là $b \leq 10$. Suy ra $a \leq 10$. Ký hiệu quả cầu màu xanh, đỏ lần lượt là $X$, $D$ thì có thể xây dựng dãy thỏa mãn đề bài từ dãy gốc như sau
			\begin{align*}
			DXDXDXDXDXD.
			\end{align*}
			Sau đó thêm vào không quá $10$ quả cầu màu đỏ nữa (vì mỗi quả sẽ làm tăng giá trị $a$ lên $1$ đơn vị). Từ đó suy ra $m = 10 + 6 = 16$.
			\item Để đếm số cách xếp thỏa mãn, xét dãy $16$ quả cầu đỏ. Ta cần xếp vào đây $5$ quả cầu xanh sao không có hai quả nào cạnh nhau.\\
			Gọi $x_1,x_2,\ldots , x_6$ là số lượng quả cầu đỏ bị chia ra bởi các quả cầu xanh thì
			\begin{align*}
			\heva{&x_1 + x_2 + \cdots + x_6 = 16\\& x_1, x_2,\ldots , x_6 \in \mathbb{Z}^+.}
			\end{align*}
			Khi đó, số cách xếp cần tìm là $\displaystyle {16-1 \choose 6-1}={15 \choose 5}$.
		\end{enumerate}
	}
\end{bt}

\begin{bt}[AIME, 1986]%[Trần Công Duy, Dự án EX_TapChi04]%[1D0G6]
 Cho xâu nhị phân: $001101001111011$ có $4$ cặp $01$, $3$ cặp $10$, $5$ cặp $11$ và $2$ cặp $00$ đứng cạnh nhau. Hỏi có tất cả bao nhiêu xâu nhị phân cùng tính chất như thế?
	\loigiai{
		Tương tự bài toán trên, ta thấy rằng các xâu nhị phân thỏa mãn đề bài phải có dạng
		\begin{align*}
		XYXYXYXY,
		\end{align*}
		trong đó $X$ là một dãy các số $0$ liên tiếp và $Y$ là một dãy các số $1$ liên tiếp. Như thế, có tổng cộng $4$ dãy $0$ và $4$ dãy $1$.\\
		Rõ ràng trong một dãy có độ dài là $k$ thì số lượng cặp giống nhau là $k - 1$. Gọi $x$, $y$, $z$, $t$ là độ dài của $4$ dãy $0$ thì theo giả thiết, ta phải có
		\begin{align*}
		x - 1 + y - 1 + z - 1 + t - 1 = 2 \Leftrightarrow x + y + z + t = 6.
		\end{align*}
		Số nghiệm nguyên dương của phương trình trên là $\displaystyle {6-1 \choose 4-1}={5 \choose 3}=10$.\\
		Lại có $m$, $n$, $p$, $q$ là độ dài của $4$ dãy $1$ thì
		\begin{align*}
		m - 1 + n - 1 + p - 1 + q - 1 = 5 \Leftrightarrow m + n + p + q = 9.
		\end{align*}
		Số nghiệm nguyên dương của phương trình này là $\displaystyle {9-1 \choose 4-1}={8 \choose 3}=56$. Do hai dãy này chọn độc lập với nhau nên số xâu thỏa mãn là $10 \cdot 56 = 560$ xâu.
	\begin{nx}
	 Tổng quát: Hỏi với các số tự nhiên $a$, $b$, $c$, $d$ nào thì tồn tại một xâu nhị phân có độ dài dương và có $a$ cặp $01$, $b$ cặp $10$, $c$ cặp $11$ và $d$ cặp $00$ đứng cạnh nhau?\\
	 Ta thấy rằng nếu xếp các số này lên vòng tròn thì các số $0$ và $1$ sẽ được tạo thành các nhóm rời nhau. Rõ ràng số lượng nhóm $0$ bằng số lượng nhóm $1$. Do đó, nếu cắt xâu tại ranh giới giữa hai nhóm thì số lượng một trong hai bộ $01$ hoặc $10$ sẽ giảm đi $1$ đơn vị so với bộ kia.\\
	 Còn nếu cắt tạ vị trí giữa các nhóm (trường hợp số lượng số trong nhóm lớn hơn $1$) thì không làm thay đổi số lượng bộ $01$ hoặc $10$.\\
	 Trước hết, ta luôn có $|a - b| \leq 1$. Ngoài ra, dễ thấy rằng nếu $c > 0$, $d > 0$ thì phải tồn tại ranh giới  giữa hai bộ nên lúc đó, ta phải có hoặc $a > 0$ hoặc $b > 0$.\\
	 Từ đây ta thấy điều kiện của các số $a$, $b$, $c$, $d$ là
	 \begin{enumerate}[(1)]
	 	\item Nếu $cd = 0$ thì $a = b = 0$.
	 	\item Nếu $cd \neq 0$ thì $|a - b| \leq 1$ và $a$, $b$ không đồng thời bằng $0$.
	 \end{enumerate}
	 Đặt $k = \max\{a,b\}$ thì rõ ràng có tổng cộng $k$ nhóm theo nhận xét ban đầu. Giả sử $k \geq 1$. Gọi $x_1,x_2,\ldots,x_k$ là số lượng số $1$ có trong từng nhóm thì rõ ràng
	 \begin{align*}
	 x_1 + x_2 + x_3 + \cdots + x_k = c + k.
	 \end{align*}
	 số nghiệm dương của phương trình này là $\displaystyle {c+k-1 \choose k-1}$. Tương tự số cách sắp xếp các số $0$ là $\displaystyle {d+k-1 \choose k-1}$.\\
	 Vậy số các xâu nhị phân thỏa mãn là $\displaystyle {c+k-1 \choose k-1} {d+k-1 \choose k-1}$ với $k = \max \{a,b\}$ với $k \geq 1$.\\
	 Trong trường hợp $k = 0$ thì dễ thấy có $1$ xâu thỏa mãn đề bài.
	\end{nx}
	}
\end{bt}


\subsection{Bài tập rèn luyện}

\begin{bt}%[Trần Công Duy, Dự án EX_TapChi04]%[1D0G6]
 Chứng minh số nghiệm nguyên của $x + y + z = \left[\dfrac{3(n - 1)}{2} \right] $ với $0 \leq x,y,z \leq n$ là $\left[\dfrac{3n^2 + 1}{4} \right] $.
	\loigiai{
   Ta có thể chia trường hợp $n$ chẵn, lẻ để đếm cho thuận tiện.
	}
\end{bt}

\begin{bt}%[Trần Công Duy, Dự án EX_TapChi04]%[1D0G6]
 Rút gọn tổng sau
 \begin{align*}
  A = {9 \choose 9} + {10 \choose 9} + {11 \choose 9} + \cdots + {99 \choose 9}.
 \end{align*}
 \loigiai
 {
 Ta thấy $\displaystyle {k \choose 9}$ có thể viết thành $\displaystyle {k+1-1 \choose 10-1}$, đây chính là số nghiệm của phương trình $\break x_1 + x_2 + \cdots + x_{10} = k + 1$. Do đó, $A$ chính là số nghiệm nguyên dương của bất phương trình $10 \leq x_1 + x_2 + \cdots + x_{10} \leq 100$. Đây là bài toán đã giải quyết ở bài 1 của phần trước.
 }
\end{bt}

\begin{bt}%[Vũ Nguyễn Hoàng Anh, ExTapChi04]%[1D0G6]
 Có bao nhiêu cách chọn ra trong $40$ bạn học sinh xếp thành vòng tròn ra $7$ bạn sao cho có ít nhất $2$ bạn học sinh đứng cạnh nhau?
	\loigiai{
  Ta xét trường hợp ngược lại: \lq\lq Chọn ra $7$ bạn sao cho không có $2$ học sinh nào đứng cạnh nhau\rq\rq. Gọi $a_1, a_2, \ldots, a_7$ là số học sinh giữa bạn thứ nhất và bạn thứ hai, giữa bạn thứ hai và bạn thứ ba,\ldots, giữa bạn thứ bảy và bạn thứ nhất. Ta có
	\[a_1+a_2+a_3+\cdots+a_7=33, a_i\ge 1, i=\overline{1,7}.\]
	Số nghiệm của phương trình này là $\displaystyle\binom{33-1}{7-1}=\displaystyle\binom{32}{6}$ và đáp số là $40\cdot \displaystyle\binom{32}{6}$ cách chọn.
	}
\end{bt}

\begin{bt}%[Vũ Nguyễn Hoàng Anh, ExTapChi04]%[1D0G6]
 Có một dãy gồm $100$ quyển vở giống nhau đặt trên bàn và Đạt được cô giáo thưởng $5$ quyển vở trong số đó. Đạt rất ghét số $5$ nên bạn ấy muốn chọn các quyển vở sao cho không có hai quyển liên tiếp được chọn nào có thứ tự chênh lệch nhau một lượng chia hết cho $5$. Biết rằng Đạt đã chọn ra hai quyển vở ở hai đầu của dãy. Hỏi Đạt có tổng cộng bao nhiêu cách chọn ra thêm $3$ quyển nữa theo ràng buộc trên?\\
 Ví dụ một cách chọn vở của Đạt thỏa mãn là $1$, $10$, $19$, $28$, $100$ với chênh lệch là $9$, $9$, $9$, $72$.
 \loigiai
 {
 Gọi $x$, $y$, $z$, $t$ là số quyển vở nằm giữa các quyển có thứ tự $1-2$, $2-3$, $3-4$, $4-5$. Ta có $x+y+z+t=95$ và $x+1$, $y+1$, $z+1$, $t+1$ không chia hết cho $5$.\\
 Đặt $a$, $b$, $c$, $d$ lần lượt là số dư của $x$, $y$, $z$, $t$ khi chia cho $5$ thì $a,b,c,d\in \{0;1;2;3\}$ và $a+b+c+d$ chia hết cho $5$.\\
 Viết $x=5X+a$, $y=5Y+b$, $z=5Z+c$, $t=5T+d$ thì $X+Y+Z+T=19-\dfrac{a+b+c+d}{5}$, với $X,Y,Z,T\ge 0$. Đến đây, ta có các trường hợp sau (giả sử $a\ge b\ge c\ge d$ cho gọn rồi nhân với hoán vị lặp)
 \begin{enumerate}[(1)]
 	\item Nếu $a+b+c+d=0$ thì có tất cả $1$ bộ.
 	\item Nếu $a+b+c+d=5$ thì có $40$ bộ.
 	\item Nếu $a+b+c+d=10$ thì có $10$ bộ. 
 \end{enumerate}
 Vậy đáp số của bài toán là $\displaystyle\binom{22}{3}+40\binom{21}{3}+10\binom{20}{3}=66140$ cách chọn.
 }
\end{bt}

\begin{bt}[Việt Nam, 2012]%[Vũ Nguyễn Hoàng Anh, ExTapChi04]%[1D0G6]
 Cho một nhóm gồm $5$ cô gái, kí hiệu là $G_1$, $G_2$, $G_3$, $G_4$, $G_5$ và $12$ chàng trai. Có $17$ chiếc ghế được xếp thành một hàng ngang. Người ta xếp nhóm người đã cho ngồi vào các chiếc ghế đó sao cho các điều kiện sau được thỏa mãn đồng thời
		\begin{itemize}
			\item Mỗi chiếc ghế có đúng một người ngồi;
			\item Thứ tự ngồi của các cô gái, xét từ trái qua phải, là $G_1$, $G_2$, $G_3$, $G_4$, $G_5$;
			\item Giữa $G_1$, $G_2$ có ít nhất $3$ chàng trai;
			\item Giữa $G_4$, $G_5$ có ít nhất $1$ chàng trai và nhiều nhất $4$ chàng trai.
		\end{itemize}
		Hỏi có tất cả bao nhiêu cách xếp như vậy? (Hai cách xếp được coi là khác nhau nếu tồn tại một chiếc ghế mà người ngồi ở chiếc ghế đó trong hai các xếp là khác nhau).
	\loigiai{
 Gọi $a_1, a_2, \ldots, a_6$ là số lượng chàng trai ngồi trước cô gái $G_1$, giữa cô gái $G_1$, $G_2$, giữa cô gái $G_2$, $G_3$, giữa cô gái $G_3$, $G_4$, giữa cô gái $G_4$, $G_5$ và sau cô gái $G_5$.\\
 Ta có hệ điều kiện sau với các số tự nhiên $a_1, a_2, \ldots, a_6$
			\[\heva{&a_1+a_2+a_3+a_4+a_5+a_6=12\\ &a_2\ge 3, 1\le a_5\le 4.}\]
			Đếm số nghiệm của hệ này, chú ý rằng các chàng trai có thể hoán vị cho nhau, nên tổng số cách xếp là $12!\times 1161$.
	}
\end{bt}

\begin{bt}%[Vũ Nguyễn Hoàng Anh, ExTapChi04]%[1D0G6]
 Có $10$ cái hộp khác nhau được đánh số từ $1$ đến $10$ và $10$ viên bi giống nhau (mỗi hộp không nhất thiết có bi). Hỏi có bao nhiêu cách sắp xếp $10$ viên bi vào $10$ hộp sao cho tổng số viên bi trong các hộp số $1$, $2$, $3$ là số chẵn, còn tổng các viên bi trong các hộp $8$, $9$, $10$ là số lẻ?
 \loigiai
 {
 Ta thấy rằng số cách chia cần tìm cũng bằng số cách chia mà tổng số viên bi trong các hộp số $1$, $2$, $3$ là số lẻ, còn tổng số các viên bi trong các hộp số $8$, $9$, $10$ là số chẵn. Do đó, số cách chia bi thỏa mãn đúng bằng $\dfrac{1}{2}$ số cách chia bi mà tổng số bi ở các hộp $4$, $5$, $6$, $7$ là số lẻ. Đặt số đó là $a$. Ta có $a\in \{1,3,5,7,9\}$. Nếu $a=1$ thì dùng công thức chia kẹo Euler, ta có
 \[\binom{4+1-1}{4-1}\binom{9+6-1}{6-1}=\binom{4}{3}\binom{14}{5}.\]
 Tương tự với $a=3,5,7,9$. Vậy đáp số của bài toán là
 \[\dfrac{1}{2}\sum\limits_{a\in \{1,3,5,7,9\}} \binom{3+a}{3}\binom{15-a}{5}=23000.\]
 }
\end{bt}

\begin{bt}%[Vũ Nguyễn Hoàng Anh, ExTapChi04]%[1D0G6]
 Có bao nhiêu multiset có số phần tử là $4$ tạo thành từ $n$ phần tử phân biệt sao cho có ít nhất một phần tử xuất hiện đúng hai lần?
	\loigiai{
		Số multiset tùy ý có độ dài $4$ là $\displaystyle\binom{n+3}{4}$ và số multiset không thỏa mãn điều kiện trên bao gồm
			\begin{itemize}
				\item Multiset mà một phần tử xuất hiện $4$ lần có $n$ cách chọn.
				\item Multiset mà một phần tử xuất hiện $3$ lần có $n(n-1)$ cách chọn.
				\item Multiset mà các phần tử phân biệt nhau $\displaystyle\binom{n}{4}$.
			\end{itemize}
	Kết quả cần tìm là $\displaystyle \binom{n+3}{4}-\left[ n+n(n-1)+\binom{n}{4} \right]=\dfrac{n(n-1)^2}{2}$.
	}
\end{bt}

\begin{bt}[Ả Rập, 2015]%[Vũ Nguyễn Hoàng Anh, ExTapChi04]%[1D0G6]
 Mười đỉnh của đa giác đều $20$ cạnh $A_1A_2\ldots A_{20}$ được tô đen và các đỉnh còn lại được tô trắng. Xét tập hợp $S$ bao gồm đường chéo $A_1A_4$ và tất cả các đường chéo có cùng độ dài với nó. Chứng minh rằng trong $S$, số đường chéo có hai đầu mút cùng màu đen bằng với số đường chéo có hai đầu mút cùng màu trắng. Từ đó tìm tất cả các giá trị có thể có của hai đường chéo có hai đầu mút cùng màu đen trong $S$.
 \loigiai
 {
 \begin{center}
 	\begin{tikzpicture}[>=stealth]
 	\def\r{3.5cm}
 	\tkzDefPoints{0/0/O}
 	\foreach \i in {1,2,3,4,...,20} \pgfmathtruncatemacro\j{6*18-18*\i} \coordinate[label=\j: $A_{\i}$] (A_{\i}) at (\j:\r);
 	\foreach \i in {1,2,...,17} \pgfmathtruncatemacro\j{\i+3}\draw (A_{\i})--(A_{\j});
 	\foreach \i in {18,19,20} \pgfmathtruncatemacro\j{\i+3-20}\draw (A_{\i})--(A_{\j});
 	\draw (O) circle (\r);
 	\draw[fill=black] (O) circle (1.5pt);
 	\foreach \i in {1,2,...,20} \draw[fill=white] (A_{\i}) circle (1.5pt);
 	\foreach \i in {1,2,3, 6,7,8, 11,12,13, 16} \draw[fill=black] (A_{\i}) circle (1.5pt);
 	
 	\end{tikzpicture}
 \end{center}
 Kí hiệu như hình vẽ, vì $\gcd(20,3)=1$ nên các đường chéo thuộc $S$ có thể tạo thành một dãy đi qua hết tất cả các đỉnh của đa giác đã cho.\\
 Vì mỗi đỉnh tô đen hoặc trắng nên ta có thể chia chúng thành các nhóm gồm các đỉnh đen liên tiếp và các đỉnh trắng liên tiếp. Rõ ràng một nhóm đen nằm giữa hai nhóm trắng và một nhóm trắng nằm giữa hai nhóm đen. Suy ra số lượng nhóm trắng và nhóm đen bằng nhau, đặt là $k$.\\
 Trong một nhóm có kích thước là $a$ thì số đường chéo là $a-1$. Từ đó, tính tổng các đường chéo trong các nhóm trắng và đen, ta có tổng số đường chéo có hai đầu mút đen và trắng cùng bằng $10-k$. Từ đó ta thấy số đường chéo đó có thể nhận các giá trị $1, 2, 3, \ldots, 10$.
 }
\end{bt}

\begin{bt}%[Vũ Nguyễn Hoàng Anh, ExTapChi04]%[1D0G6]
 Số $20162017$ khi viết trong hệ nhị phân có dạng $1001100111010010111100001$. Đây là một dãy số nhị phân có các tính chất sau
 \begin{itemize}
 	\item Có $6$ cặp $00$.
 	\item Có $6$ cặp $11$.
 	\item Có $6$ cặp $10$.
 	\item Có $6$ cặp $01$.
 \end{itemize}
 Hỏi có tất cả bao nhiêu số tự nhiên khi viết trong hệ nhị phân cũng có các tính chất như trên?
 \loigiai
 {
 Ta kí hiệu một dãy các số $1$ liền nhau là dãy $A$ và dãy các số $0$ liền nhau là dãy $B$. Khi đó, theo đề bài thi dãy số nhị phân thỏa mãn dạng $ABABABABABABA $ gồm $7$ dãy $A$ và $6$ dãy $B$ (chú ý rằng ta không cần xét trường hợp $B$ đứng đầu).\\
 Rõ ràng trong một dãy có độ dài $k$ thì tạo thành $k-1$ cặp ($00$ hoặc $11$) nên số lượng số $1$ là $6+7=13$ và số lượng số $0$ là $6+6=12$.\\
 Gọi $x_1, x_2, \ldots, x_7$ là độ dài các dãy $A$ thì $x_1+x_2+\cdots+x_7=13$. Số nghiệm dương của phương trình này là $\displaystyle\binom{12}{6}$ cũng chính là cách tạo thành các dãy $A$. Tương tự ta tìm được $\displaystyle\binom{11}{5}$ cách tạo thành các dãy $B$.\\
 Mỗi dãy $A$, $B$ như trên cho ta đúng một dãy nhị phân, và mỗi dãy nhị phân cũng cho ta đúng một số tự nhiên thỏa mãn đề bài. Vậy có tất cả $\displaystyle\binom{12}{6}\binom{11}{5}$ số nguyên dương thỏa mãn đề bài.
 }
\end{bt}

\begin{bt}\label{TH.34}%[Vũ Nguyễn Hoàng Anh, ExTapChi04]%[1D0G6]
 Trong mặt phẳng tọa độ $Oxy$, xét điểm $M(a,b)$ với $a$, $b$ là các số nguyên dương. Gọi một con đường đi từ $O$ đến $M$ là tốt nếu nó chỉ đi lên hoặc sang phải. Chứng minh rằng số đường đi tốt từ $O$ đến $M$ là số nghiệm của phương trình
		\[x_1+x_2+\cdots+x_{a+1}=b.\]
	\loigiai{
 Rõ ràng ta cần đúng $b$ lần đi lên trên từ vị trí $(0,0)$ đến $(a,b)$. Gọi $x_{i+1}$ là số đoạn đi lên có cùng hoành độ $i$ với $0\le i\le a$ thì $x_1+x_2+\cdots +x_{a+1}=b$. Phương trình này có số nghiệm là $\displaystyle \binom{a+1+b-1}{a+1-1}=\binom{a+b}{a}$.
	}
\end{bt}

\begin{bt}[VN TST 2003]%[Vũ Nguyễn Hoàng Anh, ExTapChi04]%[1D0G6]
 Cho bốn điểm phân biệt $A(0,0)$, $B(p,0)$, $C(m,q)$, $D(m,n)$ với $m$, $n$, $p$, $q$ là bốn số nguyên dương thỏa mãn $p<m$, $q<n$. Xét các đường đi tốt $f$ từ $A$ đến $D$ và các đường đi tốt $g$ từ $B$ đến $C$. Gọi $S$ là số các cặp đường đi $(f,g)$ sao cho chúng không có điểm chung. Chứng minh rằng
 \[S=\binom{m+n}{n}\binom{m+q-p}{q}-\binom{m+q}{q}\binom{m+n-p}{n}.\]
 \loigiai
  {
  Từ bài \ref{TH.34}, ta suy ra số đường đi $f$ tốt là $\displaystyle\binom{m+n}{n}$, và số đường đi $g$ tốt là $\displaystyle\binom{m+q-p}{q}$.
  \begin{center}
  	\begin{tikzpicture}[>=stealth, scale=0.7]
  	\draw[thin, color=gray!30] (-1.5,-1.5) grid (10.5,6.5);
  	\draw[->](-1.5,0)--(10.5,0) node[below]{$x$};
  	\draw[->](0,-1.5)--(0,6.5) node[left]{$y$};
  	\draw[fill=black] (0,0) node[below left]{$A$} circle (2pt) (3,0) node[below left]{$B$} circle (2pt) (9,4) node[below right]{$C$} circle (2pt) (9,5) node[above right]{$D$} circle (2pt);
  	\draw[very thick] (0,0)--(1,0)--(1,2)--(4,2)--(4,5)--(9,5) (3,0)--(3,1)--(6,1)--(6,3)--(9,3)--(9,4);
  	\end{tikzpicture}
  \end{center}
Do đó, số cặp đường đi tốt $(f,g)$ tùy ý chính là $\displaystyle\binom{m+n}{n}\binom{m+q-p}{q}$. Ta thấy rằng nếu hai đường $f$, $g$ gặp nhau tại điểm $K$ nào đó thì thay vì xét cặp đường gấp khúc $A\to K\to D$, $B\to K\to C$, ta có thể thay đổi hướng đi thành $A\to K\to C$, $B\to K\to D$. Từ đó, dễ dàng chứng minh được tồn tại song ánh từ cặp đường đi $(f,g)$ có điểm chung đến cặp đường đi $(f',g')$ từ $A\to C$, $B\to D$. Số đường đi đó là $\displaystyle\binom{m+q}{q}\binom{m+n-p}{n}$.\\
Vậy số cặp đường đi $(f,g)$ thỏa mãn đề bài là
\[\binom{m+n}{n}\binom{m+q-p}{q}-\binom{m+q}{q}\binom{m+n-p}{n}.\]
  }
\end{bt}

\begin{bt}[Ả Rập, 2017]%[Vũ Nguyễn Hoàng Anh, ExTapChi04]%[1D0G6]
	Có bao nhiêu cách điền một hoặc nhiều dấu $+$ vào giữa $30$ số $1$ trong dãy bên dưới
	\[111111111111111111111111111111\]
	sao cho tổng thu được chia hết cho $30$?
	\loigiai{
		Ta có nhận xét nếu gọi $S(x)$ là tổng các chữ số của $x$ thì $S(x)\equiv x\pmod{3}$. Do đó, tổng thu được ở trên luôn chia hết cho $3$.\\
		Giả sử ta điền $k$ dấu $+$ thì sẽ chia các số $1$ thành $k+1$ phần. Mỗi phần có tận cùng là $1$ nên tổng của chúng có tận cùng là $k+1 \pmod{10}$. Suy ra để tổng thu được chia hết cho $30$ thì ta phải có $k+1\equiv 0\pmod{10}$ hay $k\in \{9,19,29\}$.\\
		Với mỗi $k$ như thế, áp dụng bài toán chia kẹo Euler, số cách điền sẽ là $\displaystyle\binom{29}{k}$. Vậy nên tổng số cách cần tìm là
		\[\binom{29}{9}	+ \binom{29}{19}+\binom{29}{29}.\]
	}
\end{bt}

\section{Sử dụng ma trận liên kết trong giải các bài toán tổ hợp}
\setcounter{bt}{0}
\subsection{Cơ sở lí thuyết}
Tập hợp gồm $m\cdot n$ số thực xếp thành $m$ hàng và $n$ cột gọi là một ma trận cỡ $m \times n$. Phần tử của ma trận cỡ $m \times n$ nằm ở hàng $i$ và cột $j$ kí hiệu là $a_{ij}$. Khi đó ma trận được ký hiệu là $(a_{ij})_{m\times n}$. Ma trận cỡ $n \times n$ còn gọi là ma trận vuông cấp $n$. Giả sử có hai tập hợp $X=\left\{x_1, x_2,\ldots,x_m \right\}$, $Y=\left\{y_1, y_2,\ldots,y_n \right\}$ trong đó mỗi phần tử của $X$ có quan hệ  có thể lượng hóa được với các phần tử trong $Y$. Với mỗi $i,j$ $(1\le i \le m, 1 \le j \le n)$ ta ký hiệu $a_{ij}$ là một số đặc trưng cho mỗi quan hệ giữa $x_i$ và $y_j$. Khi đó ta được ma trận $A=(a_{ij})$ cỡ $m \times n$ gọi là ma trận liên kết trong mối quan hệ giữa các phần tử trong $X$ và trong $Y$. Bằng cách xem xét mỗi liên hệ các phần tử trong ma trận $A$ ta có thể đi đến lời giải của bài toán tổ hợp. 

\subsection{Dựa vào mối quan hệ	các số hạng trong ma trận để giải toán}

\begin{bt}[IMO 2016]%[Nguyễn Tiến Tuấn,Dự án EX_TapChi04]%[1D0G6] 
 Tìm các số tự nhiên $n$ sao cho mỗi ô vuông của bảng $n \times n$ ô vuông có thể viết đúng một chữ cái $I$, $M$, $O$ thỏa mãn đồng thời hai điều kiện sau.
 \begin{enumerate}[i)]
  \item Trên mỗi hàng, trên mỗi cột có đúng $\dfrac{1}{3}$ ô viết chữ $I$, $\dfrac{1}{3}$ ô viết chữ $M$ và  $\dfrac{1}{3}$ ô viết chữ $O$.
  \item Trên mỗi đường chéo mà có số ô chia hết cho $3$ cũng có đúng  $\dfrac{1}{3}$ ô viết chữa $I$,  $\dfrac{1}{3}$ ô viết chữ $M$ và  $\dfrac{1}{3}$ ô viết chữ $O$.\\
  Chú ý: Nếu ký hiệu $(i;j)$ là ô vuông của bảng nằm ở hàng $i$ và cột $j$. Khi đó $4n-2$ đường chéo chia thành hai loại: loại một gồm các ô $(i;j)$ có $i+j$ không đổi và loại hai gồm các ô $(i;j)$ có $j-i$ không đổi.
 \end{enumerate}	
	\loigiai{
		Từ giả thiết của bài toán ta suy ra được $n$ chia hết cho $3$. Ta sẽ chứng minh $n$ chia hết cho $9$. 
		\begin{itemize}
			\item Nếu $n=9k$. Xếp $k^2$ bảng sau thành bảng $n \times n$ thỏa mãn điều kiện bài toán
			
			\begin{equation*}
			\begin{pmatrix}
			I & M & O & I & M & O & I & M & O \\
			I & M & O & I & M & O & I & M & O \\
			I & M & O & I & M & O & I & M & O \\
			M & O & I & M & O & I & M & O & I\\
			M & O & I & M & O & I & M & O & I\\
			M & O & I & M & O & I & M & O & I\\
			O & I & M & O & I & M & O & I & M\\
			O & I & M & O & I & M & O & I & M\\
			O & I & M & O & I & M & O & I & M\\
			\end{pmatrix}
			\end{equation*}
			
			\item Giả sử có một cách viết thỏa mãn điều kiện bài toán. Với mỗi $1 \le i,j \le n$, đặt $a_{ij}=1$ nếu ô $(i;j)$ viết chữ $I$, $a_{ij}=-1$ nếu ô $(i;j)$ viết chữ $M$ và $a_{ij}=0$ nếu ô $(i;j)$ viết chữ $O$. Khi đó ta có ma trận cỡ $n \times n$ có tổng các phần tử trên mỗi hàng, mỗi cột đều bằng $0$. Do $n=3m$ nên viết ma trận $A$ dưới dạng
			
			\begin{equation*}
			A=\begin{pmatrix}
			A_{11} & A_{12} & A_{13} \\
			A_{21} & A_{22} & A_{23}\\
			A_{31} & A_{32} & A_{33}
			\end{pmatrix}
			\end{equation*}
			
			trong đó $A_{ij}$, $1 \le i,j \le 3$ là các ma trận vuông cấp $m$. \\
			Từ tính chất của ma trận $A$ ta dễ dàng chứng minh được ma trận $A_{22}$ có tổng các phần tử bằng $0$, hay số chữ $I$ và chữ $M$ trong ma trận $A_{22}$ bằng nhau. Lập luận tương tự (đặt $A_{ij}=1$ nếu ô $(i;j)$ viết chữ $I$, $a_{ij}=-1$ nếu ô $(i;j)$ viết chữ $O$ và $a_{ij}=0$ nếu ô $(i;j)$ viết chữ $M$) ta chứng minh được số chữ $I$, $M$, $O$ trong các bảng ứng với ma trận $A_{22}$ bằng nhau. Điều đó chứng tỏ $m$ chia hết cho $3$. Vậy $n$ chia hết cho $9$. 
			
		\end{itemize}
	}
\end{bt}

\begin{bt}[Chọn đội tuyển PTNK-ĐHQG TP.HCM]%[Nguyễn Tiến Tuấn,Dự án EX_TapChi04]%[1D0G6] 
 Trong một hệ thống máy tính, mỗi máy tính được kết nối với ít nhất $30\%$ số máy khác trong hệ thống. Hệ thống này có một chương trình ngăn chặn và cảnh báo khá tốt, do đó khi một máy bị virus, nó chỉ đủ thời gian gây lây lan cho các máy tính khác có kết nối trực tiếp với máy tính đó. Chứng minh dù vậy, kẻ tấn công luôn có thể chọn ra hai máy tính trong hệ thống mà nếu thả virus vào hai máy tính đó thì có ít nhất $50\%$ máy tính của hệ thống bị virus. 
	\loigiai{
		Không mất tính tổng quát ta giả sử hệ thống có $100$ máy tính. Với mỗi $1 \le i, j \le 100$, đặt $a_{ij}=1$ nếu $i \neq j$ và máy tính $i$ có kết nối trực tiếp với máy tính $j$, $a_{ij}=0$ trong các trường hợp còn lại. Đặt $A=(a_{ij})$. Ta có $A$ là ma trận vuông cấp $100$ mà mỗi hàng, mỗi cột của nó ít nhất $30$ số $1$ và $a_{ij}=a_{ji}$, $\forall 1\le i,j \le 100$. \\
		Gọi $m$ là hàng nhiều số $1$ nhất của $A$ và số số $1$ của hàng $m$ là $k$. 
		\begin{itemize}
			\item Nếu $k \ge 50$ thì kết luận của bài toán là hiển nhiên. 
			\item Nếu $30 \le k < 50$ thì bằng cách đánh số lại các máy tính ta có có thể coi máy tính $m$ là máy tính thứ $k+1$ và có kết nối với các máy tính từ $1$ đến $k$. Khi đó ma trận $A$ có dạng\\
			\begin{center}			
				$A=\begin{pmatrix}
				 & & 1 & &  \\
				 B & & 1 & & C \\
				 & & \cdots & & \\
				 & & 1 & &  \\
				11\ldots 1  & & 0  & & 00\ldots 0\\
				 & & 0 & & \\
				 E & & \cdots & & D \\
				 & & 0 & & 
				\end{pmatrix}$ 
			\end{center}
			trong đó $B$, $C$, $D$, $E$ là các ma trận lần lượt có cỡ $k\times k$, $k \times (99-k)$, $(99-k)\times (99-k)$, $(99-k) \times k$. \\
			$-$ Nếu trong ma trận $D$ có một cột $j$ có không ít hơn $50-k$ số $1$ thì thả virus vào các máy $j$ và $k+1$. \\
			$-$ Nếu tất cả các cột trong $D$ đều có số số $1$ ít hơn $50-k$, khi đó số số $1$ trong $C$ lớn hơn $(99-k)(k-20)$ và như vậy phải có ít nhất một hàng $i$ của $C$ có số số $1$ không ít hơn $\left[\dfrac{(99-k)(k-20)}{k}\right]+1$. Dễ dàng chứng minh được $\left[\dfrac{(99-k)(k-20)}{k}\right]+1 \ge 50-k$, với mọi $30 \le k <50$. Khi đó thả hai con virus vào máy $k+1$ và $i$ ta sẽ được kết luận của bài toán.
			
		\end{itemize}
	}
\end{bt}

\begin{bt}[Chọn đội tuyển Bà Rịa - Vũng Tàu]%[Nguyễn Tiến Tuấn,Dự án EX_TapChi04]%[1D0G6] 
	Cho $n$ là số nguyên dương. Tìm số các hoán vị $f$ của tập hợp $\left\{1;2;3;\ldots;n\right\}$ sao cho $T=\displaystyle\sum\limits_{i=1}^{n} |f(i)-i|$ lớn nhất. 
	
	\loigiai{
		Với mỗi $1 \le i,j \le n$, đặt $a_{ij}=|f(i)-i|$ với $f(i)=j$. Xét ma trận 
		\begin{center}
			$ A=(a_{ij})=\begin{pmatrix}
			0 & 1 & 2 & \cdots & n-2 & n-1 \\
			1 & 0 & 1 & \cdots & n-3 & n-2\\
			2 & 1 & 0 & \cdots & n-4 & n-3\\
			\cdots & \cdots & \cdots & \cdots & \cdots & \cdots\\
			n-2 & n-3 & n-4 & \cdots & 0 & 1\\
			n-1 & n-2 &  n-3 & \cdots & 1 & 0
			\end{pmatrix}$. 
		\end{center}	
		Bài toán trở thành: Tìm số cách chọn $n$ phần tử của ma trận $A$ sao cho trên mỗi hàng, mỗi cột của $A$ có đúng một số được chọn và tổng các số được chọn lớn nhất. \\
		\textbf{TH1}: $n$ là số chẵn. Đặt $n=2m$. Viết ma trận $A$ dưới dạng 	$A= \begin{pmatrix}
		B & C\\
		D & E
		\end{pmatrix}$  trong đó\\
		$B=\begin{pmatrix}
		0 & 1 & \cdots & m-1 \\
		1 & 0 & \cdots & m-2\\
		\cdots & \cdots & \cdots & \cdots\\
		m-1 & m-2 & \cdots & 0
		\end{pmatrix} $;
		$C=\begin{pmatrix}
		m & m+1 & \cdots & n-1 \\
		m-1 & m & \cdots & n-2\\
		\cdots & \cdots & \cdots & \cdots\\
		1 & 2 & \cdots & m
		\end{pmatrix}$ \\
		$ D=\begin{pmatrix}
		m & m-1 & \cdots & 1 \\
		m+1 & m & \cdots & 2\\
		\cdots & \cdots & \cdots & \cdots\\
		n-1 & n-2 & \cdots & m
		\end{pmatrix}$; 
		$ E=\begin{pmatrix}
		0 & 1 & \cdots & m-1 \\
		1 & 0 & \cdots & m-2\\
		\cdots & \cdots & \cdots & \cdots\\
		m-1 & m-2 & \cdots & 0
		\end{pmatrix}$.\\  
		\textit{Nhận xét}: Chọn tùy ý $m$ phần tử của $C$ (hoặc $D$) sao cho trên mỗi hàng, mỗi cột của $C$ (hoặc $D$) có đúng một phần tử thì tổng của các phần tử được chọn không đổi và bằng $m^2$. Trên các cột của $A$, chọn lần lượt các số $b_1;b_2;\ldots;b_n$ tùy ý sao cho trên mỗi hàng của $A$ có đúng một phần tử. Ta chứng minh $\displaystyle\sum\limits_{j=1}^{n} b_j$ lớn nhất khi $b_1;b_2;\ldots;b_m$ được chọn trên $D$ và $b_{m+1};b_{m+2};\ldots;b_n$ được chọn trên $C$. Thật vậy, giả sử có $b_{j_1}=|j_1-i_1|, 0\le i_1, j_1 \le m$ được chọn trong $B$. Khi đó có một cột $j_2 \ge m$ mà số được chọn trên đó nằm trong $E$ hay $b_{j_2}=|j_2-i_2|, m \le i_2, j_2 \le n$.\\
		Khi đó tổng của các số được chọn là 
		\begin{eqnarray*}
			T'=2m^2-(j_2-i_1)-(i_2-j_1)+|j_1-i_1|+|j_2-i_2|. 
		\end{eqnarray*}
		Dễ dàng kiểm tra được $T'<2m^2$. Vậy $\displaystyle\sum\limits_{j=1}^{n} b_j$ lớn nhất khi $b_1; b_2;\ldots;b_m$ được chọn trên $D$ và $b_{m+1}; b_{m+2};\ldots;b_n$ được chọn trên $C$ hay $T$ lớn nhất khi và chỉ khi $f(1), f(2),\ldots,f(m)$ là hoán vị của $\{m+1; m+2;\ldots;n\}$ và $f(m+1); f(m+2);\ldots;f(n)$ là hoán vị của $\{1,2,\ldots,n\}$. Vậy có $\left(\dfrac{n}{2}!\right)^2$ hoán vị thỏa mãn bài toán. \\
		\textbf{TH2}: $n$ lẻ. Đặt $n=2m+1$. Lập luận tương tự như trường hợp 1 ta có $T$ lớn nhất khi và chỉ khi ${f(1), f(2),\ldots,f(m)}$ là hoán vị của $\{m+1, m+2,\ldots,n\}$	và $f(m+1), f(m+2),\ldots,f(n)$ là hoán vị của $\{1,2,\ldots,m+1\}$ hoặc $f(1), f(2),\ldots,f(m+1)$ là hoán vị của $\{m+1, m+2,\ldots,n\}$	và $f(m+2), f(m+3),\ldots,f(n)$ là hoán vị của ${1,2,\ldots,m}$. Số hoán vị thỏa mãn một trong hai điều kiện là $2(m+1)!m!$. Số hoán vị có $f(m)=m$ là $(m!)^2$. Vậy số hoán vị thỏa mãn bài toán là 
		\begin{eqnarray*}
			2(m+1)!m!-(m!)^2=(m!)^2.(2m+1)=n\left(\left[\dfrac{n}{2}!\right]\right)^2. 
		\end{eqnarray*}
	}
\end{bt}
\begin{bt}[IMO 2005]%[Nguyễn Tiến Tuấn,Dự án EX_TapChi04]%[1D0G6] 
 Trong một cuộc thi toán có $n$ thí sinh ($n \in \mathbb{N}, n \ge 5$) và $6$ bài toán được đặt ra. Biết rằng, với mỗi hai bài toán thì có nhiều hơn $\dfrac{2}{5}$ tổng số thí sinh cùng giải được và không có thí sinh nào giải được bài toán $6$. Chứng minh rằng có ít nhất hai thí sinh sao cho mỗi người giải được đúng $5$ bài toán. 
	\loigiai{
		Với mỗi $1 \le i \le 6, 1\le j \le n$, đặt $a_{ij}=1$ nếu người $j$ giải được bài toán $i$ và $a_{ij}=0$ nếu người $j$ không giải được bài $i$. Khi đó ta có ma trận $A=(a_{ij})$ cỡ $6\times n$ mà trên mỗi cột của nó có nhiều nhất $5$ số $1$, hai hàng bất kì có nhiều hơn $\dfrac{2}{5}n$ cột chung (cột chung là cột mà các phần tử của hai hàng trên mỗi cột đó đều là số $1$). Ta chứng minh bài toán bằng phản chứng bằng cách đếm số cặp số $1$ như vậy. Giả sử có nhiều nhất một thí sinh giải được $5$ bài toán, còn lại giải được không quá $4$ bài. Khi đó $A$ có nhiều nhất $1$ cột có năm số $1$ và các cột còn lại còn lại có nhiều nhất $4$ số $1$. Vậy,
		\begin{equation}\label{EXTCh4.TH.12}
		 T \le (n-1)\mathrm{C}_4^2+\mathrm{C}_5^2=6n+4.
		\end{equation}
		Giả sử $n=5p+k$, $k=0,1,2,3,4$. Do mỗi hàng của $A$ có nhiều hơn $\dfrac{2}{5}n$ cặp số $1$ chung nên: \\
		$-$ Với $k=0$ thì với mỗi hai bài có không ít hơn $2p+1$ thí sinh cùng giải được hay $T \ge 15(2p+1)$. Điều này mâu thuẫn với \eqref{EXTCh4.TH.12}. \\
		$-$ Bằng cách làm tương tự ta cũng có kết quả tương tự cho $k=1,3,4$.\\
		$-$ Với $k=2$. Khi đó ta có $30p+15 \le T \le 30p+16$. \\
		Nếu $T<6n+4$ thì có ít nhất một cột của $A$ có $3$ số $1$. Khi đó, 
		\begin{eqnarray*}
		 T \le (n-2)\mathrm{C}_4^2+\mathrm{C}_5^3+\mathrm{C}_3^2=6n+1=30p+13<30p+15, \text{ (vô lý)}.
		\end{eqnarray*}
		Vậy $T=30p+16$. Khi đó có $2$ bài có $2p+2$ thí sinh cùng giải được, còn với mỗi hai bài còn lại có $2p+1$ thí sinh cùng giải được. Như vậy, có đúng một người giải được $5$ bài và $n-1$ người giải được đúng $4$ bài. Không mất tính tổng quát ta coi hai bài có cùng $2p+2$ thí sinh giải được là bài $1$ và $2$ và thí sinh giải được bài $5$ là thí sinh $n$. Gọi $B$ là ma trận có được từ $A$ khi bỏ đi cột $n$. Ta có mỗi cột của $B$ có đúng $4$ số $1$. Ta sẽ tính số số $1$ trên mỗi hàng của $B$. \\
		\textbf{TH1}: Thí sinh là được cả hai bài $1$ và $2$. Giả sử thí sinh $n$ không làm được bài $6$. Số cặp số $1$ chung của mỗi hai hàng $(1;2), (1;6), (2;6),(3;6),(4;6),(5;6)$ là $2p+1$, số cặp số $1$ chung của mỗi hai hàng còn lại bằng $2p$. Do đó mỗi số $1$ của hàng $1$ trong $B$ thì có $3$ cặp số $1$ nằm ở $3$ trong số $5$ cặp hàng: $(1;2);(1;3), (1;4),(1;5),(1;6)$ nên số số $1$ của hàng $1$ bằng $\dfrac{10p+2}{3}$. Tương tự ta có số số $1$ của các hàng $2,3,4,5,6$ lần lượt là $\dfrac{10p+2}{3};\dfrac{10p+1}{3};\dfrac{10p+1}{3};\dfrac{10p+1}{3};\dfrac{10p+5}{3}$. \\
		Từ các kết quả trên suy ra các số $10p+1;10p+2;10p+5$ cùng chia hết cho $3$. Vô lí. \\
		\textbf{TH2}: Thí sinh $n$ không làm được một trong hai bài $1$ hoặc $2$. Giả sử thí sinh $n$ không làm được bài $1$. Tương tự trường hợp $1$ ta tính được số số $1$ trong mỗi hàng của ma trận $B$ lần lượt là: $$\dfrac{10p+6}{3};\dfrac{10p+2}{3};\dfrac{10p+1}{3};\dfrac{10p+1}{3};\dfrac{10p+1}{3};\dfrac{10p+1}{3}.$$
		Suy ra các số $10p+1; 10p+2; 10p+6$ cùng chia hết cho $3$. Vô lí. 
		
	}
\end{bt}


\subsection{Sử dụng ma trận để giải bài toán bằng quy nạp}

\begin{bt}[Harvard-Mit Mathematics Tournament 2017]%[Nguyễn Tiến Tuấn,Dự án EX_TapChi04]%[1D0G6] 
	Trong một phòng có $2017$ con ếch và $2017$ con cóc. Mỗi con ếch là bạn của đúng $2$ con cóc. Gọi $N$ là số cách ghép cặp mỗi con ếch với một con cóc là bạn của nó sao cho mỗi con cóc được ghép với không quá $1$ con ếch. Gọi $D$ là tập hợp các giá trị có thể của $N$. Tìm số phần tử của $D$ và tổng tất cả các phần tử của $D$.  
	
	\loigiai{
		Ta giải bài toán cho trường hợp tổng quát có $n$ con ếch và $n$ con cóc ($n>1$). Với mỗi $1 \le i,j \le n$, đặt $a_{ij}=1$ nếu con ếch $i$ và con cóc $j$ là bạn và $a_{ij}=0$ trong trường hợp còn lại. Khi đó ta có ma trận $A=(a_{ij})$ vuông cấp $n$ mà trên mỗi cột của nó có đúng hai số $1$. Một cách ghép cặp thỏa mãn điều kiện bài toán là một cách chọn ra $n$ số $1$ trong $A$ sao cho mỗi hàng, mỗi cột của $A$ có đúng một số $1$. Như vậy nếu ma trận $A$ có một hàng toàn số $0$ thì $N=0$.\\
		Tiếp theo ta chỉ xét trường hợp $A$ là ma trận mà mỗi hàng của nó có ít nhất một số $1$. \\
		Với mỗi $n>1$, đặt $D_n$ là tập hợp tất cả các giá trị có thể của $N$. Ta sẽ chứng minh
		\begin{equation}\label{EXTCh4.TH.13}
			D_n=\left\{0; 2^k, 1 \le k \le \dfrac{n}{2}, k \in \mathbb{Z} \right\}
		\end{equation}
		bằng quy nạp. \\
		Rõ ràng \eqref{EXTCh4.TH.13} đúng với $n=2$. \\
		Giả sử \eqref{EXTCh4.TH.13} đúng với mọi $k<n$. Ta chứng minh \eqref{EXTCh4.TH.13} đúng với $k=n$. \\
		Xét ma trận $A$ vuông cấp $n$ thỏa mãn điều kiện bài toán mà mỗi hàng của nó có ít nhất một số $1$. Gọi $S_n$ là số cách chọn ra $n$ số $1$ trong ma trận $A$ sao cho mỗi hàng, mỗi cột của $A$ có đúng một số $1$. Không mất tính tổng quát ta coi hàng $n$ của $A$ có ít số $1$ nhất, khi đó hàng $n$ hoặc có một số $1$ hoặc có $2$ số $1$. \\
		\textbf{TH1}: Hàng $n$ có một số $1$ nằm ở cột $j$. Chọn số $1$ ở hàng $n$ là $a_{nj}$ (có $1$ cách chọn) rồi bỏ hàng $n$, cột $j$ ra khỏi ma trận $A$ ta sẽ được ma trận $B$ cấp $n-1$ thỏa mãn điều kiện bài toán với $n-1$ con ếch và $n-1$ con cóc. Vì vậy $S_n=S_{n-1}$. \\
		\textbf{TH2}: Hàng $n$ có hai số $1$. Khi đó mỗi hàng của $A$ có đúng hai số $1$. Giả sử hai số $1$ ở hàng $n$ là $a_{nj_1}$ và $a_{nj_2}$ và hai số $1$ của cột $j_1$ nằm ở hàng $i$ và $n$. Chọn số $1$ ở hàng $n$ có hai cách chọn. Mỗi cách chọn ở hàng $n$ chẳng hạn đó là $a_{nj_1}$. Bằng cách bỏ đi hàng $n$ và cột $j_1$ khỏi ma trận $A$ ta được ma trận $A_1$ cấp $n-1$ có $2n-3$ số $1$ mà mỗi cột của nó có đúng $2$ số $1$, hàng $i$ có một số $1$, các hàng còn lại có hai số $1$. Lặp lại cách làm như ở trường hợp $1$ ta được số cách chọn $n-1$ số $1$ còn lại là $S_{n-2}$. Vậy $S_{n}=2S_{n-2}$. Vậy \eqref{EXTCh4.TH.13} đúng với mọi $n>1$. Với $n=2017$ ta có $D=D_{2017}=\left\{0;2;4;\ldots;2^{1008}\right\}$. 
	}
\end{bt}

\begin{bt}[VMO 2015]%[Nguyễn Tiến Tuấn,Dự án EX_TapChi04]%[1D0G6] 
	Có $m$ học sinh nữ và $n$ học sinh nam ($m,n \ge2$) tham gia một liên hoan song ca. Tại liên hoan song ca, mỗi buổi diễn là một chương trình văn nghệ. Mỗi chương trình văn nghệ bao gồm một số bài hát song ca nam-nữ mà trong đó mỗi đôi nam nữ chỉ hát với nhau không quá một bài hát và mỗi học sinh đều được hát ít nhất một bài hát. Hai chương trình gọi là khác nhau nếu có một cặp nam-nữ hát với nhau ở chương trình này nhưng không hát với nhau ở chương trình kia. Liên hoan song ca chỉ kết thúc khi tất cả các chương trình khác nhau có thể có đều được biểu diễn, mỗi chương trình được biểu diễn đúng một lần.
	\begin{enumerate}
		\item Một chương trình được gọi là lệ thuộc và học sinh $X$ nếu như hủy tất cả các bài song ca mà học sinh $X$ tham gia thì có ít nhất một học sinh khác không được hát bài nào trong chương trình đó. Chứng minh rằng trong tất cả các chương trình lệ thuộc vào $X$ thì số chương trình có số lẻ bài hát bằng số chương trình có số chẵn bài hát. 
		\item Chứng minh rằng ban tổ chức liên hoan có thể sắp xếp các buổi biểu diễn sao cho số các bài hát tại hai buổi biểu diễn liên tiếp bất kì không cùng tính chẵn lẻ. 
	\end{enumerate}
	
	\loigiai{
		Với mỗi số nguyên $i,j, 1 \le i \le m, 1 \le j \le n$, đặt $a_{ij}=1$ nếu bạn nữ $i$ song ca với bạn nam $j$ và $a_{ij}=0$ trong trường hợp còn lại. Khi đó mỗi chương trình văn nghệ ứng với một ma trận cỡ $m \times n$ mà mỗi hàng và cột của nó đều có ít nhất một số $1$. Hai chương trình khác nhau nếu hai ma trận khác nhau. Số tiết mục song ca của mỗi chương trình chính bằng số số $1$ có trong ma trận tương ứng. 
		\begin{enumerate}
			\item\label{matran-a} Gọi $S$ là tập hợp tất cả các chương trình phụ thuộc vào người $X$. Không mất tính tổng quát ta coi người $X$ là người nam $1$. Gọi $E$ là tập hợp các ma trận tương ứng vơi mỗi chương trình trong $S$ và $F$ là tập hợp các ma trận cỡ $m \times (n-1)$ có các phần tử bằng $0$ hoặc $1$ sao cho trên mỗi cột có ít nhất một số $1$ và có ít nhất $1$ hàng toàn số $0$. Khi đó, nếu ta bỏ cột $1$ của ma trận $A$ trong $E$ ta sẽ được ma trận thuộc $F$ và bằng cách thêm vào mỗi ma trận trong $F$ một cột làm cột $1$ sao cho mỗi hàng của ma trận mới có ít nhất một số $1$ ta được một ma trận thuộc vào $E$. Lấy ma trận $B$ trong $F$ có $k$ hàng toàn số $0$. Hiển nhiên ta có $k<m$. Gọi $a$ là số số $1$ có trong $B$. Khi đó mỗi cách thêm vào $B$ một cột làm cột $1$ sao cho cột đó có ít nhất $k$ số $1$ và có đúng $k$ số $1$ ở $k$ hàng toàn số $0$ của $B$ ta sẽ thu được một ma trận thuộc $E$. Bằng cách làm như vậy ta có thể tạo ra $\mathrm{C}_{m-k}^0$ mà trận có $a+k$ số $1$, $\mathrm{C}_{m-k}^1$ ma trận có $a+k+1$ số $1$,\ldots, $\mathrm{C}_{m-k}^{m-k}$ ma trận có $a+m-k$ số $1$. Do
			\begin{eqnarray*}
				\mathrm{C}_{m-k}^0-\mathrm{C}_{m-k}^1+\mathrm{C}_{m-k}^2- \cdots +{(-1)}^{m-k}\mathrm{C}_{m-k}^0=0
			\end{eqnarray*}
			nên trong số các ma trận tạo ra từ ma trận $B$ như trên có số ma trận có chẵn số $1$ bằng với số ma trận có lẻ số $1$. Từ đó suy ra kết luận bài toán. 
			\item Ta chia tập hợp các chương trình thỏa mãn điều kiện bài toán thành hai loại là $S_1$ những chương trình phụ thuộc vào học sinh nam $1$ và $S_2$ là những chương trình không phụ thuộc vào học sinh nam $1$. \\
			+ Theo câu trên ta có trong $S_1$ số chương trình có số tiết mục song ca chẵn bằng số chương trình có số tiết mục song ca lẻ. \\
			+ Ta sẽ chứng minh số chương trình có số tiết mục song ca chẵn và số chương trình có số tiết mục song ca lẻ trong $S_2$ hơn kém nhau $1$, bằng quy nạp theo $n$. \\
			Rõ ràng khẳng định đó đúng với $n=2$. Giả sử khẳng định đó đúng với $n-1$. Không mất tính tổng quát ta coi $n$ là số chẵn. Gọi $D_{m \times n}$ là tập hợp tất cả các chương trình thỏa mãn bài toán với $m$ nữ và $n$ nam. $M_{m \times n}$ là tập hợp tất cả các ma trận tương ứng với mỗi chương trình $D_{m \times n}$. \\
			\textit{Nhận xét}: Nếu lấy $B$ là ma trận trong $M_{m \times (n-1)}$ và thêm vào $B$ một cột có ít nhất một số $1$ và còn lại bằng $0$ ta được ma trận thuộc $M_{m \times n}$ ứng với một chương trình trong $S_2$. Lấy một ma trận $B$ tùy ý trong $M_{m \times (n-1)}$. Bằng cách làm tương tự như câu trên ta có: \\
			$-$ Nếu $B$ có chẵn số $1$, thì số chương trình có số tiết mục song ca chẵn nhiều hơn chương trình có số tiết mục song ca lẻ $1$ chương trình. \\
			$-$ Nếu $B$ có lẻ số $1$ thì số chương trình có số tiết mục song ca lẻ nhiều hơn số chương trình có số tiết mục song ca chẵn $1$ chương trình. Mặt khác trong $M_{m \times (n-1)}$ số ma trận có chẵn số $1$ hơn kém số ma trận có lẻ số $1$ đúng $1$ ma trận. Vậy số chương trình có số tiết mục song ca chẵn và số chương trình có số tiết mục song ca lẻ trong $S_2$ hơn kém nhau $1$. 
			
		\end{enumerate}
	}
\end{bt}

\begin{bt}[VMO 2018]%[Nguyễn Tiến Tuấn,Dự án EX_TapChi04]%[1D0G6] 
	Với mỗi số nguyên dương $n$ và $d$, gọi $S_{n}(d)$ là tập hợp tất cả các bộ số có thứ tự $(x_1;x_2\ldots;x_d)$ thỏa mãn đồng thời các điều kiện sau
	\begin{itemize}
	 \item[i)] $x_{i} \in \left\{1;2;\ldots;n\right\}, \forall 1 \le i \le d$.
	 \item[ii)] $x_{i+1} \neq x_i, \forall 1 \le i \le d-1$.
	 \item[iii)] Không tồn tại các số $1 \le i<j<k<l \le d$ sao cho $x_i=x_k$ và $x_j=x_l$.
	\end{itemize}
	\begin{enumerate}
	\item Tìm số phần tử của $S_3(5)$. 
	\item Chứng minh $S_n(d) \neq \varnothing$ khi và chỉ khi $d \le 2n-1$.
	\end{enumerate}
	
	\loigiai{
		Với mỗi $1 \le i \le d, 1 \le j \le n$ đặt $a_{ij}=1$ nếu $x_i=j$ và $a_{ij}=0$ trong những trường hợp còn lại. Khi đó mỗi phần tử của $S_n(d)$ là ma trận $A=(a_{ij})$ cỡ $d \times n$ thỏa mãn:\\
		$-$ Trên mỗi cột của $A$ có không quá ba số $1$ và không có hai số $1$ nằm trên hai hàng cạnh nhau, mỗi hàng của $A$ có đúng một số $1$. \\
		$-$ Không tồn tại $1 \le i<m<k<p<d$ sao cho $a_{ij}=a_{ik}=1$ và $a_{ml}=a_{pl}=1, \forall 1 \le j, l \le n$. \\
		Ta đồng nhất mỗi phần tử của $S_n(d)$ với một phần tử của tập $M_{d \times n}$ các ma trận $A$ như trên. Lấy $A$ tùy ý thuộc $M_{d \times n}$. Ta có \\
		\textbf{TH1:} $A$ có một cột gồm ba số $1$. Bằng cách bỏ đi hai hàng có số $1$ nằm trên cột có ba số $1$ ta được một ma trận thuộc $M_{(d-2)\times n}$.\\
		\textbf{TH2}: $A$ có một cột có hai số $1$. Bằng cách bỏ đi cột đó và hai hàng có số $1$ trên cột đó ta được một ma trận của $M_{(d-2)\times (n-1)}$.
		\begin{enumerate}
			\item Dễ đếm được $S_3(5)$ có $12$ phần tử (là các hoán vị giữa các cột của hai ma trận		
			\begin{center}
				$ \begin{pmatrix}
				1 & 0 & 0 \\
				0 & 1 & 0\\
				1 & 0 & 0\\
				0 & 0 & 1\\
				1 & 0 & 0
				\end{pmatrix}$ 
				\hspace*{0,3cm} và \hspace*{0,3cm} $ \begin{pmatrix}
				1 & 0 &0 \\
				0 & 1 & 0\\
				0 & 0 & 1\\
				0 & 1 & 0\\
				1 & 0 & 0
				\end{pmatrix} ). $
			\end{center}
			
			\item Dễ dàng kiểm tra được $S_n(d) \neq \varnothing, \forall d \le 2n-1$ và nếu $S_n(d)= \varnothing$ thì $S_k(n)	=0, \forall k>d$. Vì vậy ta chỉ cần chứng minh $S_n(2n)=\varnothing$. \refstepcounter{equation}\hfill(\theequation)\label{EXTCh4.TH.14} \\
			Rõ ràng \eqref{EXTCh4.TH.14} đúng với $n=1$, $n=2$. Giả sử \eqref{EXTCh4.TH.14} đúng với $n>1$ ta sẽ chứng minh \eqref{EXTCh4.TH.14} đúng với $n+1$. Giả sử $S_{n+1}(2n+2)\neq \varnothing$. Khi đó tồn tại ma trận $A \in M_{(2n+2)\times (n+1)}$. \\
			$-$ Nếu $A$ có một cột có hai số $1$ thì bỏ cột và hai hàng có số $1$ trên cột đó ta được ma trận thuộc vào $M_{2n\times n}$, suy ra $S_n(2n)\neq \varnothing$. Vô lí. \\
			$-$ Nếu $A$ có một cột toàn số không thì bỏ đi cột toàn số $0$ ta được ma trận thuộc $M_{(2n+2)\times n}$, suy ra $S_n(2n+2)\neq \varnothing$. Vô lí.\\
			$-$ Nếu $A$ không có cột nào có hai số $1$ và không có cột nào toàn số $0$, khi đó các cột của $A$ hoặc có ba số $1$ hoặc có một số $1$. Giả sử $A$ có $k$ cột có ba số $1$. Bằng cách làm tương tự như trường hợp $1$ ta chứng minh được: $n=2k-1$. Mặt khác bằng quy nạp ta chứng minh được với $k$ cột mà mỗi cột có ba số $1$ thì phải có nhiều hơn $k$ cột có một số $1$. Như vậy $2k=n+1 \ge 2k+1$, vô lí. Vậy $S_n(2n)=\varnothing$ hay $s_n(d)=\emptyset, \forall d>2n-1$.
		\end{enumerate}
	}
\end{bt}
\subsection{Bài tập tự luyện}
\begin{bt}[IMC 2002]
 Trong một kì thi toán có $2000$ thí sinh tham gia. Đề thi có $6$ bài toán. Biết rằng mỗi bài toán được giải bởi ít nhất $120$ thí sinh. Chứng minh, có ít nhất hai thí sinh sao cho mỗi bài toán được giải bởi ít nhất một trong hai thí sinh.
\end{bt}

\begin{bt}[Olympic toàn Nga 1996]
 Có $1600$ ủy viên tham gia vào $16000$ ủy ban. Biết rằng mỗi ủy ban có đúng $80$ ủy viên. Chứng minh rằng tồn tại hai ủy ban mà số ủy viên chung của hai ủy ban đó không ít hơn $4$.
\end{bt}

\begin{bt}
 Gọi $A_1; A_2;\ldots; A_7$ là các tập con của tập hợp $A=\left\{1;2;3;\ldots;7\right\}$, thỏa mãn $\break |A_i| \ge 3, \forall i=1,2,\ldots,7$ và với mọi $m, n \in A$ thì có duy nhất $i$ sao cho $m, n \in A_i$. Chứng minh rằng
 \begin{eqnarray*}
 	\left|A_i\bigcap A_j \right|=1, \forall i, j=1,2,\ldots,7 \text{ và } i\neq j. 
 \end{eqnarray*}
\end{bt}

\begin{bt}[Switzerland 2010]
 Trong một ngôi làng có ít nhất một người và một số hiệp hội. Mỗi người trong làng là thành viên của ít nhất $k$ hiệp hội và với hai hiệp hội bất kì thì có đúng một thành viên chung. Chứng minh rằng có ít nhất $k$ hiệp hội có số thành viên như nhau.
\end{bt}

\begin{bt}[Iran 2011]
 Một trường học có $n$ sinh viên và một số lớp học để sinh viên có thể tham gia. Mỗi sinh viên có thể tham gia một hoặc một số lớp học. Biết rằng, mỗi lớp học có ít nhất $2$ sinh viên và nếu hai lớp học có ít nhất một sinh viên chung thì số sinh viên của mỗi lớp là khác nhau. Chứng minh số lớp học không nhiều hơn $(n-1)^2$.
\end{bt}

\begin{bt}
 Gọi $A_1, A_2,\ldots,A_k$ là các tập con của $\left\{1,2,3,\ldots,n\right\}$ sao cho $A_i$ không là tập con của $A_j$ với mọi $i \neq j$. Chứng minh $k \le \mathrm{C}_n^{\left[\dfrac{n}{2}\right]}$.
\end{bt}

\begin{bt}[VMO 2003]
 Với mỗi số nguyên dương $n \ge 2$ gọi $s_n$ là số các hoán vị $(a_1, a_2,\ldots,a_n)$ của tập hợp $E_n=\left\{1,2,\ldots,n\right\}$, mà mỗi hoán vị có tính chất $1 \le |a_i-i| \le 2$ với mọi $i=1, 2,\ldots, n$. Chứng minh rằng $n>6$ ta có $1{,}75s_{n-1}<s_n<2s_{n-1}$.
\end{bt}

\begin{bt}[VMO 2016]
 Người ta trồng hai loại cây trên một miếng đất hình chữ nhật kích thước $m \times n$ ô vuông (mỗi ô một cây). Một cách trồng gọi là ấn tượng nếu như:
 \begin{itemize}
 	\item[i)] Số lượng cây trồng của hai loại cây bằng nhau.
 	\item[ii)] Số lượng chênh lệch hai loại cây trên mỗi hàng không nhỏ hơn nửa số ô của hàng đó và số lượng chênh lệch của hai loại cây trên mỗi cột không nhỏ hơn nửa số ô của cột đó.
 \end{itemize}
 \begin{enumerate}
 	\item Hãy chỉ ra một cách trồng cây ấn tượng khi $m=n=2016$. 
 	\item Chứng minh rằng nếu có một cách trồng ấn tượng thì cả $m$ và $n$ đều là bội của $4$. 
 \end{enumerate}
\end{bt}

\begin{bt}[Hà Tĩnh 2017]
 Một số lớp chuyên toán có $35$ học sinh. Thầy giáo chủ nhiệm muốn tổ chức cuộc trải nghiệm gồm $4$ chuyến đi thỏa mãn đồng thời các điều kiện sau: 
 \begin{enumerate}[i)]
 	\item Mỗi người trong lớp tham gia ít nhất một chuyến đi. 
 	\item Với mọi $k \in \left\{1,2,3\right\}$, chuyến đi thứ $k+1$ phải có ít nhất một học sinh tham gia chuyến đi thứ $k$ cùng tham gia.
 \end{enumerate}
 Tìm số cách để thầy giáo thực hiện cuộc trải nghiệm đó. 
\end{bt}



\section{Nguyên lý bù trừ và một vài ứng dụng}
Sự hấp dẫn của Toán học nằm trong sự hài lòng, thỏa mãn sau khi chúng ta tìm ra lời giải cho một bài toán khó. Bài toán đếm trong Tổ hợp là một trong những bài toán hay và khó, có nhiều ứng dụng vào thực tiễn. Trong bài viết này, tác giả xin phép được tập trung trình bày về một nguyên lý cơ bản của bài toán đếm đó là ``\textit{Nguyên lý bù trừ}'' và tìm hiểu một số ứng dụng của nguyên lý này trong các bài toán được sắp xếp theo thứ tự từ đơn giản đến phức tạp.


\subsection{Một số nguyên lý cơ bản cho các bài toán đếm}
\setcounter{bt}{0}
\noindent Nếu $A$ là một tập hợp hữu hạn thì ta ký hiệu $|A|$ là số phần tử của tập hợp $A$.
\subsubsection{1. Nguyên lý cộng}
 Cho $A_1, A_2, \dots, A_m$ là các tập hữu hạn từng đôi một rời nhau. Khi đó ta có \[ |A_1 \cup A_2 \cup \dots \cup A_m| = \sum \limits_{i=1}^{m}|A_i|.\]
\subsubsection{2. Nguyên lý nhân}
 Nếu $A_1,A_2,\dots, A_m$ là các tập hữu hạn thì \[|A_1 \times A_2 \times \dots \times A_m| = |A_1||A_2|\cdots |A_m|.\]
\subsubsection{3. Nguyên lý trừ}
Nếu $Y$ là một tập con của một tập hữu hạn $X$ thì $|X\setminus Y| = |X| - |Y|$.
\subsubsection{4. Nguyên lý bù trừ}
\begin{itemize}
 \item {\bf Công thức tính lực lượng của tập hợp}
		\begin{itemize}
			\item Cho hai tập $A$, $B$ ta có $|A \cup B| = |A|+|B|-|A\cap B|.$
			\item Cho ba tập $A$, $B$, $C$ ta có \[ |A \cup B \cup C| = |A|+|B| + |C| - |A\cap B| - |B \cap C| - |C \cap A| + |A \cap B \cap C|. \]
			\item Tổng quát: Cho các tập $A_1,A_2,\dots, A_m$ là các tập hữu hạn, ta đặt 
			\begin{align*}
			& N_1 = \sum \limits_{i=1}^m |A_1|; \ N_2 = \sum \limits_{1\le i < j \le m} | A_i \cap A_j |\\
			& N_k = \sum \limits_{1\le i_1<i_2<\cdots <i_k \le m} |A_{i_1} \cap A_{i_2} \cap \cdots A_{i_k}|\\
			& \cdots \cdots \cdots \\
			& N_m = |A_1 \cap A_2 \cap \cdots \cap A_m|
			\end{align*}
			Khi đó $\displaystyle |A_1 \cup A_2 \cup \cdots \cup A_m| = \sum \limits_{i=1}^m (-1)^{i-1} N_i$. \refstepcounter{equation}\hfill(\theequation)\label{EXTCh4.TH.4} \\
			\cm Với mỗi $\displaystyle a\in \bigcup \limits_{i=1}^m A_i$, ta chứng minh $a$ được đếm số lần như nhau ở cả hai vế của công thức \eqref{EXTCh4.TH.4}. Vì $a$ thuộc ít nhất một trong các tập $A_1, A_2, \ldots, A_m$, không mất tổng quát, giả sử $a$ thuộc đúng $k$ tập $A_1, A_2, \ldots, A_k$ trong các tập đã cho. Ta thấy trong VT \eqref{EXTCh4.TH.4}, $a$ được đếm $1$ lần. Theo VP \eqref{EXTCh4.TH.4}, $a$ cũng được đếm: $\mathrm{C}^1_k$ lần trong $\displaystyle \sum \limits_{i=1}^m |A_i|$, $\mathrm{C}_k^2$ lần trong $\displaystyle \sum \limits_{1\le i<j\le m} | A_i \cap A_j|$, $\ldots$ Do đó ở vế phải của công thức \eqref{EXTCh4.TH.4}, $a$ được đếm số lần là
			\begin{align*}
			\mathrm{C}_k^1 - \mathrm{C}_k^2 + \mathrm{C}_k^3 - \cdots + (-1)^{k-1} \mathrm{C}_k^k 
			& = \mathrm{C}_k^0 - \left( \mathrm{C}_k^0 - \mathrm{C}_k^1 + \mathrm{C}_k^2 - \mathrm{C}_k^3 + \cdots + (-1)^k \mathrm{C}_k^k \right) \\
			& = 1 - (1-1)^k = 1.
			\end{align*}
			Rõ ràng, với mỗi $\displaystyle a\notin \bigcup \limits_{i=1}^m A_i$, ở cả VP và VT của \eqref{EXTCh4.TH.4} số lần $a$ được đếm là $0$ lần. Như vậy, với mọi phần tử $a$, số lần $a$ được đếm ở VT \eqref{EXTCh4.TH.4}  và VP \eqref{EXTCh4.TH.4} là như nhau. Do đó ta có điều phải chứng minh.
		\end{itemize}
		\item {\bf Nguyên lý bù trừ (Công thức Sieve)}\\
		Giả sử $A_1, A_2, \ldots, A_m$ là các tập con của một tập hữu hạn $X$, kí hiệu $\overline{A_i}$ là phần bù của $A_i$ trong $X$, ($i=1,2,\ldots,m$) thì 
		\begin{align*}
		\left| \overline{A_1} \cap \overline{A_2} \cap \cdots \cap \overline{A_m} \right| 
		& = \left| \overline{A_1 \cup A_2 \cup \cdots \cup A_m} \right| \\
		& = |X| + \sum \limits_{k=1}^m (-1)^k \sum \limits_{1\le i_1 < i_2 \cdots < i_k \le m} \left|A_{i_1} \cap A_{i_2} \cap \cdots \cap A_{i_k} \right|\\
		& = |X| + \sum \limits_{i=1}^m (-1)^i N_i.
		\end{align*}
		\cm Theo công thức De Morgan ta có 
		\[ \left| \overline{A_1} \cap \overline{A_2} \cap \cdots \cap \overline{A_m} \right| 
		= \left| \overline{A_1 \cup A_2 \cup \cdots \cup A_m} \right|. \]
		Theo nguyên lý trừ ta có
		\[ \left| \overline{A_1 \cup A_2 \cup \cdots \cup A_m} \right| = |X| - |A_1 \cup A_2 \cup \cdots \cup A_m| = |X| + \sum \limits_{i=1}^m (-1)^i N_i.\]
	\end{itemize}


\subsection{Ứng dụng nguyên lý bù trừ giải một số bài toán trung học phổ thông}

\subsubsection{1. Bài toán mở rộng giản đồ Venn phổ thông bằng nguyên lý bù trừ}
\begin{bt}%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	Một số điện thoại $d_1 d_2 d_3 d_4 d_5 d_6 d_7$ được gọi là dễ nhớ nếu dãy $d_1 d_2 d_3$ giống $d_4d_5d_6$ hoặc $d_5 d_6 d_7$. Mỗi $d_i$ là một trong các giá trị $0,1,\ldots,9$. Hãy tính các số điện thoại dễ nhớ.
	\loigiai{
		Kí hiệu $A$ là tập các số điện thoại dễ nhớ mà $d_1 d_2 d_3$ giống $d_4d_5d_6$ và $B$ là tập các số điện thoại dễ nhớ mà $d_1 d_2 d_3$ giống $d_5d_6d_7$. Khi đó $A\cup B$ là tập tất cả các số điện thoại dễ nhớ, còn $A\cap B$ là tập tất cả các số điện thoại thỏa mãn $d_1 = d_2 = d_3 = d_4 = d_5 = d_6 = d_7$.\\
		Ta có $|A \cup B|=|A| + |B| - |A \cap B| = 10^3 \cdot 1 \cdot 10 + 10^3 \cdot 10 \cdot 1 - 10 = 19990.$
	}
\end{bt}

\begin{bt}%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	Đề thi học sinh giỏi Toán của một trường trung học phổ thông gồm có ba bài: hình học, đại số,  tổ hợp. Có $100$ học sinh tham gia kỳ thi. Kết quả chấm thi cho thấy: $80$ em giải được bài hình học, $70$ em giải được bài đại số, $50$ em giải được bài tổ hợp, $60$ em giải được cả bài hình học và đại số, $50$ em giải được cả bài hình học và bài tổ hợp, $40$ em giải được cả bài đại số và bài tổ hợp và $30$ em giải được cả ba bài. Hỏi có bao nhiêu em giải được ít nhất một bài thi?
	\loigiai{
		Kí hiệu $A_1$ là tập các học sinh giải được bài hình học, $A_2$ là tập hợp các học sinh giải được bài đại số, $A_3$ là tập hợp các học sinh giải được bài tổ hợp. Khi đó, tập hợp học sinh giải được ít nhất một bài là $A_1 \cup A_2 \cup A_3$. Ta có 
		\begin{align*}
		|A_1 \cup A_2 \cup A_3| & = |A_1|+|A_2| + |A_3| - |A_1\cap A_2| - |A_2 \cap A_3| - |A_3 \cap A_1| + |A_1 \cap A_2 \cap A_3|\\
		& = 80 + 70 + 50 - 60 - 50 - 40 + 30 = 80.
		\end{align*}
	}
\end{bt}

\subsubsection{2. Đếm số phần tử trong tập hợp $\pmb{X}$ không thỏa mãn tính chất $\boldsymbol{\alpha_k}$ ($\boldsymbol{k=1,2,\ldots,n}$) nào cả}
\begin{bt}%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	Cho số nguyên dương $n$. Tính số các số nguyên dương không lớn hơn $n(n+1)(n+2)$ mà không chia hết cho cả ba số $n$, $n+1$, $n+2$.
	\loigiai{
		Kí hiệu $X$ là tập các số nguyên dương không lớn hơn $n(n+1)(n+2)$. Giả sử $A_1$, $A_2$, $A_3$ tương ứng là các tập con của $X$ gồm các số chia hết cho $n$, $n+1$, $n+2$. Khi đó $A = X \setminus (A_1 \cup A_2 \cup A_3)$ là tập các số nguyên dương thỏa mãn yêu cầu bài toán.\\
		Dễ thấy $|A_1| = (n+1)(n+2)$, $|A_2| = |n(n+2)|$, $|A_3|= n(n+1)$.\\
		Mặt khác $A_1 \cap A_2 = \{ k \in X | k \ \vdots \ n(n+1)\}$. Do đó $|A_1 \cap A_2| = n+2$. Tương tự $|A_2 \cap A_3| = n$. Ta còn phải tính $|A_3 \cap A_1|$, $|A_1 \cap A_2 \cap A_3|$. Xét 2 trường hợp\\
		Trường hợp 1: $n$ lẻ. Khi đó $n$, $n+2$ nguyên tố cùng nhau, do đó $|A_3 \cap A_1| = n+1$, $|A_1 \cap A_2 \cap A_3| = 1$.\\
		Trường hợp 2: $n$ chẵn. Khi đó $(n,n+2)=2$, do đó $|A_3 \cap A_1| = 2(n+1)$, $|A_1 \cap A_2 \cap A_3| = 2$. \\
		Theo nguyên lý bù trừ ta có 
		$\heva{& |A_1 \cup A_2 \cup A_3| = 3n(n+1) && \text{nếu}\ n \ \text{lẻ}\\
			& |A_1 \cup A_2 \cup A_3| = n(3n+2) && \text{nếu} \ n \ \text{chẵn}.}$\\
		Từ đó $|A|=n^3-n$ nếu $n$ lẻ và $|A|=n^3$ nếu $n$ chẵn.
	}  
\end{bt}

\begin{bt}%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6] 
	Cho số $1122334567$. Hỏi có bao nhiêu cách sắp xếp các chữ số của số trên sao cho không có hai chữ số giống nhau nào đứng cạnh nhau?
	\loigiai{
		Gọi $X_1$, $X_2$, $X_3$ lần lượt là các tập hợp các số sau khi sắp xếp có hai chữ số $1$, hai chữ số $2$, hai chữ số $3$ đứng cạnh nhau. Ta đi tính $|X_1|$ như sau: Coi hai chữ số $1$ đứng cạnh nhau tạo thành một phần tử. Khi đó ta có số hoán vị của $9$ phần tử là $9!$, tuy nhiên hoán vị hai chữ số $2$ không làm thay đổi số đó, hoán vị hai chữ số $3$ cũng như vậy. Do đó $|X_1|=\dfrac{9!}{2! \cdot 2!}$.\\
		Tương tự $|X_2|=|X_3|=\dfrac{9!}{2! \cdot 2!}$, $|X_1 \cap X_2| = |X_2 \cap X_3| = |X_3 \cap X_1| = \dfrac{8!}{2!}$, $|X_1 \cap X_2 \cap X_3| = 7!$.\\
		Số cách sắp xếp các chữ số đã cho là $\dfrac{10!}{2! \cdot 2! \cdot 2!}$.\\
		Theo nguyên lý bù trừ số cách sắp xếp các chữ số trên sao cho không có hai chữ số giống nhau nào đứng cạnh nhau là $\dfrac{10!}{2!\cdot 2! \cdot 2!} - \dfrac{3\cdot 9!}{2! \cdot 2!} + \dfrac{3\cdot 8!}{2!}-7!= 236880$.	
	}
\end{bt}

\begin{bt}[China Mathematical Competition 1994]%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	Giả sử tất cả các số nguyên dương nguyên tố cùng nhau với $105$ được xếp thành dãy số tăng $a_1, a_2, a_3, \ldots$ Tính $a_{1000}$.
	\loigiai{
		Đặt $a_{1000}=n$, $S=\{1,2,\ldots,n\}$ và $A_i=\{k \in S | k \ \vdots \ i \}$, $i=3,5,7$. Vì $105 = 3 \cdot 5 \cdot 7$ nên $k$ nguyên tố cùng nhau với $105$ khi và chỉ khi $k$ không chia hết cho $3$, $5$ và $7$. Theo nguyên lý bù trừ ta có
		\begin{align}
		1000 & = \left| \overline{A_3} \cap \overline{A_5} \cap \overline{A_7} \right| \nonumber\\
		& = |S| - |A_3|-|A_5|-|A_7| + |A_3 \cap A_5| + |A_5 \cap A_7| + |A_3 \cap A_7| - |A_3 \cap A_5 \cap A_7|\nonumber \\
		& = n - \left[ \dfrac{n}{3} \right] - \left[ \dfrac{n}{5} \right] - \left[ \dfrac{n}{7} \right] + \left[ \dfrac{n}{3 \cdot 5} \right] + \left[ \dfrac{n}{5 \cdot 7} \right] + \left[ \dfrac{n}{3 \cdot 7} \right] - \left[ \dfrac{n}{3 \cdot 5 \cdot 7} \right].\label{EXTCh4.TH.5}
		\end{align}
		Áp dụng bất đẳng thức $\alpha - 1 < [\alpha] \le \alpha$, suy ra
		\[ 1000 > n - \left( \dfrac{n}{3} + \dfrac{n}{5} + \dfrac{n}{7} \right) + \left( \dfrac{n}{3 \cdot 5} - 1 + \dfrac{n}{5 \cdot 7} - 1 + \dfrac{n}{3 \cdot 7} - 1 \right) - \dfrac{n}{3 \cdot 5 \cdot 7} \]
		và \[ 1000 < n  - \left( \dfrac{n}{3} - 1 + \dfrac{n}{5} - 1 + \dfrac{n}{7} - 1 \right) + \left( \dfrac{n}{3 \cdot 5} + \dfrac{n}{5 \cdot 7} + \dfrac{n}{3 \cdot 7} \right) - \left( \dfrac{n}{3 \cdot 5 \cdot 7} - 1 \right).\]
		Từ đó ta có $2178 \dfrac{3}{4} < n < 2194 \dfrac{1}{16}$. Vì $n$ và $105$ nguyên tố cùng nhau nên $n$ nhận một trong các giá trị $2179$, $2182$, $2183$, $2186$, $2188$, $2189$, $2192$, $2194$. Thử trực tiếp các con số này vào \eqref{EXTCh4.TH.5} ta được $n=2186$ thỏa mãn. Vậy $a_{1000}=2186$. 
	}
\end{bt}

\begin{bt}%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	Dãy số $\{a_n\}$ thu được từ dãy các số nguyên dương $\{1,2,3,\ldots\}$ bằng cách xóa đi các số là bội của $3$ hoặc $4$, nhưng không là bội của $5$. Tính số hạng $a_{2009}$.
	\loigiai{
		Đặt $a_{2009}=n$, $S=\{1,2,\ldots,n\}$ và $A_i=\{k \in S | k \ \vdots \ i \}$, $i=3,4,5$.\\
		Như vậy tập hợp các số không bị xóa là $\left( \overline{A_3} \cap \overline{A_4} \cap \overline{A_5} \right) \cup A_5$. Theo nguyên lý bù trừ ta có
		\begin{align}
		2009 & = \left| \left( \overline{A_3} \cap \overline{A_4} \cap \overline{A_5} \right) \cup A_5 \right| = \left| \overline{A_3} \cap \overline{A_4} \cap \overline{A_5} \right| + |A_5|\nonumber\\
		& = |S| - \sum \limits_{i=3}^5 |A_i| + \sum \limits_{3\le i<j\le 5} |A_i \cap A_j|- |A_3 \cap A_4 \cap A_5|+|A_5|\nonumber\\
		& = n - \left[ \dfrac{n}{3} \right] - \left[ \dfrac{n}{4} \right] - \left[ \dfrac{n}{5} \right] + \left[ \dfrac{n}{3 \cdot 4} \right] + \left[ \dfrac{n}{4 \cdot 5} \right] + \left[ \dfrac{n}{3 \cdot 5} \right] - \left[ \dfrac{n}{3 \cdot 4 \cdot 5} \right] + \left[ \dfrac{n}{5} \right] \nonumber\\
		& = n - \left[ \dfrac{n}{3} \right] - \left[ \dfrac{n}{4} \right] + \left[ \dfrac{n}{3 \cdot 4} \right] + \left[ \dfrac{n}{4 \cdot 5} \right] + \left[ \dfrac{n}{3 \cdot 5} \right] - \left[ \dfrac{n}{3 \cdot 4 \cdot 5} \right]\quad. \label{EXTCh4.TH.6}
		\end{align}
		Áp dụng bất đẳng thức $\alpha - 1 < [\alpha] \le \alpha$, suy ra
		\begin{equation}\label{EXTCh4.TH.7}
		 2009 < n  - \left( \dfrac{n}{3} - 1\right) - \left(\dfrac{n}{4} - 1 \right) + \left( \dfrac{n}{3 \cdot 4} + \dfrac{n}{4 \cdot 5} + \dfrac{n}{3 \cdot 5} \right) - \left( \dfrac{n}{3 \cdot 4 \cdot 5} - 1 \right) = \dfrac{3}{5}n+3
		\end{equation}
		và
		\begin{equation}\label{EXTCh4.TH.8}
		 2009 > n - \dfrac{n}{3} - \dfrac{n}{4} + \left( \dfrac{n}{3 \cdot 4} - 1 + \dfrac{n}{4 \cdot 5} - 1 + \dfrac{n}{3 \cdot 5} - 1 \right) - \dfrac{n}{3 \cdot 4 \cdot 5} = \dfrac{3}{5}n -3.
		\end{equation}
		Từ đó \eqref{EXTCh4.TH.7} và \eqref{EXTCh4.TH.8} suy ra $3343\dfrac{1}{3}<n<3353\dfrac{1}{3}$.\\
		Mặt khác, $n$ không nằm trong dãy $\{a_n\}$ nên $n$ nhận giá trị trong các giá trị: $3345$, $3346$, $3347$, $3349$, $3350$, $3353$. Thay trực tiếp các giá trị vào phương trình \eqref{EXTCh4.TH.6} ta được $n=3347$ là giá trị cần tìm. \\
		Vậy $a_{2009}=3347$.
	}
\end{bt}
\subsubsection{3. Bài toán đếm số bộ nghiệm nguyên của phương trình nghiệm nguyên}
Nhắc lại bài toán chia kẹo ``\textit{Có $m$ cái kẹo giống nhau chia cho $n$ đứa trẻ. Hỏi có tất cả bao nhiêu cách chia kẹo?}''. Bài toán chia kẹo tương đương với bài toán sau đây.

\begin{bt}\label{NguyenLyBuTru_1}%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	Tìm số nghiệm nguyên không âm của phương trình $x_1 + x_2 + \cdots + x_n = m$ với $m,n \in \mathbb{N}^*$.
	\loigiai{
		Giả sử bộ $(x_1,x_2,\ldots,x_n)$ là một nghiệm nguyên không âm của phương trình $x_1 + x_2 + \cdots + x_n = m$. Ta có tương ứng $1-1$ mỗi nghiệm này với bộ $\underbrace{1\ldots 1}_{x_1}0 \underbrace{1\ldots 1}_{x_2}0\ldots 0 \underbrace{1 \ldots 1}_{x_n}$ gồm $m$ số $1$ và $n-1$ số $0$. Số nghiệm của phương trình bằng số cách chọn $n-1$ vị trí để đặt chữ số $0$ trong $m+n-1$ vị trí và các vị trí còn lại đặt số $1$. Suy ra số cách chia kẹo là $\mathrm{C}_{m+n-1}^{n-1}$.
	}
\end{bt}

\begin{bt}%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	Cho $n$ số tự nhiên $a_1, a_2, \ldots, a_n$. Tìm số nghiệm tự nhiên của phương trình $$x_1+x_2+\cdots+ x_n =m$$ thỏa mãn $x_i \ge a_i$ với mọi $i\in\{1,2,\ldots,n\}$.
	\loigiai{
		Đặt $y_i =x_i - a_i$, $i\in\{1,2,\ldots,n\}$ và $\displaystyle S=\sum \limits_{i=1}^n a_i$.\\
		Khi đó ta có
		\begin{equation}\label{EXTCh4.TH.9}
		 y_1 + y_2 + \cdots + y_n = m - S.
		\end{equation}
		Bài toán trở thành tìm số nghiệm nguyên không âm của phương trình \eqref{EXTCh4.TH.9}.
		\begin{itemize}
			\item Nếu $m<S$ thì phương trình \eqref{EXTCh4.TH.9} vô nghiệm.
			\item Nếu $m=S$ thì phương trình \eqref{EXTCh4.TH.9} có một nghiệm.
			\item Nếu $m>S$ thì phương trình \eqref{EXTCh4.TH.9} có $\mathrm{C}_{m+n-S-1}^{n-1}$ nghiệm.
		\end{itemize}
	}
\end{bt}

\begin{bt} \label{NguyenLyBuTru_2}%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	Tìm số nghiệm nguyên không âm của bất phương trình $x_1 + x_2 + \cdots + x_n \le m$ với $m,n\in\mathbb{N}^*$.
	\loigiai{
		Đặt $x_{n+1}=m-(x_1+x_2+\cdots+x_n)$. Ta có $x_1 + x_2 + \cdots + x_n + x_{n+1}=m$, và $x_{n+1}\in \mathbb{N}$. Như vậy bài toán trở thành đếm số nghiệm nguyên không âm của phương trình $x_1 + x_2 + \cdots + x_n + x_{n+1} = m$. \\
		Vậy ta có $\mathrm{C}_{m+n}^n$ nghiệm.
	\begin{nx}
	 Áp dụng bài toán chia kẹo trên và nguyên lý bù trừ chúng ta sẽ giải quyết được một số bài toán đếm số nghiệm nguyên của phương trình nghiệm nguyên nhiều ẩn thỏa mãn các điều kiện cho trước.
	\end{nx}
	}
\end{bt}

\begin{bt}%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	Tìm số nghiệm nguyên của phương trình $x_1 + x_2 + x_3 + x_4 = 30$ với $5 \le x_i \le 10$, $i=\overline{1,4}$.
	\loigiai{
		Đặt $y_i = x_i - 5 \Rightarrow 0 \le y_i \le 5$, $i = \overline{1,4}$. Ta có phương trình
		\begin{equation}\label{EXTCh4.TH.10}
		 y_1 + y_2 + y_3 + y_4 = 10.
		\end{equation}
		Gọi $X$ là tập các nghiệm nguyên không âm của phương trình \eqref{EXTCh4.TH.10}, ta có $|X|= \mathrm{C}^{3}_{13}$.\\
		Gọi $A$ là tập nghiệm nguyên không âm của \eqref{EXTCh4.TH.10} thỏa mãn $y_i \ge 6$. Đặt $Y_1 = y_1 - 6$, phương trình \eqref{EXTCh4.TH.10} trở thành $Y_1 + y_2 + y_3 + y_4 = 4$.\\
		Theo bài toán \ref{NguyenLyBuTru_1} ta có $|A| = \mathrm{C}_7^3$. \\
		Tương tự, gọi $B$, $C$, $D$ lần lượt là tập nghiệm nguyên không âm của \eqref{EXTCh4.TH.10} thỏa mãn $y_2 \ge 6$, $y_3 \ge 6$, $y_4 \ge 6$. Ta có $|B|=|C|=|D|=\mathrm{C}_7^3$.\\
		Dễ thấy
		\begin{align*}
		& |A\cap B| = |A\cap C| = |A \cap D| = |B \cap C| = |B \cap D| = |C \cap D| = 0,\\
		& |A \cap B \cap C| = |A \cap B \cap D| = |A \cap C \cap D| = |B \cap C \cap D| = 0, \\
		& |A \cap B \cap C \cap D| = 0.
		\end{align*}
		Theo nguyên lý bù trừ ta có số nghiệm bằng 
		\begin{align*}
		|X| -|A| & - |B|  - |C| - |D|  + |A\cap B| + |A \cap C| + |A \cap D| + |B\cap C| + |B \cap D| + |C\cap D| \\
		& - |A\cap B \cap C| - |A \cap B \cap D| - |A\cap C \cap D| - |B \cap C \cap D| + |A \cap B \cap C \cap D| \\
		&= \mathrm{C}_{13}^3 - 4 \cdot \mathrm{C}_7^3 = 146.
		\end{align*}
	}
\end{bt}

\begin{bt}%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	Cho số nguyên dương $n$ chia hết cho $6$. Gọi $a_n$ là số các bộ gồm ba thành phần là các số nguyên không âm đôi một khác nhau có tổng không vượt quá $n$.  Hãy xác định biểu thức của $a_n$ theo $n$.
	\loigiai{
		Đặt $A=\{(x;y;z) \in \mathbb{Z}^3|x,y,z\ge 0; x+y+z\le n\}$.\\
		Theo bài toán \ref{NguyenLyBuTru_2} ta có $|A| = \mathrm{C}_{n+3}^3 = \dfrac{(n+1)(n+2)(n+3)}{6}$.\\
		Đặt $A_1$, $A_2$, $A_3$ lần lượt là các tập con của $A$ gồm các bộ $(x;y;z)$ thỏa mãn $x=y$; $y=z$; $z=x$.\\
		Nếu $(x;y;z)\in A_1$ thì $x+y=2x$ là một số chẵn, do đó nó có thể nhận một trong $\dfrac{n}{2}+1$ giá trị $0,2,\ldots,n$.\\
		Nếu $2x=2k$ với $0\le k \le \dfrac{n}{2}$ thì $z$ có $n-2k+1$ cách chọn.\\
		Vậy $\displaystyle |A_1| = \sum \limits_{k=0}^{\frac{n}{2}} (n-2k+1) = \dfrac{(n+2)^2}{4}$.\\
		Do vai trò $A_1$, $A_2$, $A_3$ như nhau nên $|A_2|=|A_3|=|A_1|=\dfrac{(n+2)^2}{4}$. Ta lại có
		\[|A_1 \cap A_2| = |A_2 \cap A_3| = |A_3 \cap A_1| = |A_1 \cap A_2 \cap A_3| = \dfrac{n}{3}+1.\]
		Từ đó ta có 
		\begin{align*}
		a_n & = |A \setminus \left( A_1 \cup A_2 \cup A_3 \right)|\\
		& = |A| - |A_1| - |A_2| - |A_3| + |A_1 \cap A_2| + |A_2 \cap A_3| + |A_3 \cap A_1| - |A_1 \cap A_2 \cap A_3|\\
		& = \dfrac{(n+1)(n+2)(n+3)}{6} - 3 \cdot \dfrac{(n+2)^2}{4} + 3 \left( \dfrac{n}{3}+1 \right)  - \left( \dfrac{n}{3}+1 \right)\\
		& = \dfrac{n(2n^2+3n-6)}{12}.
		\end{align*}
	}
\end{bt}

\subsubsection{4. Bài toán Bernoulli - Euler và bài toán Lucas}
\begin{bt}[Bài toán Bernoulli - Euler]%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	 Có $n$ lá thư và $n$ phong bì ghi sẵn địa chỉ. Bỏ ngẫu nhiên các lá thư vào phong bì. 
	\begin{enumerate}
		\item Hỏi xác suất để xảy ra sự kiện không một lá thư nào bỏ đúng địa chỉ là bao nhiêu?
		\item Hỏi xác suất để đúng $r$ lá thư đúng địa chỉ là bao nhiêu? ($r \le n$).
	\end{enumerate}
	\loigiai{
		\begin{enumerate}
		\item Gọi $X$ là tập tất cả các cách bỏ thư vào phong bì. Ta có $|X| = n!$.\\
		Gọi $A_i$, $(1 \le i \le n)$, là tập tất cả các cách bỏ thư sao cho lá thư thứ $i$ đúng địa chỉ. Ta có $|A_i| = (n-1)!$.\\
		Dễ thấy $|A_i \cap A_j| = (n-2)!$, $|A_{i_1} \cap A_{i_2} \cap \cdots \cap A_{i_k}|=(n-k)!$, ($1\le i_1 < i_2 < \cdots < i_k \le n$).\\
		Theo nguyên lý bù trừ ta có số cách bỏ thư để không có một lá thư nào đúng địa chỉ là
		\begin{align*}
		D_n & = |X| - \sum \limits_{i=1}^n |A_i| + \sum \limits_{1\le i<j\le n} | A_i \cap A_j| - \cdots + (-1)^n |A_1 \cap A_2 \cap \cdots \cap A_n|\\
		& = n! - \mathrm{C}_n^1 (n-1)! + \mathrm{C}_n^2 (n-2)! - \cdots + (-1)^n \cdot \mathrm{C}_n^n \cdot 0!\\
		& = n! \left( 1 - \dfrac{1}{1!} + \dfrac{1}{2!} - \cdots + \dfrac{(-1)^n}{n!} \right) = n! \cdot \sum \limits_{k=0}^n \dfrac{(-1)^k}{k!}.
		\end{align*}
		Suy ra xác suất cần tính là $\displaystyle \sum \limits_{k=0}^n \dfrac{(-1)^k}{k!}$.\\
		Số $\displaystyle D_n = n! \cdot \sum \limits_{k=0}^n \dfrac{(-1)^k}{k!}$ chính là số các hoán vị $\sigma$ của tập $\{1,2,\dots,n\}$ thỏa mãn $\sigma(i) \ne i$, $\forall i \in \{1,2,\dots,n \}$, nó được gọi là số mất trật tự.
		\item Số cách bỏ thư để đúng $r$ lá thư đúng địa chỉ là 
		\begin{align*}
		\mathrm{C}_n^r \cdot D_{n-r} & = \mathrm{C}_n^r \cdot (n-r)! \left( 1 - \dfrac{1}{1!} + \dfrac{1}{2!} - \cdots + \dfrac{(-1)^{n-r}}{(n-r)!} \right) \\
		& = \dfrac{n!}{r!} \left( 1 - \dfrac{1}{1!} + \dfrac{1}{2!} - \cdots + \dfrac{(-1)^{n-r}}{(n-r)!} \right).
		\end{align*}
		Do đó xác suất để đúng $r$ lá thư đúng địa chỉ là $ \dfrac{1}{r!} \left( 1 - \dfrac{1}{1!} + \dfrac{1}{2!} - \cdots + \dfrac{(-1)^{n-r}}{(n-r)!} \right).$
		\end{enumerate}
	}
\end{bt}

\begin{bt}%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	Có bao nhiêu cách sắp xếp $n$ cặp vợ chồng thành một hàng ngang sao cho không có anh nào ngồi kề vợ mình?
	\loigiai{
		Gọi $S$ là tập tất cả các hoán vị của $n$ cặp vợ chồng khi xếp thành một hàng ngang. Ta có $|S|=(2n)!$. Gọi $A_i$ là tập tất cả các hoán vị $n$ cặp vợ chồng khi xếp thành một hàng ngang mà cặp vợ chồng thứ $i$ ngồi kề nhau. \\
		Theo nguyên lý bù trừ ta có số cách xếp thỏa mãn yêu cầu đề bài là
		\begin{align*}
		\left| \bigcap \limits_{i=1}^n \overline{A_i} \right| 
		= &|S| - \sum \limits_{i=1}^n |A_i| + \sum \limits_{1\le i<j\le n} | A_i \cap A_j| - \cdots + (-1)^n |A_1 \cap A_2 \cap \cdots \cap A_n|\\
		= & (2n)! - \mathrm{C}_n^1 \cdot 2 \cdot (2n-1)! + \mathrm{C}_n^2 \cdot 2^2 \cdot (2n-2)!- \cdots + \cdots (-1)^k \cdot \mathrm{C}_n^k \cdot 2^k \cdot (2n-k)! +\\
		& + \cdots + (-1)^n \cdot \mathrm{C}_n^n \cdot 2^n \cdot n!\\
		= & (2n)! + \sum \limits_{k=1}^n (-1)^k \cdot \mathrm{C}_n^k \cdot 2^k \cdot (2n-k)!.
		\end{align*}
	}
\end{bt}

\begin{bt}%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	Cho tập $A = \{a_1, a_2, \ldots, a_n\}$ gồm $n$ phần tử phân biệt $(n\ge 2)$. Có bao nhiêu cách sắp xếp các phần tử của $A$ sao cho $a_{i+1}$ không nằm ngay sau $a_i$, $i\in\{1,2,\ldots,n-1\}$?
	\loigiai{
		Giả sử $A_i$ là tập tất cả các cách sắp xếp các phần tử của $A$ sao cho $a_{i+1}$ nằm ngay sau $a_i$. Ta có số cách sắp xếp thỏa mãn đề bài là 
		\[M_n = n! - |A_1 \cup A_2 \cup \cdots \cup A_{n-1}|.\]
		Với $\varnothing \ne \{i_1,i_2,\ldots,i_r\} \subset \{1,2,\ldots,n-1\}$ ta có $|A_{i_1} \cap A_{i_2}\cap \cdots \cap A_{i_r}|$ là tập tất cả các cách sắp xếp các phần tử của $A$ mà với mỗi $j=1,2,\ldots,r$, phần tử $a_{i_j+1}$ nằm ngay sau phần tử $a_{i_j}$, ta coi hai phần tử đứng liền nhau này tạo thành một khối. Chẳng hạn khi $i_1 = 2$, $i_2 =3$, $i_3 =5$, $i_4 =6$, $i_5=7$, $i_6 = 10$ ta sẽ thu được các khối là $(a_2, a_3, a_4)$, $(a_5,a_6,a_7,a_8)$, $(a_{10}, a_{11})$. \\
		Rõ ràng, $|A_{i_1} \cap A_{i_2} \cap \cdots \cap A_{i_r}|$ bằng số cách sắp xếp các khối và các phần tử còn lại của $A$. Nếu có $b$ khối thì có $b+r$ phần tử của $A$ tham gia vào các khối đó, do đó các phần tử còn lại của $A$ không tham gia các khối đó là $n-b-r$. Suy ra 
		$|A_{i_1} \cap A_{i_2} \cap \cdots \cap A_{i_r}| = (b+n-b-r)! = (n-r)!.$
		Như vậy $\displaystyle |A_1 \cup A_2 \cup \cdots \cup A_{n-1}| = \sum \limits_{r=1}^{n-1} (-1)^{r+1} \mathrm{C}_{n-1}^r (n-r)!.$\\
		Từ đó ta có
		\begin{align*}
		M_n & = n! - |A_1 \cup A_2 \cup \cdots \cup A_{n-1}| = n! - \sum \limits_{r=1}^{n-1} (-1)^{r+1} \mathrm{C}_{n-1}^r (n-r)!\\
		& = \sum \limits_{r=0}^{n-1} (-1)^r \mathrm{C}_{n-1}^r (n-r)! = (n-1)! \sum \limits_{r=0}^{n-1} (-1)^r \dfrac{n-r}{r!}.
		\end{align*}
	}
\end{bt}

\begin{bt}[Bài toán Lucas]%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	Có một bàn tròn, xung quanh có $2n$ ghế. Cần sắp xếp chỗ ngồi cho $n$ cặp vợ chồng sao cho các ông ngồi xen kẽ các bà và không có cặp vợ chồng nào ngồi cạnh nhau. Hỏi có bao nhiêu cách xếp?
	\loigiai{
		Trước tiên ta hiểu hai cách xếp chỗ ngồi được coi là khác nhau nếu có ít nhất một ghế được ngồi bởi hai người khác nhau trong hai cách xếp đó.\\
		* Xếp chỗ cho các bà trước theo nguyên tắc giữa hai bà để một ghế trống (dành cho các ông).\\
		+ Nếu các bà ngồi ghế lẻ thì có $n!$ cách sắp xếp.\\
		+ Nếu các bà ngồi ghế chẵn thì có $n!$ cách sắp xếp.\\
		Vậy tổng cộng là $2n!$ cách xếp các bà.\\
		Số cách sắp xếp cần tính là $M_n=2n! \cdot s$ với $s$ là số cách sắp xếp $n$ ông chồng ngồi vào $n$ ghế còn lại thỏa mãn điều kiện không ông nào ngồi cạnh vợ mình.
		\begin{itemize}
			\item Đánh số các bà (đã xếp) theo thứ tự từ $1$ đến $n$ theo trật tự vòng tròn, đánh số các ông tương ứng với các bà (ông $i$ là chồng bà $i$), đánh số các ghế trống theo quy tắc: ghế số $i$ là ghế giữa bà $i$ và bà $i+1$ (quy ước $n+1=1$). Việc xếp ghế cho các ông là một song ánh $F$ từ tập các ghế vào tập các ông với quy ước $F(i) = j$ tức là ghế $i$ được xếp cho ông $j$.
			\item Ta cần tìm $s$ là số song ánh đi từ tập $\{1,2,\ldots,n\}$ vào chính nó thỏa mãn điều kiện $F(i) \ne i$, $F(i) \ne i+1$ với mọi $i=1,2,\ldots,n$. Gọi $P_i$ là tính chất $F(i) = i$, $Q_i$ là tính chất $F(i) = i+1$.
		\end{itemize}
		Khi đó ta có $s=n! - N_1 + N_2 - \cdots + (-1)^{2n}N_{2n}$ với $N_k$ là tổng tất cả các song ánh thỏa mãn $k$ tính chất lấy từ $2n$ tính chất đang xét.\\
		Dễ thấy $P_i$, $Q_i$ hoặc $P_{i+1}$, $Q_i$ không đồng thời được thỏa mãn. Vì thế ta cần lấy ra $k$ tính chất trong $2n$ tính chất đang xét sao cho $P_i$, $Q_i$ hoặc $P_{i+1}$, $Q_i$ không đồng thời được thõa mãn. Với mỗi cách lấy $k$ tính chất như vậy, $(k\le n)$ ta lại có $(n-k)!$ song ánh thỏa mãn. Ta xếp các tính chất đang xét trên một vòng tròn $P_1, Q_1, P_2, Q_2, \ldots, P_{2n}, Q_{2n}$. Ta đi tìm số cách lấy ra $k$ phần tử trong $2n$ phần tử được xếp trên một vòng tròn sao cho không có hai phần tử kề nhau nào được chọn. Ta xét hai bài toán sau:\\
		{\bf Bài toán 1:} Có bao nhiêu cách lấy ra $k$ phần tử trong $m$ phần tử xếp trên đường thẳng sao cho không có hai phần tử liền nhau nào được chọn?\\
		Khi ta lấy ra $k$ phần tử, còn lại $m-k$ phần tử. Giữa $m-k$ phần tử đó có $m-k+1$ khoảng trống (kể cả khoảng trống ở hai đầu). Mỗi cách lấy ra $k$ khoảng từ $m-k+1$ khoảng này tương ứng với một cách chọn $k$ phần tử thỏa mãn đề bài, do đó số cần tìm là $\mathrm{C}_{m-k+1}^k$.\\
		{\bf  Bài toán 2:} Giống như bài toán $1$, nhưng $m$ phần tử xếp trên một vòng tròn.\\
		Cố định phần tử $a$ trong $m$ phần tử. Chia các cách lấy thành hai lớp
		\begin{enumerate}[1.]
			\item Các cách mà $a$ được chọn, khi đó hai phần tử kề $a$ không được chọn. Như vậy ta chọn $k-1$ phần tử trong $m-3$ phần tử. Các phần tử này được xem như nằm trên đường thẳng giống bài toán $1$, ta có $\mathrm{C}_{m-k-1}^{k-1}$ cách chọn.
			\item Các cách mà $a$ không được chọn, khi đó ta bỏ $a$ đi, ta chọn $k$ phần tử trong $m-1$ phần tử được xem như xếp trên đường thẳng, do đó có $\mathrm{C}_{m-k}^k$.
		\end{enumerate}
		Do đó số cách chọn ở bài toán $2$ là $\mathrm{C}_{m-k-1}^{k-1} + \mathrm{C}_{m-k}^k = \dfrac{m}{m-k} \mathrm{C}_{m-k}^k$.\\
		Như vậy số cách lấy ra $k$ phần tử trong $2n$ phần tử được xếp trên một vòng tròn sao cho không có hai phần tử kề nhau nào được chọn là $\dfrac{2n}{2n-k} \mathrm{C}_{2n-k}^k$.\\
		Từ đó ta có 
		\begin{align*}
		s & =n! - \sum \limits_{k=1}^n (-1)^{k+1} (n-k)! \dfrac{2n}{2n-k} \mathrm{C}_{2n-k}^k\\
		& = \sum \limits_{k=0}^n (-1)^k (n-k)! \dfrac{2n}{2n-k} \mathrm{C}_{2n-k}^k.
		\end{align*}
		Vậy số cách xếp thỏa mãn đề bài là $\displaystyle M_n = 2n! s = 2n! \sum \limits_{k=0}^n (-1)^k (n-k)! \dfrac{2n}{2n-k} \mathrm{C}_{2n-k}^k$.
	}
\end{bt}

\begin{bt}%[Phạm Doãn Lê Bình, Dự án EX_TapChi04]%[1D0G6]
	Đức vua Arthur cho mời $n$ cặp hiệp sĩ là đối thủ của nhau đến ăn tối tại cung điện. Hỏi hoàng gia có bao nhiêu cách để xếp họ ngồi quanh một bàn tròn sao cho không có hai hiệp sĩ nào là đối thủ của nhau ngồi cạnh nhau?
	\loigiai{ 
		Trước tiên ta hiểu hai cách xếp chỗ ngồi được coi là khác nhau nếu có ít nhất một ghế được ngồi bởi hai người khác nhau trong hai cách xếp đó.\\
		Giả sử $M_n$ là tổng số cách xếp chỗ ngồi cho các hiệp sĩ thỏa mãn yêu cầu đề bài.\\
		Ta có $M_n = (2n)! - |A_1 \cup A_2 \cup \cdots \cup A_n|$.\\
		Với mỗi tập $\varnothing \ne \{i_1, i_2, \ldots, i_r\} \subset \{1,2,\ldots, n\}$ ta có $|A_{i_1} \cap A_{i_2} \cap \cdots \cap A_{i_r}|$ là tập tất cả các cách sắp xếp sao cho $r$ cặp hiệp sĩ ngồi cạnh nhau. Hai chỗ ngồi liền kề để xếp cho cặp hiệp sĩ thứ nhất có $2n$ cách chọn, ta coi $r-1$ cặp hiệp sĩ còn lại là $r-1$ phần tử, còn lại $2n-2r$ hiệp sĩ. Như vậy ta có $r-1+2n -2r = 2n - r -1$ phần tử. Ta có $(2n-2r-1)!$ cách xếp chỗ cho $2n-2r-1$ phần tử này. Hơn nữa, trong mỗi cách xếp $r$ cặp hiệp sĩ, ta có thể đổi chỗ hai hiệp sĩ cho nhau nên ta có
		\begin{align*}
		|A_{i_1} \cap A_{i_2} \cap \cdots \cap A_{i_r}| & = 2^r \cdot 2n (2n-2r-1)! \\
		& = 2^{r+1}n (2n-2r-1)!.
		\end{align*}
		Do đó $\displaystyle |A_1 \cup A_2 \cup \cdots \cup A_n| = \sum \limits_{r=1}^n (-1)^{r+1} \mathrm{C}_n^r 2^{r+1} n (2n-2r -1)!$\\
		Vậy 
		\begin{align*}
		M_n &= (2n)! - \sum \limits_{r=1}^n (-1)^{r+1} \mathrm{C}_n^r 2^{r+1} n (2n-2r -1)!\\
		& = \sum \limits_{r=0}^n (-1)^r \mathrm{C}_n^r 2^{r+1} n (2n-2r -1)!.
		\end{align*}
	{\bf Chú ý:} Nếu ta coi hai cách xếp chỗ ngồi mà cách xếp này thu được từ cách xếp kia bằng cách quay theo vòng tròn là như nhau thì số cách xếp là
	\[m_n = \dfrac{M_n}{2n}= \sum \limits_{r=0}^n (-1)^r \mathrm{C}_n^r 2^r (2n-r-1)!.\]
	}
\end{bt}


\subsection{Bài tập đề nghị}

\begin{bt}
 Trong tập $\{1, 2, \ldots, 2016\}$ có bao nhiêu số không chia hết cho $2$, $3$, $5$, $7$?
\end{bt}

\begin{bt}
 Tìm số nghiệm nguyên không âm của phương trình $x_1 + x_2 + x_3 + x_4 = 17$ với $3\le x_i \le 5$, $i=\overline{1,4}$.
\end{bt}

\begin{bt}
 Có bao nhiêu cách hoán vị các chữ cái M, A, T, H, I, S, F, U, N sao cho các từ MATH, IS và FUN không được xuất hiện (chẳng hạn hoán vị INUMATHSF không được tính)?
\end{bt}

\begin{bt}
 Một cửa hàng có $n$ loại hàng hóa khác nhau. Một người khách muốn mua $k$ sản phẩm, $(k\ge n)$ sao cho mỗi loại hàng hóa có ít nhất một sản phẩm. Hỏi người đó có bao nhiêu sự lựa chọn?
\end{bt}

\begin{bt}
 Có bao nhiêu cách xếp $n$ cặp vợ chồng ngồi vào một bàn dài gồm hai dãy ghế song song sao cho tất cả các ông ngồi về một phía và không ai ngồi đối diện với vợ của mình?
\end{bt}

\begin{bt}
 Giả sử $1\le r <n$, có bao nhiêu cách sắp xếp các phần tử của tập $A = \{a_1, a_2, \ldots, a_n\}$ sao cho với mỗi $i=1,2,\ldots, r$ phần tử $a_{i+1}$ không nằm ngay sau phần tử $a_i$?
\end{bt}

\section{Sử dụng số phức để giải toán tổ hợp}
\setcounter{bt}{0}
Trong các kì thi học sinh giỏi các bài toán tổ hợp thường phong phú, đa dạng và rất khó. Trong tổ hợp các bài toán  đếm trong tổ hợp xuất hiện nhiều và có nhiều cách tiếp cận khác nhau. Trong bài này tác giả trình bày một số bài toán đếm có thể sử dụng số phức để giải.
\subsection{Cở sở lí thuyết}
\begin{bode}
	Cho $ p $ là số nguyên tố  lẻ và $ a_0,a_1,\ldots,a_{p-1} $ là các số nguyên sao cho $$ a_0+a_1\varepsilon +\cdots+a_{p-1}\varepsilon^{p-1} =0,$$ trong đó $ 1+\varepsilon+\cdots+\varepsilon^{p-1}=0 $ thì $ a_0=a_1=\cdots=a_{p-1} $.
	\begin{cm}
		Ta thấy $ 1+x+x^2+\cdots+x^{p-1}$ và $ a_0+a_1x+\cdots+a_{p-1}x^{p-1} $ là hai đa thức hệ số nguyên nhận $ \varepsilon $	làm nghiệm. Vì $ p $ là số nguyên tố nên đa thức $ 1+x+x^2+\cdots+x^{p-1}$ bất khả quy trên $ \mathbb{Z}[x] $, nên nó không thể  phân tích thành tích các đa thức hệ số nguyên có bậc dương. Vì vậy  đa thức $ 1+x+x^2+\cdots+x^{p-1}$ là ước của đa thức $ a_0+a_1x+\cdots+a_{p-1}x^{p-1} $.\\
		Suy ra $ a_0=a_1=\cdots=a_{p-1} $.
	\end{cm}
\end{bode}
\begin{bode}
	Cho $ m $ là số nguyên dương. Nếu $ f(x)=\displaystyle\sum\limits_{k=0}^{n}a_kx^k$ là đa thức hệ số nguyên thì 
	$$\displaystyle\sum\limits_{k\ \vdots\  m}a_k=\dfrac{1}{m}\displaystyle\sum\limits_{i=1}^{m-1}f(\varepsilon^i),$$
trong đó $ 1+\varepsilon+\cdots+\varepsilon^{m-1}=0 $.
	\begin{cm}
		Ta có $$ \displaystyle\sum\limits_{i=1}^{m-1}f(\varepsilon^i)=\displaystyle\sum\limits_{i=1}^{m-1}\left(\displaystyle\sum\limits_{k=0}^{n}a_k\varepsilon^{ik} \right)=\displaystyle\sum\limits_{k=0}^{n}\left(a_k\displaystyle\sum\limits_{i=0}^{m-1}\varepsilon^{ik}\right) $$
		Nếu $ k $ chia hết cho $ m $ thì $ 1+\varepsilon^k+\cdots+\varepsilon^{k(m-1)}=m $.\\
		Nếu $ k $ không chia hết cho $ m $ thì $ 1+\varepsilon^k+\cdots+\varepsilon^{k(m-1)}=0 $.\\
		Suy ra $\displaystyle\sum\limits_{k\ \vdots \ m}a_k=\dfrac{1}{m}\displaystyle\sum\limits_{i=1}^{m-1}f(\varepsilon^i)$.
	\end{cm}
\end{bode}


\subsection{Bài tập mẫu}

\begin{bt}[PTNK, 2009]%[Nguyễn Trần Anh Tuấn, Dự án EX-TapChi04]%[1D0G6]
	Có bao nhiêu số tự nhiên gồm $ n $ chữ số mà số đó chia hết cho $ 3 $ đồng thời các chữ số nhận các giá trị thuộc tập hợp $ \{3,4,5,6\} $?
	\loigiai{
		\noindent{\bf Cách 1.}\\
		Gọi $ A_n $ là tập hợp tất cả các số có $ n $ chữ số lập được từ các chữ số thuộc tập $ \{3,4,5,6\}$ và những số này chia hết cho $ 3 $. Gọi $ B_n $ là tập hợp tất cả các số có $ n $ chữ số lập được từ các chữ số thuộc tập $ \{3,4,5,6\} $ và những số này không chia hết cho $ 3 $.\\
		Đặt $ a_n=|A_n| $, $ b_n=|B_n| $. Dễ dàng thiết lập được hệ thức truy hồi
		$$ \heva{& a_{n+1}=2a_n+b_n\\& b_{n+1}=2a_n+3b_n.}$$
		Suy ra $ a_{n+2}-5a_n+4a_{n-1}=0 $, $ a_1=1$, $ a_2=6 $.\\
		Từ đó $ a_n=\dfrac{4^n+2}{3} $.\\
		\noindent{\bf Cách 2.}\\
		Đặt $ S=\{3,4,5,6\} $. Ta có $ \overline{a_1a_2\ldots a_n}\ \vdots \ 3 $ khi và chỉ khi $ a_1+a_2+\cdots+a_n \ \vdots \ 3 $.\\
		Như vậy bài toán trở thành đếm số các bộ $ (a_1;a_2;\ldots;a_n) \in S^n $ sao cho $ a_1+a_2+\cdots+a_n \ \vdots \ 3 $.\\
		Xét đa thức $ P(x)=(x^3+x^4+x^5+x^6)^n $. Ta có $ P(x)=\displaystyle\sum\limits_{(a_1;a_2;\ldots;a_n) \in S^n} x^{a_1+a_2+a_3+\cdots+a_n} $.
		\begin{nx}
			Số tất cả các bộ $ (a_1;a_2;\ldots;a_n) \in S^n $ sao cho $ a_1+a_2+\cdots+a_n \ \vdots \ 3 $ bằng tổng các hệ số của số mũ trong khai triển $ P(x) $ chia hết cho $ 3 $.\\
			$ P(x)=a_0+a_1x+\cdots+a_{6n}x^{6n} $. Ta cần tính $ T=\displaystyle\sum\limits_{k\ \vdots \ 3}a_k $.\\
			Theo bổ đề $ 2 $ ta có $T=\dfrac{1}{3}\left(P(1)+P(\varepsilon)+P(\varepsilon^2)\right)$.\\
			Lại có $ P(1)=4^n $, $ P(\varepsilon)=(1+\varepsilon+\varepsilon ^2+1)^n=1 $, $ P(\varepsilon ^2)=(1+\varepsilon+\varepsilon ^2+1)^n=1 $.\\
			Vậy $ T=\dfrac{4^n+2}{3} $.
		\end{nx}
	}
\end{bt}

\begin{bt}[VMO 2015]%[Nguyễn Trần Anh Tuấn, Dự án EX\_TapChi04]%[1D0G6]
	Cho số nguyên dương $ k $. Tìm số các số tự nhiện $ n $ không vượt quá $ 10^k $ thỏa mãn đồng thời các điều kiện sau:
	\begin{enumerate}[i)]
		\item $ n $ chia hết cho $ 3 $;
		\item Các chữ số trong biểu diễn thập phân của $ n $ thuộc tập hợp $ \{0,1,2,5\} $.
	\end{enumerate}
	\loigiai{
		Đặt $ S=\{0,1,2,5\}$.  Bổ sung số $ 0 $ vào trước nếu cần thiết, ta đếm số có dạng $ \overline{a_1a_2\ldots a_k}\ \vdots \ 3 $.\\
		Như vậy bài toán trở thành đếm số các bộ $ (a_1;a_2;\ldots;a_k) \in S^k $ sao cho $ a_1+a_2+\cdots +a_k \ \vdots \ 3 $.\\
		\noindent{\bf Cách 1.}\\
		Gọi $ A_n $ là tập hợp các bộ $ (a_1;a_2;\ldots;a_n) \in S^n $ và $ a_1+a_2+\cdots+a_n \equiv 0 \pmod{3}$.\\
		Gọi $ B_n $ là tập hợp tất cả các bộ $ (a_1;a_2;\ldots;a_n) \in S^n $ và $ a_1+a_2+\cdots+a_n \equiv 1 \pmod{3}$.\\
		Gọi $ C_n $ là tập hợp tất cả các bộ $ (a_1;a_2;\ldots;a_n) \in S^n $ và $ a_1+a_2+\cdots+a_n \equiv 2 \pmod{3}$.\\
		Đặt $ a_n=|A_n| $, $ b_n=|B_n| $, $ c_n=|C_n| $. Dễ dàng thiết lập được hệ thức truy hồi
		$$ \heva{& a_{n+1}=a_n+2b_n+c_n\\& b_{n+1}=a_n+b_n+2c_n\\&c_{n+1}=2a_n+b_n+c_n.}$$
		Suy ra $ a_{n+2}-5a_n+4a_{n-1}=0 $, $ a_1=1$, $ a_2=6 $.\\
		Từ đây ta tính được $ a_2=5 $, $ b_2=6 $, $ c_2=5 $, $ a_3=22 $, $ b_3=21 $, $ c_3=21 $.\\
		Cộng các hệ thức trên ta được $ a_{n+1}+b_{n+1}+c_{n+1}=4(a_n+b_n+c_n) $.\\
		Từ đó suy ra $ a_n+b_n+c_n=4^n$.\\
		Từ hệ ta cũng suy ra $$ a_{n+1}-b_{n+1}=b_n-c_n ,  b_{n+1}-c_{n+1}=c_n-a_n ,  c_{n+1}-a_{n+1}=a_n-b_n .$$
		Do đó $ a_{n+3}-b_{n+3}=b_{n+2}-c_{n+2}=c_{n+1}-a_{n+1}=a_n-b_n $.\\
		Tương tự $ b_{n+3}-c_{n+3}=b_n-c_n$, $ c_{n+3}-a_{n+3}=c_n-a_n $.\\
		Suy ra
		\begin{itemize}
			\item Nếu $ k $ chia hết cho $ 3 $ thì $ b_k=c_k=a_k-1 $;
			\item Nếu $ k $ chia cho $ 3 $ dư $ 1 $ thì $ a_k=b_k=c_k-1 $;
			\item Nếu $ k $ chia cho $ 3 $ dư $ 2 $ thì $ a_k=c_k=b_k-1 $.
		\end{itemize}
		Do đó
		\begin{itemize}
			\item $ a_k=\dfrac{4^k-1}{3} $ nếu $ k $ không chia hết cho $ 3 $;
			\item $ a_k=\dfrac{4^k+2}{3} $ nếu $ k $ chia hết cho $ 3 $.
		\end{itemize}
		\noindent{\bf Cách 2.}\\
		Đặt $ S=\{0,1,2,5\} $. Bổ sung số $ 0 $ vào trước nếu cần thiết, ta đếm số có dạng $ \overline{a_1a_2\ldots a_k}\ \vdots \ 3 $.\\
		Như vậy bài toán trở thành đếm số các bộ $ (a_1;a_2;\ldots;a_k) \in S^k $ sao cho $ a_1+a_2+\cdots+a_k\ \vdots \ 3$.\\
		Xét đa thức $ P(x)=(1+x+x^2+x^5)^k $. Ta có $ P(x)=\displaystyle\sum\limits_{(a_1;a_2;\ldots;a_k) \in S^k} x^{a_1+a_2+a_3+\cdots+a_k} $.
		\begin{nx}
			Số tất cả các bộ $ (a_1;a_2;\ldots;a_k) \in S^k $ sao cho $ \overline{a_1a_2\ldots a_k}\ \vdots \ 3 $ bằng tổng các hệ số của số mũ trong khai triển $ P(x) $ chia hết cho $ 3 $. Đặt $ P(x)=a_0+a_1x+\cdots+a_{5k}x^{5k} $. Ta cần tính $ T=\displaystyle\sum\limits_{k\ \vdots \ 3}a_k $.
		\end{nx}
		Theo bổ đề $ 2 $ ta có $ T=\dfrac{1}{3}\left(P(1)+P(\varepsilon)+P(\varepsilon^2)\right) $.\\
		Ta có $ P(1)=4^n $, $ P(\varepsilon)=(1+\varepsilon+\varepsilon^2+\varepsilon^5)^k=\varepsilon ^{2k} $, $ P(\varepsilon ^2)=(1+\varepsilon+\varepsilon ^4+\varepsilon^10)^k=\varepsilon^k $.\\
		Như vậy 
		\begin{itemize}
			\item Nếu $ k $ chia hết cho $ 3 $ thì $ T=\dfrac{4^k+2}{3} $;
			\item Nếu $ k $ không chia hết cho $ 3 $ thì $ T=\dfrac{4^n+\varepsilon^k+\varepsilon^{2k}}{3}=\dfrac{4^k-1}{2} $.
		\end{itemize}
	}
\end{bt}

\begin{bt}%[Nguyễn Trần Anh Tuấn, Dự án EX\_TapChi04]%[1D0G6]
	Cho hai số nguyên dương $ m $, $ n $ và $ p $ là số nguyên tố trong đó $ n + 1 $ chia hết cho $ p $. Có bao nhiêu số gồm $ m $ chữ số sao cho tổng các chữ số chia hết cho $ p $, các chữ số nhận giá trị thuộc tập $ \{1,2,\ldots,n\} $.
	\loigiai{
		Đặt $ S=\{1,2,3,\ldots,n\} $. Xét đa thức $ P(x)=(x+x^2+\cdots+x^n)^m $.\\
		Ta có $ P(x)=\displaystyle\sum\limits_{(a_1;a_2;\ldots;a_m) \in S^m} x^{a_1+a_2+a_3+\cdots+a_m}=a_0+a_1x+\cdots+a_{mn}x^{mn} $.\\
		Số tất cả các bộ $ (a_1;a_2;\ldots;a_m) \in S^m $ sao cho $ a_1+a_2+\cdots+a_m \ \vdots \ p$ bằng tổng các hệ số của số mũ trong khai triển $ P(x) $ chia hết cho $ p $.\\
		Đặt $ P(x)=a_0+a_1x+\cdots+a_{mn}x^{mn} $. Ta cần tính $ T=\displaystyle\sum\limits_{k\ \vdots \ p} a_k $.\\
		Theo bổ đề $ 2 $ ta có $ T=\dfrac{1}{p}\left(P(1)+P(\varepsilon)+\cdots+P(\varepsilon ^{p-1}) \right)$ trong đó $ 1+ \varepsilon +\cdots+\varepsilon ^{p-1}=0$.\\
		Ta có $ P(1)=n^m $.\\
		Với $ i \ne 0 $ thì $ P(\varepsilon ^i)=\left(\varepsilon ^i+ \varepsilon ^{2i} +\cdots+\varepsilon ^{ni} \right)^m=\left( \dfrac{1-\varepsilon ^{i(n+1)}}{1-\varepsilon ^i}-1\right)^m=(-1)^m$, (vì $ (n+1)\ \vdots \ p $).\\
		Như vậy $ T=\dfrac{n^m+(p-1)(-1)^m}{p} $.
	}	
\end{bt}

\begin{bt}%[Bùi Mạnh Tiến, Dự án EX\_TapChi04]%[2D0G2]
	Cho $p$ là số nguyên tố lẻ và $n$ là số nguyên dương thỏa mãn $n+2$ chia hết cho $p$. Có bao nhiêu bộ $(x;y;z)$ sao cho $x+y+z$ chia hết cho $p$ trong đó $x$, $y$, $z$ đều không lớn hơn $n$?
	\loigiai{
		\noindent{\bf Cách 1.}\\
		Đặt $k=\dfrac{n+2}{p}\in \mathbb{N^*}$, suy ra $n=kp-2$. Đặt $D=\left\{kp-1,kp\right\}$, $E=\left\{1,2,\ldots,kp\right\}$.\\
		Xét $3$ tập
		\begin{eqnarray*}
			& &A=\left\{(x;y;z)|x,y,z\in E\setminus D, x+y+z\ \vdots \ p \right\}\\
			& &B=\left\{(x;y;z)|x,y,z\in E,x+y+z\ \vdots\ p \right\}\\
			& &C=\left\{(x;y;z)|x\in D \vee y \in D \vee z\in D, x+y+z\ \vdots\ p\right\}.
		\end{eqnarray*}
		Dễ thấy $|A|=|B|-|C|$.
		\begin{itemize}
			\item Tính $|B|$: Có $kp$ cách chọn phần tử $x$, $kp$ cách chọn phần tử $y$ thuộc $E$. Khi đó có $k$ cách chọn $z$ thuộc $E$ sao cho $(x+y+z)\ \vdots\ p$. Do đó $|B|=k^3p^2$.
			\item Tính $|C|$. Đặt 
			\begin{eqnarray*}
				& &X=\left\{(x,y,z)|x\in D, y\in E, z\in E, \left(x+y+z\right)\ \vdots\ p \right\},\\
				& &Y=\left\{(x,y,z)|y\in D, x\in E, z\in E, \left(x+y+z\right)\ \vdots\ p \right\},\\
				& &Z=\left\{(x,y,z)|z\in D, x\in E, y\in E, \left(x+y+z\right)\ \vdots\ p \right\}.
			\end{eqnarray*}
			Khi đó $C=X\cup Y\cup Z$. Ta có
			\begin{eqnarray*}
			 |X|=|Y|=|Z|=2k^2p; |X\cap Y|=|Y\cap Z|=|Z\cap X|=4k \text{ và } |X\cap Y\cap Z|=\heva{&1,p>3\\&2,p=3.}
			\end{eqnarray*}
			Do đó
			\begin{eqnarray*}
			 |C|=|X\cup Y\cup Z|=6k^2p-12k+|X\cap Y\cap Z|.
			\end{eqnarray*}
		\end{itemize}
		Thay $k=\dfrac{n+2}{p}$, ta được 
		\begin{eqnarray*}
			|A|=\heva{&\dfrac{n^3+2}{3},p=3\\&\dfrac{n^3+8-p}{p}p,p>3.}
		\end{eqnarray*}
		\noindent{\bf Cách 2.}\\
		Đặt $S=\left\{1,2,3,\ldots,n \right\}$. Xét đa thức $P(x)=(x+x^2+\cdots+x^n)^3$.\\
		Ta có 
		\begin{eqnarray*}
			P(x)=\displaystyle\sum\limits_{(a_1;a_2;a_3)\in S^3} x^{a_1+a_2+a_3}=a_0+a_1x+\cdots+a_{3n}x^{3n}.
		\end{eqnarray*}
		Số tất cả các bộ $(x,y,z)\in S^3$ sao cho $\left(x+y+z\right)\ \vdots\ p$ bằng tổng các hệ số của số mũ trong khai triển $P(x)$ chia hết cho $p$. Đặt $P(x)=a_0+a_1x+\cdots+a_{3n}x^{3n}$. Ta cần tính $T=\displaystyle\sum\limits_{k\ \vdots\ p}a_k$.\\
		Theo bổ đề $2$ ta có
		\begin{eqnarray*}
			T=\dfrac{1}{p}\left(P(1)+P(\varepsilon)+\cdots+P(\varepsilon ^{p-1})\right),
		\end{eqnarray*}
		trong đó $1+\varepsilon+\cdots+\varepsilon ^{p-1}=0$.\\
		Ta có $P(1)=n^3$, với $i\ne 0$ thì
		\begin{eqnarray*}
			P(\varepsilon ^i)&=&\left(\varepsilon ^i+\varepsilon ^{2i}+\cdots +\varepsilon ^{ni}\right)^3=\left(\dfrac{\varepsilon ^i-\varepsilon ^{n+2}}{\varepsilon ^i-\varepsilon ^{2i}}-1\right)^3=-\left(\dfrac{1}{\varepsilon ^i}+1\right)^3, \left(\text{vì } \left(n+2\right)\ \vdots\ p \right)\\
			&=& -\left(1+3\varepsilon ^{-i}+3\varepsilon ^{-2i}+\varepsilon ^{-3i}\right).
		\end{eqnarray*}
		Do đó $P(\varepsilon)+\cdots +P(\varepsilon ^{p-1})=\left(p-1+3\delta (1)+3\delta (2)+\delta (3)\right)$\\
		trong đó
		\begin{eqnarray*}
			\delta (i)=\displaystyle\sum\limits_{k=1}^{p-1}\varepsilon ^{-ki}=\heva{&p-1;i\ \vdots\ p\\&-1;i\not \vdots\ p}, i=1, 2, 3.
		\end{eqnarray*}
		Như vậy 
		\begin{itemize}
			\item Nếu $p=3$ thì $\delta (1)=\delta (2)=-1$, $\delta (3)=2$ nên $T=\dfrac{1}{3}\left(n^3+2\right).$\\
			\item $p>3$ thì $\delta (1)=\delta (2)=\delta (3)=-1$ nên $T=\dfrac{1}{p}\left(n^3+8-p\right).$
		\end{itemize}
	}
\end{bt}

\begin{bt}%[Bùi Mạnh Tiến, Dự án EX\_TapChi04]%[2D0G2]
	Kí hiệu $M$ là tập hợp gồm $2011$ số nguyên dương đầu tiên. Tô tất cả các số thuộc $M$ bởi ba màu xanh, đỏ, vàng sao cho mỗi số được tô bởi một màu và mỗi màu dùng để tô ít nhất một số. Xét các tập sau
	\begin{eqnarray*}
	& &S_1=\left\{(x,y,z)\in M^3, \text{ trong đó } x, y, z\text{ cùng màu và } x+y+z \text{ chia hết cho } 2011 \right\}\\
	& &S_2=\left\{(x,y,z)\in M^3, \text{ trong đó } x, y, z\text{ đôi một khác màu và } x+y+z \text{ chia hết cho } 2011 \right\}.
	\end{eqnarray*}
	Chứng minh rằng $2|S_1|>|S_2|.$
	\loigiai{
		Gọi $A$, $B$, $C$ lần lượt là tập hợp các số được tô màu xanh, đỏ, vàng.\\
		Gọi $\varepsilon $ là số phức thỏa mãn $1+\varepsilon+\cdots+\varepsilon ^{p-1}=0$.\\
		Đặt $P(x)=\displaystyle\sum\limits_{a\in A} x^a$, $Q(x)=\displaystyle\sum\limits_{b\in B} x^b$, $R(x)=\displaystyle\sum\limits_{c\in C} x^c$.\\
		Xét đa thức 
		\begin{eqnarray*}
			F(x)=P^3(x)+Q^3(x)+R^3(x)=\displaystyle\sum\limits_{(a_1;a_2;a_3)\in A^3} x^{a_1+a_2+a_3}+\displaystyle\sum\limits_{(b_1;b_2;b_3)\in B^3} x^{b_1+b_2+b_3}+\displaystyle\sum\limits_{(c_1;c_2;c_3)\in C^3} x^{c_1+c_2+c_3}.
		\end{eqnarray*}
		Số bộ $(x;y;z)$ tô cùng màu và $x+y+z$ chia hết cho $2011$ bằng tổng các hệ số của $F(x)$ mà ứng với số mũ chia hết cho $2011$. Do đó
		\begin{eqnarray*}
			|S_1|=\dfrac{1}{2011}\displaystyle\sum\limits_{i=1}^{2010} F(\varepsilon ^i) =\dfrac{1}{2011}\displaystyle\sum\limits_{i=1}^{2010} \left(P^3(\varepsilon ^i)+Q^3(\varepsilon ^i)+R^3(\varepsilon ^i)\right).
		\end{eqnarray*}
		Xét đa thức $G(x)=P(x)\cdot Q(x)\cdot R(x)=\displaystyle\sum\limits_{(a_1;a_2;a_3)\in A\times B\times C} x^{a_1+a_2+a_3}$.\\
		Số bộ $(x;y;z)$ mà $x$, $y$, $z$ lần lượt được tô màu xanh, đỏ, vàng và $x+y+z$ chia hết cho $2011$ bằng tổng các hệ số của $G(x)$ mà ứng với số mũ chia hết cho $2011$. Do đó
		\begin{eqnarray*}
			|S_2|=\dfrac{6}{2011}\displaystyle\sum\limits_{i=1}^{2010}G(\varepsilon ^i)=\dfrac{2}{2011}\displaystyle\sum\limits_{i=1}^{2010}\left(3P\left(\varepsilon ^i\right)\cdot Q\left(\varepsilon ^i\right) \cdot R\left(\varepsilon ^i\right) \right).
		\end{eqnarray*}
		Nhận xét: Với mọi $i\ne 0$ thì $P(\varepsilon ^i)+Q(\varepsilon ^i)+R(\varepsilon ^i)=0$ nên
		\begin{eqnarray*}
			P^3(\varepsilon ^i)+Q^3(\varepsilon ^i)+R^3(\varepsilon ^i)=3P(\varepsilon ^i)\cdot Q(\varepsilon ^i)\cdot R(\varepsilon ^i).
		\end{eqnarray*}
		Mặt khác, áp dụng bất đẳng thức AM-GM ta có 
		\begin{eqnarray*}
			P^3(1)+Q^3(1)+R^3(1)\ge 3P(1)\cdot Q(1)\cdot R(1).
		\end{eqnarray*}
		Dấu bằng xảy ra khi $P(1)=Q(1)=R(1)\Rightarrow 3P(1)=2011$ (vô lý).\\
		Vậy không xảy ra dấu bằng hay $2|S_1|>|S_2|.$
	}
\end{bt}

\begin{bt}%[Bùi Mạnh Tiến, Dự án EX\_TapChi04]%[2D0G2]
	Kí hiệu $M$ là tập hợp gồm $N$ số nguyên dương đầu tiên. Tô tất cả các số thuộc $M$ bởi ba màu xanh, đỏ, vàng sao cho mỗi số được tô bởi một màu và mỗi màu dùng để tô ít nhất một số, hơn nữa có nhiều nhất $\dfrac{N}{2}$ số được tô cùng một màu. Xét các tập sau\\
	$S_1=\left\{(x,y,z,t)\in M^4, \text{ trong đó }x,\text{ }y,\text{ }z,\text{ }t \text{ cùng màu và } x+y+z+t \text{ chia hết cho } N\right\},$\\
	$S_2=\left\{(x,y,z,t)\in M^4\right.$, trong đó $x$, $y$ cùng màu và $z$, $t$ cùng màu và hai màu đó khác nhau thỏa mãn $x+y+z+t$ chia hết cho $\left. N\right\}.$\\ 
	Chứng minh rằng $|S_1|\le |S_2|.$
	\loigiai{
		Gọi $A$, $B$, $C$ lần lượt là tập hợp các số được tô màu xanh, đỏ, vàng.\\
		Gọi $\varepsilon$ thỏa mãn $1+\varepsilon+\cdots +\varepsilon^{N-1}=0$.\\
		Đặt $P(x)=\displaystyle\sum\limits_{a\in A}x^a$, $Q(x)=\displaystyle\sum\limits_{b\in B}x^b$, $R(x)=\displaystyle\sum\limits_{c\in C}x^c$.\\
		Xét đa thức
		\begin{eqnarray*}
			F(x)&=&P^4(x)+Q^4(x)+R^4(x)\\
			&=&\displaystyle\sum\limits_{(a_1;a_2;a_3;a_4)\in A^4} x^{a_1+a_2+a_3+a_4}+\displaystyle\sum\limits_{(b_1;b_2;b_3;b_4)\in B^4} x^{b_1+b_2+b_3+b_4}+\displaystyle\sum\limits_{(c_1;c_2;c_3;c_4)\in C^4} x^{c_1+c_2+c_3+c_4}.
		\end{eqnarray*}
		Số bộ $(x;y;z;t)$ tô màu cùng màu và $x+y+z+t$ chia hết cho $N$ bằng tổng các hệ số của $F(x)$ mà ứng với số mũ chia hết cho $N$. Do đó
		\begin{eqnarray*}
			|S_1|=\dfrac{1}{N}\displaystyle\sum\limits_{i=1}^{N-1} F(\varepsilon ^i)=\dfrac{1}{N}\displaystyle\sum\limits_{i=1}^{N-1} \left[P^4(\varepsilon ^i)+Q^4(\varepsilon ^i)+R^4(\varepsilon ^i)\right].
		\end{eqnarray*}
		Xét đa thức 
		\begin{eqnarray*}
			G(x)=P^2(x)\cdot Q^2(x)+P^2(x)\cdot R^2(x)+Q^2(x)\cdot R^2(x).
		\end{eqnarray*}
		Số bộ $(x;y;z;t)$ mà $x$, $y$ cùng màu, $z$, $t$ cùng màu nhưng hai màu khác nhau và $x+y+z+t$ chia hết cho $N$ bằng tổng các hệ số của $G(x)$ mà ứng với số mũ chia hết cho $N$. Do đó
		\begin{eqnarray*}
			|S_2|=\dfrac{2}{N}\displaystyle\sum\limits_{i=1}^{N-1} G(\varepsilon ^i)=\dfrac{1}{N}\displaystyle\sum\limits_{i=1}^{N-1} \left[2P^2(\varepsilon ^i)\cdot Q^2(\varepsilon ^i)+2P^2(\varepsilon ^i)\cdot R^2(\varepsilon ^i)+2Q^2(\varepsilon ^i)\cdot R^2(\varepsilon ^i)\right].
		\end{eqnarray*}
		Nhận xét: với mọi $i\ne 0$ thì $P(\varepsilon ^i)+Q(\varepsilon ^i)+R(\varepsilon ^i)=0$ nên 
		\begin{center}
			$2P^2(\varepsilon ^i)\cdot Q^2(\varepsilon ^i)+2P^2(\varepsilon ^i)\cdot R^2(\varepsilon ^i)+2Q^2(\varepsilon ^i)\cdot R^2(\varepsilon ^i)-\left[P^4(\varepsilon ^i)+Q^4(\varepsilon ^i)+R^4(\varepsilon ^i)\right]=0$\\
			(vì $2(a^2b^2+b^2c^2+c^2a^2)-(a^4+b^4+c^4)=(a+b+c)(b+c-a)(c+a-b)(a+b-c)$).
		\end{center}
		Cũng từ đẳng thức trên, do số các số tô cùng màu không quá $\dfrac{N}{2}$ nên 
		\begin{center}
			$2(a^2b^2+b^2c^2+c^2a^2)-(a^4+b^4+c^4)\ge 0.$
		\end{center}
		Như vậy ta có điều phải chứng minh.
	}
\end{bt}

\begin{bt}%[Bùi Mạnh Tiến, Dự án EX\_TapChi04]%[2D0G2]
	Cho $p$ là số nguyên tố và $m$ là số nguyên dương. Đặt 
	\begin{center}
		$E=\left\{(k_1;k_2;\ldots;k_{p-1}),0\le k_i\le m-1:\displaystyle\sum\limits_{i=1}^{p-1}ik_i \equiv 0 \pmod{p} \right\}.$
	\end{center}
	Tính số phần tử của tập $E$.
	\loigiai{
		Đặt $S=\left\{1,\ldots,m-1\right\}$. Xét đa thức
		\begin{eqnarray*}
			P(x)=\displaystyle\prod\limits_{i=1}^{p-1}\left(\displaystyle\sum\limits_{k=0}^{m-1} x^{ki}\right)=\displaystyle\sum\limits_{(a_1;a_2;\ldots;a_{p-1})\in S^{p-1}} x^{\sum\limits_{i=1}^{p-1}ia_i}.
		\end{eqnarray*}
		Số phần tử của tập $E$ bằng tổng hệ số của đa thức $P(x)$ ứng với số mũ chia hết cho $p$. Theo bổ đề $2$ ta có
		\begin{eqnarray*}
			|E|=\dfrac{1}{p}\left[P(1)+P(\varepsilon)+\cdots+P(\varepsilon ^{p-1})\right].
		\end{eqnarray*}
		Ta có $P(1)=m^{p-1}$. Với mọi $i\ne 1$ thì
		\begin{eqnarray*}
			P(\varepsilon ^i)=\displaystyle\prod\limits_{i=1}^{p-1}\left(\displaystyle\sum\limits_{k=0}^{m-1} \varepsilon ^{ki}\right)=\displaystyle\prod\limits_{i=1}^{p-1} \left(\dfrac{1-\varepsilon ^{mi}}{1-\varepsilon ^i}\right).
		\end{eqnarray*}
		Nếu $m$ chia hết cho $p$ thì $P(\varepsilon ^i)=0$ nên $|E|=\dfrac{m^{p-1}}{p}$.\\
		Nếu $(m,p)=1$ thì $P(\varepsilon ^i)=\displaystyle\prod\limits_{i=1}^{p-1} \left(\dfrac{1-\varepsilon ^{mi}}{1-\varepsilon ^i}\right)=1$ nên $|E|=\dfrac{m^{p-1}+p-1}{p}.$
	}
\end{bt}

\begin{bt}%[Bùi Mạnh Tiến, Dự án EX\_TapChi04]%[2D0G2]
	Cho $p$ là số nguyên tố lẻ. Có bao nhiêu tập con $X$ của tập $A=\left\{1,2,\ldots,2p\right\}$ thỏa mãn đồng thời các điều kiện sau:
	\begin{enumerate}[i)]
	 \item $X$ đúng $p$ phần tử.
	 \item Tổng số các phần tử của tập $X$ chia hết cho $p$.
	\end{enumerate}
	\loigiai{
		Gọi $\varepsilon$ thỏa mãn $1+\varepsilon+\cdots+\varepsilon ^{p-1}=0$ và $x_i$ là số tập con $X$ của tập $A$ sao cho $|X|=p$ và $\break m(X)\equiv i \pmod{p}$, với $m(X)$ là tổng các số của tập $X$.\\
		Khi đó
		\begin{eqnarray*}
			\displaystyle\sum\limits_{i=0}^{p-1}x_i\varepsilon ^i=\displaystyle\sum\limits_{B\subset A,|B|=p}\varepsilon ^{m(B)}=\displaystyle\sum\limits_{1\le c_1\le c_2\le \cdots \le c_p\le 2p}\varepsilon ^{c_1+c_2+\cdots+c_p}.
		\end{eqnarray*}
		Nhận xét: $\displaystyle\sum\limits_{1\le c_1\le c_2\le \cdots \le c_p\le 2p} \varepsilon ^{c_1+c_2+\ldots+c_p}$ là hệ số của $x^p$ trong khai triển đa thức
		\begin{eqnarray*}
			(x+\varepsilon)(x+\varepsilon ^2)\cdots (x+\varepsilon ^{2p}).
		\end{eqnarray*}
		Ta có
		\begin{eqnarray*}
			x^p-1=(x-\varepsilon)(x-\varepsilon ^2)\cdots (x-\varepsilon ^{p}),
		\end{eqnarray*}
		suy ra 
		\begin{eqnarray*}
			x^p+1=(x+\varepsilon)(x+\varepsilon ^2)\cdots (x+\varepsilon ^{p}).
		\end{eqnarray*}
		Do đó
		\begin{eqnarray*}
			(x^p+1)^2=(x+\varepsilon)(x+\varepsilon ^2)\cdots (x+\varepsilon ^{p})(x+\varepsilon ^{p+1})\ldots (x+\varepsilon ^{2p})
		\end{eqnarray*}
		nên hệ số $x^p$ trong khai triển $(x+\varepsilon)(x+\varepsilon ^{2})\cdots (x+\varepsilon ^{2p})$ bằng $2$.\\
		Như vậy
		\begin{eqnarray*}
			\displaystyle\sum\limits_{i=0}^{p-1}x_i\varepsilon ^i=2\Rightarrow x_0-2=x_1=\cdots=x_{p-1}.
		\end{eqnarray*}
		hay 
		\begin{eqnarray*}
			& & x_0-2=\dfrac{x_0-2+x_1+\cdots+x_{p-1}}{p}=\dfrac{\mathrm{C}_{2p}^2-2}{p}\\
			&\Rightarrow &x_0=\dfrac{\mathrm{C}_{2p}^2-2}{p}+2.
		\end{eqnarray*}
	}
\end{bt}

\begin{bt}%[Bùi Mạnh Tiến, Dự án EX\_TapChi04]%[2D0G2]
	Cho $p$ là số nguyên tố lẻ. Có bao nhiêu tập con $X$ của tập $A=\left\{1,2,\ldots,n\right\}$, $n\ge p$ thỏa mãn đồng thời các điều kiện sau:
	\begin{enumerate}[i)]
		\item $X$ đúng $p$ phần tử.
		\item Tổng số các phần tử của tập $X$ chia hết cho $p$.
	\end{enumerate}
	\loigiai{
		Gọi $\varepsilon$ thỏa mãn $1+\varepsilon+\cdots+\varepsilon^{p-1}=0$ và $x_i$ là số tập con $X$ của $A$ sao cho $|X|=p$ và $\break m(X)\equiv i \pmod{p}$, với $m(X)$ là tổng các số của tập $X$.\\
		Khi đó
		\begin{eqnarray*}
			\displaystyle\sum\limits_{i=0}^{p-1}x_i\varepsilon ^i=\displaystyle\sum\limits_{B\subset A,|B|=p}\varepsilon ^{m(B)}=\displaystyle\sum\limits_{1\le c_1\le c_2\le \cdots \le c_p\le 2p}\varepsilon ^{c_1+c_2+\cdots+c_p}.
		\end{eqnarray*}
		Nhận xét: $\displaystyle\sum\limits_{c_1\le c_2 \le \cdots \le c_p} \varepsilon ^{c_1+c_2+\cdots+c_p}$ là hệ số của $x^{n-p}$ trong khai triển đa thức
		\begin{eqnarray*}
			(x+\varepsilon)(x+\varepsilon ^2)\cdots (x+\varepsilon ^{2p}).
		\end{eqnarray*}
		Ta có
		\begin{eqnarray*}
			x^p-1=(x-\varepsilon)(x-\varepsilon ^2)\cdots (x-\varepsilon ^{p}),
		\end{eqnarray*}
		suy ra 
		\begin{eqnarray*}
			x^p+1=(x+\varepsilon)(x+\varepsilon ^2)\cdots (x+\varepsilon ^{p}).
		\end{eqnarray*}
		Giả sử $n=kp+r$, $0\le r\le p-1$. Ta có
		\begin{eqnarray*}
		 (x^p+1)^n=\left[(x+\varepsilon)(x+\varepsilon ^2)\cdots(x+\varepsilon^p)\right](x+\varepsilon^1)\cdots (x+\varepsilon ^r)=(x^p+1)^k (x+\varepsilon^1)\ldots (x+\varepsilon ^r).
		\end{eqnarray*}
		Suy ra hệ số của $x^{n-p}$ trong khai triển đa thức $(x+\varepsilon)(x+\varepsilon ^2)\cdots (x+\varepsilon ^n)$ bằng $\mathrm{C}_k^1=k$.\\
		Như vậy
		\begin{eqnarray*}
			\displaystyle\sum\limits_{i=0}^{p-1}x_i\varepsilon ^i=2\Rightarrow x_0-k=x_1=\cdots=x_{p-1}.
		\end{eqnarray*}
		hay 
		\begin{eqnarray*}
			& & x_0-k=\dfrac{x_0-k+x_1+\cdots+x_{p-1}}{p}=\dfrac{\mathrm{C}_{n}^2-k}{p}\\
			&\Rightarrow &x_0=\dfrac{\mathrm{C}_{2p}^2-k}{p}+k.
		\end{eqnarray*}
	}
\end{bt}

\subsection{Bài tập tự luyện}
\begin{bt}
	Có bao nhiêu số tự nhiên có $ 9 $ chữ số, trong đó không chữa chữ số $ 0 $ và chia hết cho $ 11 $?
\end{bt}

\begin{bt}[VMO 2008]
	Có bao nhiêu số tự nhiên có $ 2008 $ chữ số, chia hết cho $ 9 $ và trong biểu diễn của nó có không quá $ 2 $ chữ số $ 9 $? 
\end{bt}

\begin{bt}
	Có bao nhiêu số tự nhiên chia hết cho $7$, có $n$ chữ số và mỗi chữ số được lấy từ $\left\{1,3,4,6,7,9\right\}$?
\end{bt}

\begin{bt}
	Có bao nhiêu số tự nhiên bé hơn $5000$ có tổng các chữ số chia hết cho $4$?
\end{bt}

\begin{bt}
	Cho $p$ là số nguyên tố. Có bao nhiêu bộ $(a;b;c;d;e;f)$ là các số nguyên dương nằm giữa $0$ và $p-1$ thỏa mãn 
	\begin{align*}
		a^2+b^2+c^2=d^2+e^2+f^2 \pmod{p}?
	\end{align*}
\end{bt}



\section{Sử dụng ánh xạ để chứng minh đẳng thức, bất đẳng thức tổ hợp}
\setcounter{bt}{0}
\subsection{Cơ sở lí thuyết}

\begin{dn}
	Cho hai tập hợp $X$ và $Y$. Một ánh xạ $f$ từ tập $X$ đến tập $Y$ là một quy tắc đặt tương ứng mỗi phần tử $x$ của $X$ với một (và chỉ một) phần tử $y$ của $Y$. Phần tử này được gọi là ảnh của $x$ qua ánh xạ $f$ và được ký hiệu là $y=f(x)$.\\
	Tập hợp $X$ được gọi là tập xác định của $f$. Tập hợp $Y$ được gọi là tập giá trị của $f$.
\end{dn}

\begin{dn}\textrm{}
	\begin{enumerate}[i)]
		\item Ánh xạ $f\colon X \longrightarrow Y$ được gọi là đơn ánh nếu với $a,b \in X$ mà $a\ne b$ thì $f(a)\ne f(b)$. Nói một cách khác, ánh xạ $f$ là một đơn ánh nếu và chỉ nếu với $a,b \in X$ mà $f(a)=f(b)$ thì suy ra $a=b$.
		\item Ánh xạ $f\colon X \longrightarrow Y$ được gọi là toàn ánh nếu với mỗi phần tử $y \in Y$ đều tồn tại một phần tử $x\in X$ sao cho $f(x)=y$. Như vậy $f$ là toàn ánh nếu và chỉ nếu $f(X)=Y$.
		\item Ánh xạ $f \colon X \longrightarrow Y$ được gọi là song ánh giữa $X$ và $Y$ nếu và chỉ nếu nó vừa là đơn ánh và vừa là toàn ánh. Như vậy $f$ là song ánh nếu với mỗi $y\in Y$ tồn tại duy nhất một phần tử $x \in X$ sao cho $y=f(x)$.
		
	\end{enumerate}
\end{dn}

\begin{dl}
	Cho $A$ và $B$ là hai tập hợp hữu hạn.
	\begin{itemize}
		\item Nếu có một đơn ánh $f \colon X \longrightarrow Y$ thì $|X| \leq |Y|$.
		\item  Nếu có một toàn ánh $f \colon X \longrightarrow Y$ thì $|X|\geq|Y|$.
		\item Nếu có một song ánh $f \colon X \longrightarrow Y$ thì $|X|=|Y|$.
	\end{itemize}
\end{dl}

%\subsection{Bài tập mẫu}
\subsection{Sử dụng song ánh để đếm tổ hợp}

\begin{bt}%[Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Cho $X=\{1,2,\ldots ,n\}$. Có bao nhiêu tập con $k$ phần tử của $X$ sao cho trong mỗi tập con không chứa hai số nguyên liên tiếp?
	\loigiai{
		Gọi $A$ là tập tất cả các tập con $k$ phần tử của $X$ mà trong mỗi tập không chứa hai số nguyên liên tiếp và $B$ là tập tất cả các tập con của $Y=\{1,2,\ldots, n-(k-1)\} $. Ta xây dựng song ánh từ $A$ đến $B$ như sau: Lấy $S=\{s_1, s_2,\ldots,s_k\}\in A$ (không mất tính tổng quát có thể giả sử $s_1<s_2<\cdots<s_k$) đặt tương ứng với
		$f(S)=\{s_1, s_2-1, s_3-2,\ldots_k-(k-1)\}$. Dễ chứng minh đây là một song ánh. Từ đó có $\mathrm{C}^k_{n-k+1}$ tập thỏa mãn yêu cầu bài toán.
	}
\end{bt}

\begin{bt}%[Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Hãy tính trung bình cộng của tất cả các số $N$ gồm $2014$ chữ số thỏa mãn $N$ chia hết cho $9$ và các chữ số của $N$ được lập từ $X=\{1,2,\ldots,8\}$.
	\loigiai{
		Gọi $M$ là tập các số thỏa mãn yêu cầu bài toán.\\
		Ta xây dựng một ánh xạ đi từ $M$ đến $M$ như sau: Với mỗi $N=\overline{a_1a_2\ldots a_{2014}}\in M$, đặt $\break f(N)=\overline{b_1b_2\ldots b_{2014}}$ với $b_i=9-a_i$ với mọi $i=1,2,\ldots,2014$. Vì $N+f(N)=99\ldots9 \; (2014 \text{ số } 9)$ chia hết cho $9$ và $N$ chia hết cho $9$ nên suy ra $f(N)$ cũng chia hết cho $9$. Do đó $f$ là một ánh xạ đi từ $M$ vào $M$. Hơn nữa, dễ thấy $f$ là một song ánh. Từ đó suy ra $$2\sum_{N\in M}N=\sum_{N\in M}(N+f(N))=|M|\cdot99\ldots9.$$
		Vậy trung bình cộng của các số trong $M$ là $99\ldots 9:2$.
	}
	
\end{bt}

\begin{bt}%[Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Cho các số tự nhiên $k$, $n$, $m$ thỏa mãn điều kiện $1<k\leq n,\, m>1$. Hỏi có bao nhiêu bộ sắp thứ tự $(a_1, a_2,\ldots, a_k)$ của $n$  số tự nhiên đầu tiên mà mỗi bộ đều thỏa mãn ít nhất một trong hai điều kiện sau
	\begin{enumerate}[i)]
		\item Tồn tại $i,j\in\{1,2,\ldots,k\}$ sao cho $i<j$ và $a_i>a_j$.
		\item Tồn tại $i\in \{1, 2, \ldots, k\}$ sao cho $a_i-i$ không chia hết cho $m$. 
	\end{enumerate}
	\loigiai{
		Gọi $A$ là tập tất cả những chỉnh hợp chập $k$ của $n$ số tự nhiên đầu tiên, $A'$ là tập các chỉnh hợp thỏa mãn yêu cầu đề bài.\\
		$\begin{aligned} \text{Đặt } &B=\{(a_1,a_2,\ldots a_k)\in A: a_1<a_2<\cdots<a_k\; \text{và}\; a_i-i\ \vdots\ m, \, i=1,2,\ldots, k\},\\
		&B'=\{(b_1,b_2,\ldots,b_k):b_1<b_2<\ldots<b_k,\, b_i\in \{1,2,\ldots, n-k+km\}, b_i\ \vdots\ m, \forall i=1,2,\ldots, k\}. \end{aligned}$\\
		Xét ánh xạ $f$ đi từ $B$ đến $B'$ như sau: với mỗi $(a_1,a_2,\ldots, a_k)\in B$ ta cho tương ứng với $f(B)=(a_1-1+m, a_2-2+2m,\ldots,a_k-k+km)$. Khi đó $f$ là song ánh từ $B$ đến $B'$ nên $|B|=|B'|=\mathrm{C}^k_{\lfloor \frac{n-k}{m} \rfloor+k}$.\\
		Mà $A'=A \setminus B$ nên $|A'|=|A|-|B|=\mathrm{A}^k_n-\mathrm{C}^k_{\lfloor \frac{n-k}{m} \rfloor+k}$.
	}
\end{bt}

\subsection{Sử dụng song ánh để chứng minh đẳng thức tổ hợp}
\begin{bt}%[Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Gọi $a_n$
	là số các xâu nhị phân độ dài $n$ không chứa ba bit $0$, $1$, $0$ liên tiếp. Gọi
	$b_n$ là số các xâu nhị phân độ dài $n$ không chứa bốn bit $0$, $0$, $1$, $1$ hoặc $1$, $1$, $0$, $0$ liên tiếp. Chứng minh rằng $b_{n+1}=2a_n$ với mọi số nguyên dương $n$.
	\loigiai{
		Gọi $A_n$, $B_n$ lần lượt là tập các xâu nhị phân độ dài $n$ thỏa mãn điều kiện thứ nhất và thứ hai. Với mỗi xâu nhị phân $(x_1,x_2,\ldots ,x_n)$ ta cho tương ứng với một xâu nhị phân $(y_0,y_1,\ldots,y_n)$ xác định bởi $y_0=0$ và
		\begin{equation}\label{EXTCh4.TH.11}
		 y_i=x_1+x_2+\cdots +x_i \mod 2, \, i=1,2,\ldots,n.
		\end{equation}
		Khi đó $$x_i=y_i-y_{i-1}\mod 2,\, i=1,2,\ldots,n.$$
		Dễ thấy \eqref{EXTCh4.TH.11} là một song ánh giữa tập tất cả các xâu nhị phân độ dài $n$ và tập tất cả các xâu nhị phân độ dài $n+1$ trong đó có bit đầu tiên là $0$. Hơn nữa, xâu nhị phân $(x_1,x_2,\ldots,x_n)$ có ba bit $0$, $1$, $0$ liên tiếp theo thứ tự này khi và chỉ khi xâu nhị phân tương ứng $(y_0,y_1,\ldots,y_n)$ có bốn bit liên tiếp theo thứ tự là $0$, $0$, $1$, $1$ hoặc $1$, $1$, $0$, $0$. Nói cách khác một xâu nhị phân thuộc $A_n$ sẽ tương ứng với một xâu nhị phân thuộc $B_{n+1}$ bắt đầu bằng bit $0$. Vì số xâu nhị phân thuộc vào  $B_{n+1}$ bắt đầu bằng bit $0$ đúng bằng một nửa số xâu nhị phân thuộc vào $B_{n+1}$ do đó ta có $b_{n+1}=2a_n$ (điều phải chứng minh).
	}
\end{bt}

\begin{bt}%[Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Gọi $M$ là số nguyên dương trong hệ thập phân có $2n$ chữ số trong đó có $n$ chữ số $1$ và $n$ chữ số $2$. Gọi $N$ là số nguyên dương có $n$ chữ số trong hệ thập phân trong đó chỉ có các chữ số $1$, $2$, $3$, $4$ và số chữ số $1$ bằng số chữ số $2$. Chứng minh $|M|=|N|$.
	\loigiai{
		Ta sẽ chứng minh rằng có một song ánh đi từ $N$ vào $M$. Lấy một số bất kỳ thuộc vào $N$, ta sẽ
		cho tương ứng với một số thuộc vào $M$ theo cách: đầu tiên viết hai số này liền nhau ta sẽ được
		một số có $2n$ chữ số, sau đó các chữ số $3$ ở $n$ chữ số đầu tiên được đổi thành chữ số $1$, các chữ
		số $3$ ở $n$ chữ số tiếp theo được đổi thành chữ số $2$. Tương tự, các chữ số $4$ ở $n$ chữ số đầu tiên
		được đổi thành chữ số $2$, các chữ số $4$ ở $n$ chữ số tiếp theo được đổi thành các chữ số $1$. Với cách
		làm này ta thu được một số thuộc vào $M$ và hiển nhiên đây là một đơn ánh. Để chứng minh
		đây là một song ánh ta xây dựng ánh xạ ngược như sau:\\
		Với một số có $n$ chữ số $1$ và $n$ chữ số $2$ ta cắt đôi $n$ chữ số đầu và $n$ chữ số cuối sau đó đặt
		chúng song song nhau và thực hiện \textit{phép cộng} như sau:	$$1+1=1,\,2+2=2,\,1+2=3,\,2+1=4.$$
		Khi đó ta sẽ thu được một số thuộc $N$. Như vậy có một song ánh giữa hai tập $M$ và $N$ nên $|M|=|N|$.
	}
\end{bt}

\begin{bt}%[Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Cho $X =\{1, 2,\ldots, n\}$. Một tập con $A$ của $X$ được gọi là \textit{tập béo }nếu mỗi phần
	tử của $A$ đều không nhỏ hơn số phần tử của nó. Tập rỗng cũng là một tập béo. Đặt $a_n$
	là số các
	tập béo của $X$ mà trong mỗi tập không chứa hai số liên tiếp, $b_n$
	là số các tập con của $X$ mà hai
	phần tử bất kỳ hơn kém nhau ít nhất $3$ đơn vị. Chứng minh $a_n=b_n$.
	
	\loigiai{
		Gọi $A$ là học các tập béo thỏa mãn yêu cầu đề bài, $B$ là họ các tập con của $X$ có tính chất hai phần tử bất kỳ hơn kém nhau $3$ đơn vị. Ta thiết lập một ánh xạ $f$ đi từ $A$ đến $B$ như sau: giả sử $x=\{a_1, a_2,\ldots, a_k\}\in A$, ta có thể giả sử $k\leq a_1<a_2<\cdots<a_k\leq n$. Đặt $b_1=a_1-k+1,\,b_2=a_2-k+2,\ldots ,b_k=a_k$. Khi đó $$a_{i+1}\geq a_1+2,\,i=1,2,\ldots, k-1.$$
		Suy ra $a_{i+1}-a_i\geq 2$ do đó $b_{i+1}-b_i\geq 3$ và $b_1\geq 1, b_k\leq n$. Định nghĩa $f(x)=y=\{b_1,b_2,\ldots,b_k\}$, suy ra $y\in B$. Vậy $f$ là một ánh xạ, hơn nữa dễ thấy $f$ là một song ánh, do đó ta có điều cần chứng minh.
	}
\end{bt}

\subsection{Sử dụng ánh xạ để chứng minh bất đẳng thức tổ hợp}
\begin{bt}%[Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Cho $m$, $n$ là các số nguyên lớn hơn $1$, $S$ là một tập gồm $n$ phần tử. Giả sử $A_1, A_2,\ldots, A_m$ là các tập con của $S$ sao cho với mọi $x, y\in S$ bao giờ cũng có một tập $A_i$ để cho $x\in A_i$ và $y\not\in A_i$ hoặc $x\not\in A_i$ và $y\in A_i$. Chứng minh rằng $n\leq2^m$.
	\loigiai{
		Gọi $T$ là tập tất cả các xâu nhị phân có $m$ ký tự. Xét một tương ứng đi từ $S$ đến $T$ như sau: Với mỗi $x\in S$, đặt $f(x)=x_1x_2\ldots x_m$, trong đó $x_i=1$ nếu $x\in A_i$ và $x_i=0$ nếu $x\not\in A_i$. Khi đó hiển nhiên $f$ là một đơn ánh nên $|S|\leq |T|$ hay $n\leq 2^m$.
	}
\end{bt}

\begin{bt}%[Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Cho $X$ là tập gồm $n$ số bất kỳ. Giả sử $a_1,a_2,\ldots , a_k$ là các số thỏa mãn $\break \forall u,v \in X, u\ne v$ tồn tại $a_i$ sao cho $(u-a_i)(v-a_i)\leq 0$. Chứng minh rằng $n\leq 3^k$.
	\loigiai{
		Đặt $Y=\{(u_1,u_2,\ldots, u_k): u_i=0,1,2\}$. Với mỗi $u\in X$, đặt $f(u)=\{u_1,u_2,\ldots,u_k\}\in Y$, trong đó  $$u_i=\heva{&0, && u<a_i\\&1, && u=a_i\\&2, && u>a_i}$$
		với mọi $i=1,2,\ldots,k$. Ta sẽ chứng minh $f$ là đơn ánh. Thật vậy, giả sử tồn tại $u,v\in X$, mà $u\ne v$ và $f(u)=(u_1,u_2,\ldots,u_k)=(v_1,v_2,\ldots, v_k)=f(v)$ thì vì $u\ne v$ nên tồn tại $a_i$ sao cho $(u-a_i)(v-a_i)\leq 0$. Để ý rằng $u_i=v_i,\,\forall i=1,2,\ldots,k$ nên hoặc $u,\,v<a_i$ hoặc $u,v=a_i$ hoặc $u,v>a_i$. Cả ba trường hợp này đều không xảy ra nên $f$ là đơn ánh.\\
		Từ đó suy ra $n=|X|\leq|Y|=3^k$.
	}
\end{bt}

\begin{bt}%[Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Với mỗi  $n\in \mathbb{N}$,  ký hiệu $H_n$ là tập tất cả các hoán vị $(a_1,a_2,\ldots, a_n)$ của ${[n]=\{1,2,\ldots,n\}}$. Xét các tập hợp
	{\allowdisplaybreaks
	\begin{align*}
	&S_n=\{(a_1,a_2,\ldots, a_n)\in H_n:a_i \geq i-1, \forall i=1,2,\ldots,n\}, \\
	&T_n=\{(a_1,a_2,\ldots, a_n) \in H_n:a_i \leq i+1, \forall i=1,2,\ldots,n\}.
	\end{align*}}Tìm tất cả các số nguyên dương $n$ sao cho $\dfrac{|T_n|}{|S_n|}>\dfrac{1}{3}$.
	\loigiai{
		Đặt $P_n=\{(a_1,a_2,\ldots, a_n)\in S_n:a_1=1\}$, $Q_n=\{(a_1,a_2,\ldots,a_n)\in S_n:a_n\ne 1\}$. Hiển nhiên $P_n\cap Q_n=\varnothing,\; P_n\cup Q_n=S_n$.\\
		Xét ánh xạ $f$ đi từ $P_n$ đến $Q_n$ như sau: với	$(a_1,a_2,\ldots,a_n)\in P_n$ ta cho tương ứng với  $(a_2,a_1,\ldots,a_n)\in Q_n$. Dễ thấy $f$ là một song ánh nên $|P_n|=|Q_n|=\dfrac{1}{2}|S_n|$.\\
		Xét ánh xạ $g$ đi từ $P_n$ đến $S_{n-1}$ như sau: với $(a_1,a_2,\ldots,a_n)\in P_n$ ta cho tương ứng với $\break (a_2-1, a_3-1,\ldots,a_n-1)\in  S_{n-1}$. Dễ thấy $g$ là song ánh nên $|P_n|=|S_{n-1}|$. Do đó ta có $|S_n|=2|S_{n-1}|, n\geq 2$. Hơn nữa $|S_2|=2, |S_1|=1$ nên $|S_n|=2^{n-1}$.\\
		Xét ánh xạ $h$ đi từ $T_n$ đến $T_{n-1}\cup T_{n-2}$ xác định như sau: với mỗi $(a_1,a_2,\ldots,a_n)\in T_n$ ta cho tương ứng với $(a_2-1, a_3-1,\ldots,a_n-1)$ nếu $a_1=1$ và tương ứng với $(a_3-2,a_4-2,\ldots,a_n-2)$ nếu $a_1=2$. Dễ thấy $h$ là một song ánh nên $|T_n|=|T_{n-1}|+|T_{n-2}|$, mà $|T_2|=2,|T_1|=1$ do đó $$|T_n|=\dfrac{1}{\sqrt{5}}\left[\left(\dfrac{1+\sqrt{5}}{2}\right)^{n+1}-\left(\dfrac{1-\sqrt{5}}{2}\right)^{n+1}\right].$$ 
		Từ đó giải được $\dfrac{|T_n|}{|S_n|}>\dfrac{1}{3} \Leftrightarrow n\leq6$.
	}
\end{bt}

\subsection{Bài tập tự luyện}
\begin{bt}%[Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Cho $X=\{1,2,\ldots,n\}$. Một tập con $S=\{s_1,s_2,\ldots,s_k\}$ của $X$ $(s_1<s_2<\cdots<s_k) $ được gọi là $m$-\textit{tách được} $(m\in \mathbb{N})$ nếu $s_i-s_{i-1}\geq m; \, i=1,2,\ldots, k$. Có bao nhiêu tập con $m$-\textit{tách được} gồm $k$ phần tử của $X$, trong đó $0\leq k\leq n-(m-1)(k-1)$?
\end{bt}




\begin{bt}% [Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Cho $X=\{1,2,\ldots,n\}$, với mỗi tập con khác rỗng $A_i=\{a_1,a_2,\ldots,a_i\}$ (không mất tính tổng quát giả sử $a_1>a_2>\cdots>a_i$) ta định nghĩa \textit{tổng hỗn tạp} của $A_i$ là số $\break m(A_i)=a_1-a_2+a_3-\cdots\pm a_i$. Tính $\sum\limits_{A_i\subset X}m(A_i)$. 
\end{bt}

\begin{bt}% [Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Cho tập $S$ gồm tất cả các số nguyên dương trong đoạn $[1,2002]$. Gọi $T$ là tập hợp tất cả các tập con khác rỗng của $S$. Với mỗi $X$ thuộc $T$ ký hiệu $m(X)$ là trung bình cộng các phần tử thuộc $X$. Tính $$m=\dfrac{\sum_{X\in T}m(X)}{|T|}.$$
\end{bt}

\begin{bt}% [Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Với mọi số tự nhiên $n$, gọi $p_n(k)$ là số các hoán vị của tập $A=\{1,2,\ldots,n\}$ mà có đúng $k$ điểm cố định $(0\leq k\leq n)$. Chứng minh rằng $$\sum^n_{k=0}k\cdot p_n(k)=n!.$$
\end{bt}

\begin{bt}% [Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Cho $n\geq 3$ là một số nguyên dương. Ký hiệu $T_n=\{0,1,2,\ldots, n-1\}$. Xét các tập 
	\begin{gather*}
	A_n=\{(a,b,c):a,b,c\in T_n,\, a<b<c,\, a+b+c\equiv 0\pmod{n}\},\\
	B_n=\{(a,b,c): a,b,c \in T_n,\, a\leq b\leq c , \, a+b+c \equiv 0 \pmod{n}\}.
	\end{gather*}
	Chứng minh rằng $|A_{n+3}|=3|B_n|$.
\end{bt}

\begin{bt}% [Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Cho số nguyên dương $n$ và $d$ là một ước dương của $n$. Gọi $S$ là tập tất cả những bộ $(x_1,x_2,\ldots,x_n)$ nguyên dương thỏa mãn $0\leq x_1\leq x_2\cdots\leq x_n\leq n$ và $d\mid (x_1+x_2+\cdots + x_n)$. Chứng minh rằng có đúng một nửa các phần tử của $S$ có tính chất $x_n=n$.
\end{bt}

\begin{bt}% [Ban Nt, Dự án EX-Tapchi04]%[1D0G6]
	Mỗi hoán vị $(x_1, x_2,\ldots,x_{2n})$ của tập $S=\{1,2,\ldots,2n\}$ được gọi là có tính chất $P$ nếu $|x_i-x_{i+1}|=n$ với ít nhất một giá trị $i\in \{1,2,\ldots, 2n-1\}$. Chứng minh rằng với mỗi $n$ nguyên dương số hoán vị có tính chất $P$ lớn hơn số hoán vị không có tính chất $P$.
\end{bt}




\section{Bắt dầu từ những trường hợp nhỏ}
\begin{center}
	\textbf{\color{violet}
		{Nguyễn Thế Sinh\\
			(GV THPT chuyên Nguyễn Trãi, Hải Dương)}}
\end{center}
Toán rời rạc luôn là một bài toán rất khó trong bất kỳ đề thi nào, đặc biệt với học sinh Việt Nam-những người ít được học một cách bài bản về mảng này của môn Toán. Cho dù có một số lượng khá lớn các bài toán không cần nhiều kiến thức đồ sộ mà chỉ cần những kiến thức rất tầm thường, đơn giản như nguyên lý quy nạp, như các quy tắc đếm cơ bản,\ldots nhưng vẫn khiến học sinh phải cảm thấy ái ngại khi đứng trước nó. Chính vì thế, tôi muốn đề cập đến một hướng tiếp cận các bài toán rời rạc mà nếu không giải được bài toán thông qua cách tiếp cận này thì chí ít học sinh còn hiểu nổi đề bài. Hướng tiếp cận này cũng vô cùng đơn giản, đó là bắt đầu với những ví dụ, những trường hợp nhỏ, cụ thể. Tuy vậy, cách làm này đòi hỏi sự kiên nhẫn và tất nhiên cũng đòi hỏi một chút sự nhạy cảm Toán học, để phát hiện ra quy luật cũng như những ý tưởng lóe lên trong các trường hợp ấy. Các bài toán mà tôi đưa ra sau đây là các ví dụ minh họa cho điều này, các trường hợp nhỏ lẻ nhiều khi chứa đựng luôn phương pháp giải, nhưng cũng có khi chỉ chứa đựng một ý tưởng làm tiền đề cho lời giải, hoặc có khi chỉ giúp tháo gỡ một vài điểm nút trong một lời giải được xem từ phương diện tổng quát. Nhưng chắc chắn một điều, các ví dụ này đều giúp ta hiểu rõ đề bài hơn, qua đó giúp ta có dũng khí đương đầu với nó.\\
Ngoài ra, trong bài viết này, khi làm việc với các trường hợp nhỏ, tôi sẽ dùng cỡ chữ nhỏ hơn một chút để các bạn có thể tiện theo dõi, phân biệt được lời giải cuối cùng và những dẫn dắt dẫn đến lời giải đó. 
\setcounter{bt}{0}
\begin{bt}%[Nguyễn Phú Thạch,Dự án EX_TapChi04]%[1D0G6]
	Với mỗi $ n $, xét tập hợp $S_n=\{1,2,3,\ldots, n\} $. Tìm số tập hợp con khác rỗng của $S_n$  không chứa $ 2 $ số nguyên liên tiếp tùy theo $ n $.
	\loigiai{
		Trước hết, ta bắt đầu với những trường hợp nhỏ
		\begin{itemize}
			\item Với $ n=1 $, ta được $ 1 $ tập hợp thỏa mãn là $\{1\}$.
			\item Với $ n=2 $, ta được $ 2 $ tập hợp  thỏa mãn là $\{1\};\, \{2\}$.
			\item Với $ n=3 $, ta được $ 4 $ tập thỏa mãn là 	$ \{1\};\, \{2\};\, \{3\};\, \{1,3\} $.
			\item  Với $ n=4 $, ta được $ 7 $ tập thỏa mãn là $ 	\{1\};\, \{2\};\, \{3\};\, \{4\};\, \{1,3\};\, \{1,4\};\,\{2,4\} $.
			\item Với $ n=5 $, ta được $ 12 $ tập thỏa mãn là	
			\begin{center}
				$ 	\{1\}; \,\{2\};\, \{3\};\,\{4\};\,\{5\};\,\{1,3\};\,\{1,4\};\,\{1,5\};\,\{2,4\};\,\{2,5\};\,\{3,5\};\,\{1,3,5\} $.
			\end{center}
		\end{itemize}
		Bây giờ, quan sát sự thay đổi các tập thu được khi $ n $ tăng dần, ta có thể thấy khi $ n $ tăng lên $  1 $ đơn vị, ngoài các tập thu được ứng với giá trị $ n $ trước đó, thì còn các tập mới được tạo ra bằng cách thêm chính số $ n $ vào, tuy nhiên chỉ được phép thêm vào những tập không chứa số $ n-1 $. Chẳng hạn với $ n=4 $, các tập là $  \{1\};\, \{2\};\, \{3\};\,\{4\};\,\{1,3\};\,\{1,4\};\,\{2,4\} $.
		Thì với $ n=5 $, vẫn có các tập đó, nhưng thêm vào các tập 
		\begin{itemize}
			\item $ \{5\} $, tạo từ tập $\emptyset$ bằng cách thêm số $ 5 $.
			\item $ \{1,5\};\{2,5\};\{3,5\} $, tạo từ các tập $ \{1\};\{2\};\{3\} $ bằng cách thêm vào số $ 5 $.
			\item $ \{1,3,5\} $, tạo từ tập $ \{1,3\} $ bằng cách thêm vào số $ 5 $.
		\end{itemize}
		Những tập chứa số 4 không tạo được tập nào thỏa mãn. Như vậy, tổng quát hóa suy nghĩ này, ta thu được lời giải nhờ truy hồi (từ trường hợp trước tạo ra trường hợp sau) như sau\\
		Gọi $a_n$  là số tập con tập $S_n$  thỏa mãn đề bài, ta có  $a_1=1,\,a_2=2,\,a_3=4,\,a_4=7,\,a_5=12$.
		Xét với tập $S_{n+1}$, một tập con thỏa mãn thuộc một trong hai loại
		\begin{itemize}
			\item Loại $ 1 $: Không chứa $ n+1 $, có  $a_n$ tập loại này.
			\item Loại $ 2 $: Chứa $ n+1 $, các tập loại này được tạo ra nhờ thêm vào $  n+1 $ từ các tập con của $S_n$ thỏa mãn đề bài, nhưng các tập con này không chứa $ n $, đó chính là các tập con của $S_{n-1}$  thỏa mãn đề bài. Ngoài ra có thêm tập $ \{n+1\} $. Vậy có  $a_{n-1}+1$ tập loại này.
		\end{itemize}
		Từ đó ta được:$ \left\{\begin{array}{l}
		a_1=1,\,a_2=2\\ a_{n+1}=a_n+a_{n-1}  +1 \quad \text {khi } n\geq2
		\end{array}\right.$\\
		Giải phương trình sai phân thu được ở trên, ta được: 
		$$a_n=\dfrac{\sqrt{5}-3}{2\sqrt{5}}\left(\dfrac{1-\sqrt{5}}{2}\right)^n+\dfrac{\sqrt{5}+3}{2\sqrt{5}}\left(\dfrac{1+\sqrt{5}}{2}\right)^n-1.$$
		Với kiểu lập luận tương tự trên, ta có thể có lời giải cho bài toán sau}
\end{bt}
\begin{bt}%[Nguyễn Phú Thạch,Dự án EX_TapChi04]%[1D0G6]
	Xét một hoán vị $(x_1,\,x_2,\ldots, x_n)$ của tập $S_n=\{1,\,2,\ldots,\,n\}$. Vị trí $i,\,1\leq i\leq n$ được gọi là vị trí cực đại nếu $x_i>x_{i-1},\,x_i>x_{i+1}$ (vị trí $1$ và $n$ không phải là vị trí cực đại). Gọi $p(n,k)$ là số hoán vị có đúng $k$ vị trí cực đại. Chứng minh rằng
	\begin{center}
		$p(n+1,k+1)=(2k+4)\cdot p(n,k+1)+(n-2k+1)\cdot p(n,k)$.
	\end{center}
	\loigiai{
		Nhận xét: Nếu $i$ là vị trí cực đại của $(x_1,\,x_2,\ldots,x_n)$ thì $i-1,\,i+1$ không phải là vị trí cực đại.\\
		Gọi $p(n,k)$ là số hoán vị của $S_k$ có đúng $k$ vị trí cực đại. Xét $(x_1,\,x_2\,\ldots,\,x_n)$ là một hoán vị của $S_n$, có $k$ vị trí cực đại $i_1<i_2<\cdots <i_k$.\\
		Đưa $x_1,\,x_2\,\ldots, x_n$ vào các ô như sau ($x_i$ luôn đứng giữa hai ô trống, có $n+1$ ô trống)
		\begin{center}
			\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
				\hline 
				&$x_1$&&$x_2$&$\ldots$&$x_{i_1-1}$&&$x_{i_1}$&&$x_{i_1+1}$&$\ldots$&$x_{n-1}$&&$x_n$&\\
				\hline
			\end{tabular}
		\end{center}
		Khi đưa $n+1$ vào hoán vị $(x_1,x_2,\ldots,x_n)$ để thành một hoán vị của $S_{n+1}$, ta đặt $n+1$ vào một trong $n+1$ ô trống. Ta có các trường hợp sau
		\begin{itemize}
			\item Trường hợp $1$: Nếu $n+1$ được đặt vào ô trống đầu tiên hoặc cuối cùng thì số vị trí cực đại của hoán vị mới không đổi (không ảnh hưởng đến vị trí cực đại).
			\item Trường hợp $2$: Nếu $n+1$ được đặt vào $1$ trong $2k$ ô trống cạnh $i_1,\,i_2,\ldots,\,i_k$ thì tạo ra một hoán vị có đúng $k$ vị trí cực đại (thêm một vị trí cực đại là vị trí của $n+1$ nhưng bớt đi một vị trí cực đại $i_k$ nếu $n+1$ đứng cạnh $i_k$, nghĩa là số vị trí cực đại không đổi).
			\item Trường hợp 3: Nếu $n+1$ được đặt tại các ô trống còn lại (có $n-2k-1$ ô) thì đều làm tăng thêm một vị trí cực đại, là vị trí của $n+1$.
		\end{itemize}
		Vậy mỗi hoán vị của $S_n$ có $k$ vị trí cực đại sẽ tạo ra $2k+2$ hoán vị của $S_{n+1}$ có $k$ vị trí cực đại và $n-2k-1$ hoán vị của $S_{n+1}$ có $k+1$ vị trí cực đại bằng cách thêm $n+1$ vào giữa.\\
		$n!$ hoán vị của $S_n$ mỗi hoán vị tạo ra $n+1$ hoán vị của $S_{n+1}$ bằng cách thêm $n+1$ vào giữa, $2$ hoán vị của $S_n$ không tạo ra cùng một hoán vị của $S_{n+1}$, $n!$ hoán vị này được chia làm $3$ loại
		\begin{itemize}
			\item Loại 1: Có $k$ vị trí cực đại: $p(n,k)$ hoán vị.
			\item Loại 2: Có $k+1$ vị trí cực đại: $p(n,k+1)$ hoán vị.
			\item Loại 3: Có không quá $k-1$ vị trí cực đại.
		\end{itemize}
		Mỗi hoán vị loại $1$ cho $n-2k-1$ hoán vị của $S_{n+1}$ có $k+1$ ví trí cực đại.
		Mỗi hoán vị loại $2$ cho $2(k+1)+2=2k+4$ hoán vị của $S_{n+1}$ có $k+1$ vị trí cực đại. Mỗi hoán vị loại $3$ không cho hoán vị nào của $S_{n+1}$ có $k+1$ vị trí cực đại.\\
		Vậy $p(n+1,k+1)=(2k+4)\cdot p(n,k+1)+(n-2k+1)\cdot p(n,k)$.\\
		Với $k=0$ thì $p(n+1,1)=4p(n,1)+(n+1)p(n,0)$.
		
	}
\end{bt}
Tiếp theo là hai bài tập tương tự.	
\begin{bt}%[Nguyễn Phú Thạch,Dự án EX_TapChi04]%[1D0G6]
	Có bao nhiêu tập con của tập $S_n=\{1,2,\ldots,n\}$, chứa đúng $2$ số nguyên liên tiếp.
\end{bt}
\begin{bt}%[Nguyễn Phú Thạch,Dự án EX_TapChi04]%[1D0G6]
	Có bao nhiêu xâu nhị phân độ dài $n$, trong đó không có $2$ bit $1$ nào đứng cạnh nhau?
\end{bt}

\begin{bt}%[Nguyễn Phú Thạch,Dự án EX_TapChi04]%[1D0G6]
	Cho $n$ nguyên dương, gọi $S$ là tập gồm $2^n+1$ phần tử, $X$ là tập tất cả các tập con của $S$, $Y = \{0,1,\ldots,2^{n-1}-1\}$. Xét ánh xạ $f: X\rightarrow Y$ thỏa mãn\\
	Với mọi $x,y,z \in S$, trong $3$ số $f(\{x,y\}),\,f(\{y,z\}),\,f(\{z,x\})$, có một số bằng tổng hai số còn lại. Chứng minh rằng tồn tại $a,\,b,\,c \in S$ sao cho $f(\{a,b\})=f(\{b,c\})=f(\{c,a\})=0$.
	\loigiai{
		Với $n=1$, $S$ có $3$ phần tử $S=\{a,\,b,\,c\}$ và $Y=\{0\}$ nên đương nhiên \begin{center}
			$	f(\{a,b\})=f(\{b,c\})=f(\{c,a\})=0.$
		\end{center}
		Với $n=2$, $S=\{a,\,b,\,c,\,d,\,e\}$ và $Y=\{0,\,1\}$, tập $X$ có $10$ phần tử, cố định $a\in S$, quy ước $f(\{a,a\})=0$, xét $2$ tập $U=\{x\in S,\,f(\{x,\,a\})=0\};\,V=\{y\in S,\,f(\{y,\,a\})=1\}$. Khi đó tồn tại ít nhất $1$ trong $2$ tập $U$ hoặc $V$, có số phần tử lớn hơn hoặc bằng $3$.
		\begin{itemize}
			\item Nếu tập đó là $U$ thì tồn tại $3$ phần tử $a,\,x,\,y$ thuộc $U$, rõ ràng
			\begin{center}
				$f(\{x,a\})=f(\{y,a\})=f(\{x,y\})=0.$
			\end{center}
			\item Nếu tập đó là $V$ thì tồn tại $x,\,y,\,z \in V$, khi đó 
			\begin{center}
				$f(\{x,y\})=f(\{y,z\})=f(\{z,x\})=0.$
			\end{center}
		\end{itemize}
		Với $n=3$, ta có $S$ gồm $9$ phần tử, $Y=\{0,\,1,\,2,\,3\}$. Cố định $a\in S$. Chia tập $S$ thành $2$ tập $U=\{x\in S,\,f(\{x,a\})\,\, \text{chẵn}\}$ và $V=\{y\in S,\,f(\{y,a\})\,\, \text{lẻ}\}$. Khi đó tồn tại một tập có $5$ phần tử.
		\begin{itemize}
			\item Nếu tập đó là $U$ thì $U$ đóng vai trò như $S$ trong trường hợp trên, $f(\{x,y\})$ chẵn nếu $x,\,y\in U$, bài toán được giải quyết với $Y'=\{0,\,2\}$ đóng vai trò của $Y$.
			\item Nếu tập đó là $V$ thì đóng vai trò như $S$ trong trường hợp trên, $f(\{x,y\})$ chẵn nếu $x,\,y\in U$, bài toán được giải quyết với $Y'=\{0,\,2\}$ đóng vai trò của $Y$.
		\end{itemize}
		Từ các trường hợp trên, ta có các ý tưởng quy nạp sau\\
		Giả sử bài toán đúng cho trường hợp $n=k$, xét tập $S$ gồm $2^{k+1}$ phần tử, cố định $a\in S$. Chia $S$ thành $2$ tập $U=\{x\in S,\,f(\{x,a\})\,\,\text{chẵn}\}$ và $V=\{y\in S,\,f(\{y,a\})\,\, \text{lẻ}\}$. Khi đó tồn tại một tập có $\left[\dfrac{2^{k+1}+1}{2}\right]=2^k+1$ phần tử, giả sử đó là $U$.\\
		Khi đó với mọi $x,\,y\in U$ thì $f\{x,y\})$ chẵn vì $f(\{x,y\})+f(\{x,a\})+f(\{y,a\})$ chẵn và $f(\{x,a\})+f(\{y,a\})$ chẵn, từ đó $f\{x,y\}\in \{0,2,\ldots,2^k-2\}$.\\
		Xét $g(\{x,y\})=\dfrac{1}{2}f(\{x,y\})$, ta chuyển bài toán về trường hợp trước. Từ đó có điều phải chứng minh.
	}
\end{bt}

\begin{bt}[IMO shortlisted $2005$]%[Phan Anh Tiến, Dự án EX_TapChi04]%[2D0G2]
	Cho số tự nhiên $n,$ $n>3$. Ta đánh số mỗi cạnh và mỗi đường chéo của $n$-giác $P_1P_2\cdots P_n$ bởi một số nguyên dương nhỏ hơn hoặc bằng $r$ thỏa mãn:
	\begin{enumerate}[\rm(i)]
		\item Mọi số nguyên dương từ $1$ đến $r$ đều được đánh số.
		\item Với mỗi tam giác $P_iP_jP_k,$ hai cạnh được đánh số bởi cùng một số và cạnh còn lại đánh bởi số nhỏ hơn.
	\end{enumerate}
	Hãy thực hiện các yêu cầu sau		
	\begin{enumerate}
		\item Xác định số nguyên dương $r$ lớn nhất mà điều đó có thể thực hiện được.
		\item Với $r$ thu được ở trên, có bao nhiêu cách đánh số thỏa mãn.
	\end{enumerate}
	\loigiai{
		Trước tiên, ta kí hiệu $|XY|=k$ nếu đoạn $XY$ được đánh số bởi $k.$ Ta xét một số trường hợp cụ thể sau
		\begin{itemize}
			\item Xét $n=3,$ ta có một tam giác duy nhất. Khi đó, ta có đúng hai số nguyên dương phải dùng là $1$ và $2,$ trong đó số $2$ được dùng cho hai cạnh, số 1 được dùng cho cạnh còn lại nên có $3$ cách đánh số.
			\item Xét $n=4,$ ta có một tứ giác. Có tất cả $6$ cạnh và đường chéo, nên các số nguyên được dùng không thể vượt quá $6$, nếu số $6$ được đánh một đoạn nào đó, do đoạn này là cạnh của hai tam giác khác nhau, nên tồn tại thêm hai đoạn khác được đánh số $6.$ Như vậy, chỉ còn ba đoạn, nhưng buộc phải đánh số từ 1 đến 5, mâu thuẫn. Vậy $r<6.$ \\
			Nếu $r=5,$ tương tự, còn phải đánh số $1,2,3,4$ cho ba cạnh, cũng mâu thuẫn.\\
			Nếu $r=4,$ giả sử $|P_1P_2|=4$ thì hai tam giác $P_1P_2P_3$ và $P_1P_2P_4$ còn có thêm một cạnh đánh số $4$ nữa.\\
			- Giả sử $|P_1P_2|=|P_1P_4|=4$ thì ba cạnh $P_2P_3,$ $P_2P_4,$ $P_3P_4$ được đánh bởi ba số $1,2,3,$ trái điều kiện (ii).\\
			- Giả sử $|P_1P_3|=|P_2P_4|=4$ thì tam giác $P_1P_3P_4,$ $P_2P_3P_4$ còn một cạnh nữa được đánh số $4,$ nên có hai cạnh phải đánh bởi $3$ số. Mâu thuẫn.\\
			Nếu $r=3,$ dễ dàng có thể đánh số được. Giả sử $P_1$ là đỉnh mà từ đó có ít nhất hai cạnh đánh số bởi $3,$ có 2 trường hợp sau\\ 
			- Trường hợp 1. Có ba đoạn từ $P_1$ đánh số bởi 3 thì $|P_1P_2|=|P_1P_3|=|P_1P_4|=3.$ Khi đó $|P_2P_3|, |P_2P_4|, |P_3P_4|\in \left\lbrace 1;2\right\rbrace ,$ có 3 cách đánh số (xem trường hợp $n=3$).\\
			- Trường hợp 2. Có đúng hai đoạn từ $P_1$ được đánh số bởi $3,$ có $3$ cách chọn hai đỉnh tạo ra hai đoạn đó. Xét một cách chọn, giả sử $|P_1P_2|=|P_1P_3|=3, |P_1P_4|<3.$ Khi đó, chia tập $\{P_1, P_2, P_3, P_4\}$ thành hai tập $A=\{P_2,P_3\}, B=\{P_1,P_4\}$ thì đoạn nối một điểm thuộc tập $A$ với một điểm thuộc $B$ phải đánh số bởi $3,$ $\left\lbrace |P_2P_3|, |P_1P_4|\right\rbrace =\{1;2\}$ nên có 2 cách chọn  $|P_2P_3|$ và $ |P_1P_4|.$ Vậy có 6 cách đánh số thỏa mãn.\\
			Tổng cộng có $9$ cách đánh số thỏa mãn với $P_1$ làm đỉnh trung tâm, như vậy có $36$ cách đánh số, mỗi cách lặp lại $2$ lần nên cuối cùng có $18$ cách đánh số thỏa mãn.
		\end{itemize}
		Dựa vào lời giải trong trường hợp trên, ta có thể dự đoán $r$ lớn nhất bằng $n-1$ và đồng thời đưa ra được cách đếm trong trường hợp $r=n-1.$ Từ đó, có lời giải tổng quát sau:
		
		
		Xét một đỉnh $V$ mà từ đó có $k\le 2$ cạnh đánh số bởi $r,$ đỉnh như thế phải tồn tại vì tồn tại một tam giác có hai cạnh đánh số $r.$\\ 
		Gọi $A$ là tập các đỉnh từ $V$ được đánh số $r$ thì $|A|=k$ và $B$ là tập các đỉnh còn lại (gồm cả $V$) thì $|B|=n-k.$ Khi đó
		\begin{enumerate}[\rm(i)]
			\item Mọi cạnh nối từ một điểm thuộc $A$ đến một điểm thuộc $B$ đều được đánh số bởi $r,$ vì nếu giả sử có $X$ thuộc $A,$ $Y$ thuộc $B$ mà $|XY|<r$ thì $Y\ne V$ và do đó $|XV|=r, |YV|<r,$ do điều kiện ii) nên $|XY|=r.$ Mâu thuẫn.
			\item Mọi cạnh nối hai điểm trong $A$ đều đánh số nhỏ hơn $r,$ vì nếu $X,Y\in A$ thì $|XV|=|YV|=r$ nên $|XY| < r.$
			\item Mọi cạnh nối hai điểm trong $B$ đều đánh số nhỏ hơn $r,$ vì nếu $X,Y\in B$ mà $|XY|=r$ thì hoặc $|XV|=r$ hoặc $|YV|=r.$ Mâu thuẫn.
		\end{enumerate}
		\begin{enumerate}
			\item Ta chứng minh bằng quy nạp rằng giá trị lớn nhất của $r$ là $n-1.$
			Giả sử với mọi đa giác $k\le n$ cạnh, số số được dùng nhiều nhất là $k-1.$
			Xét đa giác $n+1$ đỉnh, giả sử $V, A, B$ là đỉnh và các tập được nói đến ở trên.\\
			Ta có $r\le |A|-1+|B|-1+1=k-1+(n+1-k-1)+1=n.$ Điều phải chứng minh.
			\item Như trên, nếu đa giác có $n$ cạnh và tập $A$ có $k$ phần tử thì tập $A$ có nhiều nhất $k-1$ số được dùng và tập $B$ có nhiều nhất $n-k-1$ số được dùng.\\ 
			Vậy để đánh số từ $1$ đến $n-1$ cho các đoạn tạo được từ đa giác, ta phải chọn $k-1$ số trong các số $\{1;2;\cdots; n-2\}$ để đánh số cho các đoạn tạo được từ các điểm trong tập $A$ và $n-k-1$ số còn lại trong tập đó để đánh số cho các đoạn tạo được từ các điểm thuộc tập $B.$\\
			Mặt khác, số cách chọn hai tập $A, B$ sao cho $|A|=k, |B|=n-k$ là $\mathrm{C}_n^k.$\\
			Từ đó ta có hệ thức truy hồi sau (với $f(n)$ là số cách đánh số trong trường hợp đa giác có $n$ cạnh)			
			$$\aligned 2f(n) &=\sum\limits_{k = 1}^n \mathrm{C}_n^k\cdot \mathrm{C}_{n-2}^{k-1}\cdot f(k)\cdot f(n-k)\\
			&=n!(n-2)!\sum\limits_{k=1}^{n-1}\left(\dfrac{f(k)}{k!(k-1)!} \right)\cdot\left( \dfrac{f(n-k)}{(n-k)!(n-k-1)!}\right) . \endaligned$$
			(Có $2f(n)$ là vì theo cách đếm như vậy, mỗi số $\mathrm{C}_n^k\cdot \mathrm{C}_{n-2}^{k-1}\cdot f(k)\cdot f(n-k)$ được tính 2 lần).\\
			Đặt $f(x)=x!(x-1)!g(x)$ ta có $2(n-1)g(n)=\sum\limits_{k=1}^{n-1} g(k)\cdot g(n-k).$\\
			Đến đây, bằng một số trường hợp nhỏ lẻ, ta có thể đoán được đáp số 
			$f(n)=\dfrac{n!(n-1)!}{2^{n-1}}$ và chứng minh kết quả đó bằng quy nạp.\\
			Bây giờ, với ý b), ta xem xét theo một khía cạnh khác, vẫn bắt đầu từ trường hợp $n=4,$ vẫn đánh số bởi ba số $1,2,3$ nhưng ta thử bắt đầu đánh số từ $1.$ 
			Nhận thấy nếu $|P_1P_2|=1$ thì $|P_1P_3|, |P_2P_3|, |P_2P_4|, |P_1P_4|$ đều khác $1,$ giả sử $|P_3P_4|=1$ thì xét tam giác $P_1P_3P_4,$ ta thấy chỉ dùng tối đa hai số, chẳng hạn là $1$ và $2,$ tam giác $P_2P_3P_4$ cũng dùng tối đa hai số, suy ra phải dùng $1$ và $3.$\\ Ta có $|P_1P_3|=2, |P_1P_2|=1, |P_2P_3|=3.$ Mâu thuẫn điều kiện (ii) của yêu cầu đề.\\
			Vậy không còn cạnh nào được phép đánh số $1.$ Từ đây, ta không quan tâm đến việc đánh số $1$ nữa mà chỉ còn đánh số $2$ và $3$ cho các đoạn. Nhận xét $|P_1P_2|=1$ nên $|P_1P_3|=|P_2P_3|,$ $|P_1P_4|=|P_2P_4|.$ Như vậy mỗi cách đánh số cho tam giác $P_1P_3P_4$ cho tương ứng đúng một cách đánh số cả tứ giác.\\ Vậy có thể coi $P_1$ và $P_2$ là 1 điểm. Bài toán được kéo về trường hợp $n=3.$\\ 
			Công việc rốt cuộc được chia làm 2 công đoạn.\\
			-  Công đoạn 1: Chọn 1 đoạn để đánh số 1: Có 6 cách ($\mathrm{C}_4^2=6$).\\
			- Công đoạn 2:  Đánh số 1 tam giác sau khi coi 2 điểm đầu mút của đoạn vừa chọn trùng nhau, có 3 cách.\\
			Kết quả: có 18 cách.\\
			Với cách suy luận ở trên, ta có lời giải thứ hai.
			
			Gọi $a_n$ là số cách đánh số khi dùng đến $n-1$ số cho các đoạn tạo được từ $n$ điểm.\\
			Ta chứng minh chỉ tồn tại duy nhất một cạnh được đánh số 1. Thật vậy, giả sử $|P_1P_2|=1,$ khi đó $|P_1P_i|=|P_2P_i|,\, \forall i\ne 1,2.$  Vậy một cách đánh số thỏa mãn $|P_1P_2|=1$ tương ứng với 1 cách đánh số cho $n-1$ điểm $P_1, P_3, P_4,\cdots, P_n.$ Nếu số 1 được dùng một lần nữa, thì $n-1$ điểm trên vẫn được đánh số bởi $n-1$ số, trong khi theo câu a), chỉ đánh số được bởi tối đa $n-2$ điểm. Mâu thuẫn.\\ 
			Vậy, chỉ có duy nhất 1 cạnh được đánh số 1. Chọn cạnh này, có $\mathrm{C}_n^2$ cách.\\
			Với mỗi cạnh được chọn, có thể coi hai đỉnh của cạnh đó là một đỉnh (lập luận như trên), ta còn $a_{n-1}$ cách đánh số với $n-1$ đỉnh bằng $n-2$ số.\\ 
			Vậy có $a_n=\mathrm{C}_n^2\cdot a_{n-1}$ với $a_3=3, a_4=18.$\\ 
			Dễ dàng có được $a_n=\dfrac{n!(n-1)!}{2^{n-1}}.$	
		\end{enumerate}
	}
\end{bt}
\begin{bt}[IMO Shortlisted $2001$, problem $12$]%[Tô Ngọc Thy, Dự án EX_TapChi04]%[2D0G2]
	Với mỗi số nguyên dương $n$, gọi một dãy gồm toàn số $0$ và $1$ là cân bằng nếu nó chứa $n$ số $0$ và $n$ số $1$. Hai dãy cân bằng $a$ và $b$ được gọi là hàng xóm nếu có thể chuyển vị trí $1$ trong $2n$ ký tự của $a$  để $a$ chuyển thành $b$ (VD: $01101001$ chuyển được thành $00110101$ bằng cách chuyển số $0$ thứ $4$ (hoặc thứ $3$) sang vị trí đầu tiên hoặc thứ $2$). Chứng minh rằng có tập $S$ chứa cùng lắm $\dfrac{1}{n+1}C^n_{2n}$ dãy cân bằng sao cho mọi dãy cân bằng đều bằng với hoặc là hàng xóm với ít nhất một dãy trong $S$.
	\loigiai{
		Vì trong đề bài có đề cập đến số $\dfrac{1}{n+1}C^n_{2n}$  nên ta có ý tưởng là phân chia  $C^n_{2n}$ dãy cân bằng thành $n+1$ lớp, chọn lớp có số phần tử nhỏ nhất (sẽ nhỏ hơn hoặc bằng $\dfrac{1}{n+1}C^n_{2n}$) và chứng minh mọi dãy cân bằng đều thuộc lớp đó hoặc là hàng xóm với $1$ phần tử của lớp đó. Quan trọng nhất ở đây là cách phân lớp sao cho phù hợp. Do có nhận xét là $C^n_{2n}$  chia hết cho $n+1$  nên có thể nghĩ đến cách chia lớp theo kiểu đồng dư modulo $n+1$  thì mỗi lớp có đúng $\dfrac{1}{n+1}C^n_{2n}$  phần tử.	\\
		Quan trọng là xem xét cái gì thay đổi khi chuyển vị trí để dựa vào đó làm căn cứ chia lớp theo modulo $n+1$.\\ 
		Ta hãy bắt đầu với các trường hợp nhỏ lẻ.\\
		Trước hết, nghiên cứu sự thay đổi khi di chuyển một kí tự trong một dãy cân bằng nào đó.\\
		+) Xét $n=3$, ví dụ với dãy ban đầu là $000111$.\\
		Số $0$ từ vị trí thứ $1$ sang vị trí thứ $k$ thì  dãy $000111$ sẽ không đổi nếu $k=2,3$,  thành $001011$ nếu sang vị trí thứ $4$, $001101$ nếu sang vị trí thứ $5$, sang $001110$ nếu sang vị trí số $6$. Vị trí số $1$ có thể được mô tả lại như sau: 
		$$\left( 4, 5, 6\right) \longrightarrow \left( 3, 5, 6\right) \longrightarrow \left( 3, 4, 6\right) \longrightarrow \left( 3, 4, 5\right)$$  
		Nếu dãy ban đầu là $ 000111$ và di chuyển số $1$.\\
		Di chuyển số $1$ từ vị trí cuối cùng sang vị trí thứ $k$, thì với $k=5,4$ vẫn không có gì thay đổi\\
		$k=3$ thì được dãy $001011$; $k=2$ được $010011$; $k=1$ được $100011$.\\
		Vị trí số $1$ như sau: 
		$$\left( 4, 5, 6\right) \longrightarrow \left( 3, 5, 6\right) \longrightarrow \left( 2, 5, 6\right) \longrightarrow \left( 1, 5, 6\right)$$ 
		Di chuyển số $1$ từ vị trí thứ $5$ sang vị trí thứ $4$ hoặc $6$, không có gì thay đổi, sang vị trí thứ $3$, ta được $001011$, thứ $2$ được $010011$, sang vị trí thứ $1$ được $100011$, các vị trí thay đổi như sau:  	
		$$\left( 4, 5, 6\right) \longrightarrow \left( 3, 5, 6\right) \longrightarrow \left( 2, 5, 6\right) \longrightarrow \left( 1, 5, 6\right)$$ 
		Khi đó thì có cái gì thay đổi? Chỉ có vị trí số $1$ trong dãy thay đổi. Xét theo modulo $4$ thì có gì thay đổi theo quy luật? Chỉ có tổng vị trí của số $1$ thay đổi, còn bản thân các số xét theo modulo $3$ thì lại thay đổi không theo quy luật nào cả. \\
		Xét về tổng vị trí của số $1$ thì với việc di chuyển số $0$ với dãy ban đầu, ta thu được các số
		$15,14,13,12$ là $1$ hệ thặng dư đầy đủ modulo $4$.\\
		Với việc di chuyển số $1$, ta thu được các số: $15, 14,13,12$ cũng là hệ thặng dư đầy đủ modulo $4$.\\
		Với việc di chuyển số $1$ theo cách $2$, ta thu được các số tương tự.\\
		Tiếp theo, xem xét kết quả khi $n=2$,  ta có $C^2_4 =6$ dãy sau: $1100; 1010; 1001; 0011; 0101; 0110$, ta thấy: \\
		$1100$ nhận $1010; 1001$ làm hàng xóm, tổng vị trí của số $1$ trong $3$ dãy này là: $3,4,5$.\\
		$0011$ nhận $0101; 0110$ làm hàng xóm, tổng vị trí của số $1$ trong  $3$ dãy là: $7,6,5$.\\
		Xét theo modulo $3$ thì các số trên lập thành hệ thặng dư đầy đủ modulo $3$, nếu chọn tập $S=\left\lbrace 1100; 0011\right\rbrace $ thì $S$ là tập thỏa mãn.\\
		Như vậy, có khả năng ta sẽ chia lớp theo tổng các vị trí của số $1$ trong dãy với modulo $n+1$, tổng quát từ trường hợp $n=2$, ta sẽ chia thành nhiều hệ thặng dư đầy đủ modulo $n+1$, mỗi hệ đó chọn $1$ dãy cân bằng đại diện, và với dãy cân bằng đó, hàng xóm của nó có vẻ như quét thành hệ thặng dư đầy đủ. Như thế, ta chọn mỗi hệ một phần tử theo lớp thặng dư để chia thành $n+1$ lớp, thì nhiều khả năng đó là cách phân lớp thỏa mãn. \\
		Suy nghĩ theo hướng như vậy, cuối cùng, ta có lời giải như sau: \\
		Với mỗi dãy cân bằng $a = \left( a_1, a_2,\ldots, a_{2n}\right) $, xét $f(a)$ là tổng các số $j$ sao cho $a_j = 1$. Ví dụ $f\left( 10010011\right) = 1 +4 + 7 + 8 = 20$. Phân chia $C^n_{2n}$  dãy cân bằng thành $n+1$ lớp $A_i = \left\lbrace a/f(a) \equiv i \pmod{n+1}\right\rbrace , i = 1, 2,\ldots, n+1$. \\
		Gọi $S$ là lớp có số phần tử ít nhất thì $\left| S\right| \leq \dfrac{1}{n+1}C^n_{2n}$.\\
		Ta sẽ chứng minh mọi dãy cân bằng $a$ đều thuộc $S$ hoặc là hàng xóm với một phần tử của $S$. Xét $2$ trường hợp:
		\begin{enumerate}[i)]
			\item Nếu $a_1 = 1$ . Di chuyển số $1$ về phía bên phải của số $0$ thứ $k$, ta thu được dãy cân bằng $b$ là hàng xóm của $a$ với $f(b) = f(a) + k$. Vậy nếu $a\notin S$ thì tồn tại số $k \in \left\lbrace 1, 2,\ldots, n\right\rbrace $  mà  $b \in S$.
			\item Nếu $a_1=0$. Di chuyển số $0$ về phía bên phải số $1$ thứ $k$ thì ta được hàng xóm $b$ của $a$ mà $f(b) = f(a) - k$. Vậy tồn tại $k \in \left\lbrace 1, 2,\ldots, n\right\rbrace $ mà $b \in S$.
		\end{enumerate}	
		Ta có điều phải chứng minh.
	}
\end{bt}


\begin{bt}[IMO Shortlisted $1987$, problem $18$]  %[Nguyễn Minh Hiếu, Dự án EX_TapChi04]%[2D0G2]
	Với mọi số nguyên $r\geq 1$, gọi $h(r)$ là số nguyên nhỏ nhất thỏa mãn $h(r)\geq 1$ và mọi phân hoạch của tập $\{1,2,\hdots,h(r)\}$ thành $r$ lớp, đều tồn tại số nguyên $a\geq 0$ và các số nguyên $x,y:1\leq x\leq y$ sao cho $a+x,a+y,a+x+y$ thuộc cùng một lớp. Chứng minh $h(r)=2r$.
	\loigiai{
		Xét trường hợp đặc biệt nhất, khi $h(r)=2r$, phân tập $\{1,2,\hdots,2r\}$ thành $r$ lớp, mỗi lớp có 2 phần tử thì làm sao có chuyện $a+x,a+y,a+x+y$  (3 phần tử) cùng thuộc 1 lớp được. Phải chăng đề sai? Không! Vấn đề là $x$ và $y$ có thể bằng nhau, khi đó $a+x,a+y,a+x+y$ chỉ nhận 2 giá trị nên không có gì vô lý. Tuy nhiên, điều hay là câu hỏi đó lại là cơ sở giúp ta giải quyết bài toán nhờ phát hiện bản chất của nó. \\	
		*********\\	
		Trước hết, ta chứng minh khi $h(r)=2r$ thì mọi phân hoạch tập $\{1,2,\hdots,2r\}$ thành $r$ lớp đều có một lớp chứa các số $a+x,a+y,a+x+y$ nào đó.\\	
		Thật vậy, xét $r+1$ số $r,r+1,r+2,\hdots,2r$. Vì có $r$ lớp nên tồn tại ít nhất một lớp chứa 2 phần tử. Giả sử $r+i,r+j$ thuộc cùng một lớp với $i<j$. Khi đó, chọn $x=y=j-i,a=r+2i-j$ thì $a+x=r+i,a+y=r+i,a+x+y=r+j$ thuộc cùng một lớp.\\	
		Rõ ràng $1\leq x\leq y$ và $a\geq 0$.\\	
		Vậy $h(r)=2r$ thỏa mãn.\\	
		Nếu $h(r)<2r$ thì xét tập $\{1,2,\hdots,2r-t\}$. Phân hoạch tập này thành $r$ tập $\{1,r+1\};\{2,r+2\};\hdots;\{r-t,2r-t\};\{r-t+1\};\{r-t+2\},\hdots,\{r\}$. Khi đó, giả sử $a+x, a+y, a+x+y$ thuộc cùng một tập. Do $ a + x, a + y, a + x + y $ không cùng bằng nhau nên chúng phải thuộc một trong $r-t$ tập đầu tiên. Như vậy $x=y$ và $a+x,a+2x$ thuộc cùng một tập, giả sử $a+x=k,a+2x=r+k\ (k\leq r-t)$ thì $a=r,a=k-r<0$. Mâu thuẫn.\\	
		Vậy $h(r)\geq 2r$ nên $\min h(r)=2r$.
		\begin{nx}
			Điểm mấu chốt của bài toán nảy sinh từ việc: khi $a=y,a+x,a+x+y=a+2x$  thuộc cùng một lớp. Mà $a+x<a+2x<2a+2x$ nên có những cách phân hoạch như trong lời giải trên.
		\end{nx}
	}
\end{bt}


\begin{bt} %[Nguyễn Minh Hiếu, Dự án EX_TapChi04]%[2D0G2]
	Cho các số nguyên dương $n_1,n_2,\hdots,n_6$ và $n(f)=n_1n_{f(1)}+n_2n_{f(2)}+\cdots+n_6n_{f(6)}$, trong đó $f$ là hoán vị của $\{1,2,\hdots,6\}$. Đặt $\Omega=\big\{n(f): f \text{ là hoán của  }\{1,2,\hdots,6\}\big\}$. Tìm giá trị lớn nhất số phần tử của  $\Omega$.
	\loigiai{
		
		\begin{bode}Nếu $2^{x_1}+2^{x_2}+\cdots+2^{x_n}=2^{y_1}+2^{y_2}+\cdots+2^{y_n}$ với $x_1,x_2,\hdots,x_n$ là các số nguyên dương phân biệt và $y_1,y_2,\hdots,y_n$ là các số nguyên dương phân biệt thì $\{x_1,x_2,\hdots,x_n\}=\{y_1,y_2,\hdots,y_n\}$.
			
			\begin{center}
				(Một số nguyên dương có biểu diễn duy nhất trong hệ cơ số 2)
			\end{center}
		\end{bode}
		Ta xét $n_i=2^{2^i}$. Khi đó \begin{align*}
			n(f)=n(g)&\Leftrightarrow \sum\limits_{i=1}^6n_in_{f(i)}=\sum\limits_{i=1}^6n_in_{g(i)}\\
			&\Leftrightarrow \sum\limits_{i=1}^62^{2^i+2^{f(i)}}=\sum\limits_{i=1}^62^{2^i+2^{g(i)}}\\
			&\Leftrightarrow \{2^i+2^{f(i)},i=1,2,\hdots,6\}=\{2^i+2^{g(i)},i=1,2,\hdots,6\}
		\end{align*}
		Khi đó $2^i+2^{f(i)}=2^i+2^{g(i)}$ với $i$ nào đó trong $\{1,2,\hdots,6\}$. \\
		Tức là $\{1,f(1)\}=\{i,g(i)\}$.\\
		Có 2 trường hợp
		
		\begin{enumerate}[i)]
			
			\item $g(i)=1,f(1)=i$ suy ra $f(1)=g^{-1}(1)$.
			
			\item $g(i)=f(1),i=1$ suy ra $f(1)=g(1)$.
		\end{enumerate}
		Vậy $\{f(1),f^{-1}(1)\}=\{g(1),g^{-1}(1)\}$. Tương tự $\{f(i),f^{-1}(i)\}=\{g(i),g^{-1}(i)\}$ với $i=1,2,\hdots,6$.\\
		Bây giờ, xét 1 hoán vị $f$ bất kỳ, ta sẽ xem xét số các hoán vị $g$ sao cho $n(f)=n(g)$, từ đó đếm số giá trị mà $n(f)$ có thể nhận được.\\
		\textbf{Ví dụ:} $f=(3,4,1,6,5,2)$ thì $f(1)=3,f(3)=1$ nên nếu $n(f)=n(g)$ thì $ g(1) \in \{f(1),f^{-1}(1) \} = \{3\}$ nên $g(1)=3$, tương tự $g^{-1}(1)=3$ nên $g(3)=1,g(5)=5$.\\
		Còn lại $g^{-1}(2),g(2)\in\{f(2)=4,f^{-1}(2)=6\}$, tức là $g(2)\neq 2$ và $g^{-1}(2)\neq 2$, nên $\{g(2),g(4),g(6)\} = \{2,4,6\}$. Từ đó $g(2)=4,g(4)=2,g(6)=6$ hoặc $g(2)=4,g(6)=2,g(4)=6$ hoặc $g(2)=6,g(4)=2,g(6)=4$ hoặc $g(2)=6,g(6)=2,g(4)=4$. Nhưng nếu $g(6)=6$ thì $f(6)=6$ (mâu thuẫn) hoặc $g(4)=4$ thì $f(4)=4$ (mâu thuẫn).\\
		Vậy $g(2)=4,g(4)=6, g(6)=4$ ($g$ trùng $f$) hoặc $g(2)=6,g(6)=4,g(4)=2$.\\
		Như vậy, có thêm một hoán vị $g$ mà $n(g)=n(f)$ nên 2 hoán vị này, kể cả $f$ chỉ cho một giá trị $n(f)$.\\
		\textit{Ta sẽ tổng quát hóa bài toán từ ví dụ trên.}\\
		Ta gọi $C$ là một vòng xích của $f$ có độ dài $k$ nếu tồn tại $a\in \{1,2,\hdots,6\}$ sao cho $$C=\{f(a),f_2(a),f_3(a),\hdots,f_k(a)=a\}$$ và $f_i(a)\neq f_j(a),\forall i\neq j,1\leq i,j\leq k$.
		Khi đó, một hoán vị $f$ bất kỳ luôn phân tích được thành các vòng xích.\\
		Khi $f$ có các vòng xích độ dài $x_1,x_2,\hdots,x_m$, ta nói $f$ là hoán vị loại $x_1+x_2+\cdots+x_m$.\\
		Chẳng hạn, $f=(3,4,1,6,5,2)$ thì $f$ có các vòng xích là $\{f(1)=3,f(3)=f_2(1)=1\}$ có độ dài 2 và $\{ f(2)=4,f_2(2)=f(4)=6,f_3(2)=f(6)=2 \}$ có độ dài 3, $\{f(5)=5\}$ có độ dài 1.\\
		Khi đó, ta viết $f=(2,4,6)(1,3)(5)$, rõ ràng cách viết này hoàn toàn xác định hoán vị $f$ như trên.\\
		Ví dụ $f=(3,4,1,6,5,2)$ là hoán vị loại $3+2+1$.\\
		Bằng cách tường minh như trong ví dụ về hoán vị loại $3+2+1$ ở trên với các loại hoán vị khác, ta có kết quả được thể hiện trên bảng sau. (chú ý rằng 1 hoán vị của tập $\{1,2,\hdots,6\}$ chỉ có thể thuộc một trong các loại sau: $3+1+1+1; 3+2+1,3+3; 4+1+1; 4+2; 5+1; 6$ các hoán vị không có vòng xích nào có độ dài lớn hơn 2)
		
		\begin{center}
			\begin{tabular}{|c|c|c|c|}
				\hline
				\textbf{Loại hoán vị}&\textbf{Số hoán vị $f$}&\textbf{Số lần lặp giá trị $n(f)$}&\textbf{Số giá trị $n(f)$}\\ \hline
				$3+1+1+1$&$\mathrm{C}_6^3.2!=40$&$2$&$20$\\ \hline
				$3+2+1$&$\mathrm{C}_6^3.2!.\mathrm{C}_3^2=120$&$2$&$60$\\ \hline
				$3+3$&$\mathrm{C}_6^3.2!=40$&$4$&$10$\\ \hline
				$4+1+1$&$\mathrm{C}_6^4.3!=90$&$2$&$45$\\ \hline
				$4+2$&$\mathrm{C}_6^4.3!=90$&$2$&$45$\\ \hline
				$5+1$&$\mathrm{C}_6^5.4!=144$&$2$&$72$\\ \hline
				$6$&$5!=120$&$2$&$60$\\ \hline
				Còn lại&$76$&$76$&$76$\\ \hline
			\end{tabular}
		\end{center}
		Vậy nhiều nhất có $388$ giá trị có thể có của tập $\Omega$ khi $n=2^{2^i}$.\\
		Còn lại là chỉ ra khi $n=2^{2^i}$ thì số lần lặp là ít nhất. Điều này dễ dàng vì với các giá trị $n_i$ khác, ngoài việc lặp như trên, còn có thêm khả năng bị lặp do các yếu tố khác nữa.\\ Vậy  $\max \left| \Omega \right| =388$.
	}
\end{bt}


\begin{bt}%[Nguyễn Đức Dũng,Dự án EX_TapChi04]%[1D0G6]
	Với $n$ là số nguyên dương tùy ý, $n>3$, xét $k=\left[\frac{1}{6}n(n+1)\right]$ và tập $X_n$ gồm $\frac{n(n+1)}{2}$ phần tử, trong đó $k$ phần tử màu đỏ, $k$ phần tử màu xanh, còn lại màu trắng. Chứng minh rằng có thể chia tập $X_n$ thành $n$ tập con rời nhau $A_1,A_2,\hdots A_n$ sao cho với số $m$ tùy ý, $1\leq m\leq n$ thì tập $A_m$ chứa đúng $m$ phần tử và các phần tử đó cùng màu.
	
	\loigiai{
		Kiểm tra với $n=4,5,6,7,8,9,10,11$ ta có bảng sau:
		\begin{center}
			\fontsize{9pt}{12pt}
			\selectfont
			\begin{tabular}{|p{2em}|m{2em}|m{2em}|m{3cm}|m{3cm}|m{3cm}|m{2.2cm}|}
				\hline 
				\multirow{2}{2em}{$n$} & \multirow{2}{2em}{$\frac{n(n+1)}{2}$} & \multirow{2}{2em}{$k$} & {Các phần tử} & Các phần tử  & Các phần tử  & {Phân bố màu }\\ 
				&  &  & màu xanh & màu đỏ & màu trắng & (X-Đ-T)\\
				\hline 
				4 & 10 & 3 & $|A_1|=1, |A_2|=2$ & $|A_3|=3$ & $|A_4|=4$ & 3 - 3 - 4 \\ 
				\hline 
				5 & 15 & 5 & $|A_1|=1, |A_4|=4$ & $|A_2|=2, |A_3|=3$ & $|A_5|=5$ & 5 - 5 - 5 \\ 
				\hline 
				6 & 21 & 7 & $|A_1|=1, |A_6|=6$ & $|A_3|=3, |A_4|=4$ & $|A_2|=2, |A_5|=5$ & 7 - 7 - 7 \\ 
				\hline
				\multirow{2}{2em}{7} & \multirow{2}{2em}{28} & \multirow{2}{2em}{9} & \multirow{2}{2.5cm}{$|A_4|=4, |A_5|=5$} & \multirow{2}{2.5cm}{$|A_3|=3, |A_6|=6$} & $|A_1|=1, |A_2|=2$ & \multirow{2}{2cm}{9 - 9 - 10} \\ 
				&  &  &  &  & $|A_7|=7$ & \\ 
				\hline 
				\multirow{2}{2em}{8} & \multirow{2}{2em}{36} & \multirow{2}{2em}{12} & \multirow{2}{2.5cm}{$|A_5|=5, |A_7|=7$} & \multirow{2}{2.5cm}{$|A_4|=4, |A_8|=8$} & $|A_1|=1, |A_2|=2$ & \multirow{2}{2cm}{12 - 12 - 12} \\ 
				&  &  &  &  & $|A_3|=3, |A_6|=6$ & \\ 
				\hline 
				\multirow{3}{2em}{9} & \multirow{3}{2em}{45} & \multirow{3}{2em}{15} & \multirow{3}{2.5cm}{$|A_6|=6, |A_9|=9$} & \multirow{3}{2.5cm}{$|A_7|=7, |A_8|=8$} & $|A_1|=1, |A_2|=2$ & \multirow{3}{2cm}{15 - 15 - 15} \\ 
				&  &  &  &  & $|A_3|=3, |A_4|=4$ & \\
				&  &  &  &  & $|A_5|=5$ & \\
				\hline 
				\multirow{2}{2em}{10} & \multirow{2}{2em}{55} & \multirow{2}{2em}{18} & $|A_1|=1, |A_2|=2$ & $|A_3|=3, |A_6|=6$ & $|A_4|=4,|A_7|=7$ & \multirow{2}{2cm}{18 - 18 - 19} \\ 
				&  &  & $|A_5|=5, |A_{10}|=10$ & $|A_9|=9$ & $|A_8|=8$ & \\
				\hline 
				\multirow{2}{2em}{11} & \multirow{2}{2em}{66} & \multirow{2}{2em}{22} & $|A_1|=1, |A_4|=4$ & $|A_2|=2, |A_3|=3$ & $|A_5|=5, |A_8|=8$ & \multirow{2}{2cm}{22 - 22 - 22} \\ 
				&  &  & $|A_{6}|=6,|A_{11}|=11$ & $|A_7|=7, |A_{10}|={10}$ & $|A_9|=9$ & \\
				\hline 
			\end{tabular} 
		\end{center}
		Để giải bài toán trong trường hợp tổng quát ta cần chỉ ra một cách chia tổng quát hoặc quy được trường hợp $n$ lớn về các trường hợp $n$ nhỏ hơn.
		
		Qua việc nghiên cứu các trường hợp nhỏ lẻ, thấy khá khó có thể tìm được quy luật tổng quát cho việc phân chia. Bởi vậy, ta thử tìm cách đưa các trường hợp sau về những trường hợp trước đó. Các trường hợp $n=5,6,7,8,9$ cũng gần như rất khó được đưa về trường hợp trước. Nhưng với $n=10$ ta có thể đưa về $n=4$, vì số lượng chênh mỗi màu là như nhau, từ $3 \text{-} 3 \text{-} 4$ lên $18 \text{-} 18 \text{-} 19$, tức là chênh đều lên 15 và ta cần có 3 phần, mỗi phần 15 phần tử cùng màu, được chia thành các tập có nhiều hơn hoặc bằng 5 phần tử.
		
		($3 \text{-} 3 \text{-} 4$ lên $9 \text{-} 9 \text{-} 10$ chênh mỗi tập lên 6 phần tử, nhưng mỗi tập đều nhiều hơn 5 phần tử thì không thể làm vậy).
		
		Vậy nguyên nhân có thể đưa được từ trường hợp $n=10$ về trường hợp $n=4$ là vì:
		
		Mỗi tập chênh 15 phần tử, mỗi tập mới có số phần tử $5\leq x\leq 10$ nên có thể chia $15 = 5+10=6+9=7+8$.
		
		Trường hợp $n=5$ (5 - 5 - 5) sang trường hợp (22 - 22 - 22) chênh lên 17 phần tử mỗi tập, số phần tử mỗi tập thuộc $\{6;7;8;9;10;11\}$ mà $17=6+11=7+10=8+9$.
		
		Từ đây, ta có lời giải tổng quát bằng quy nạp với việc xây dựng cách chia tập $X_n$ dựa vào cách chia tập $X_{n-6}$ như sau:
		
		Xét tập $X_n$ gồm $\frac{n(n+1)}{2}$ phần tử. Ta xét tập $X_{n-6}$ gồm $\frac{(n-6)(n-5)}{2}$ phần tử gồm $k_1=\left[\frac{1}{6}(n-6)(n-5)\right]$ phần tử màu xanh, $k_1$ phần tử màu đỏ và còn lại là màu trắng. Theo giả thiết quy nạp, tập $X_{n-6}$ luôn có thể chia thành $n-6$ tập rời nhau $A_1,A_2,\hdots, A_{n-6}$ thỏa mãn bài toán.
		
		Ta có $k-k_1=\left[\frac{n(n+1)}{6}\right]-\left[\frac{(n-6)(n-5)}{6}\right]$. 
		
		Mặt khác $[a]-[b]> a-1-[b]\geq a-1-b$ và $[a]-[b]\leq a-[b]< a-(b-1)=a-b+1$
		
		Nếu $a-b$ là số nguyên thì $[a]- [b] =a-b$. Mà $\frac{n(n+1)}{6}-\frac{(n-6)(n-5)}{6}=2n-5$ là số nguyên nên $k-k_1 =2n-5$. Vậy số phần tử màu xanh (đỏ) ngoài $X_{n-6}$ đều bằng $2n-5$.
		
		Có $|X_n|-|X_{n-6}|=6n-15$ nên số phần tử màu trắng ngoài $X_{n-6}$ là $6n-15-2(2n-5)=2n-5$. Khi đó ta xây dựng các tập $A_{n-5},A_{n-4},A_{n-3},A_{n-2},A_{n-1},A_n$ như sau:
		\begin{itemize}
			\item Tập $A_{n-5},A_n$ chứa toàn phần tử màu xanh.
			\item Tập $A_{n-4},A_n$ chứa toàn phần tử màu đỏ.
			\item Tập $A_{n-2},A_{n-3}$ chứa toàn phần tử màu trắng.
	\end{itemize}}
\end{bt}

\begin{bt}[IMO Shortlisted 2012]%[Nguyễn Đức Dũng,Dự án EX_TapChi04]%[1D0G6]
	Cho $n\geq 1$ là số nguyên, tìm số lớn nhất các tập con rời nhau có hai phần tử của tập $\{1;2;3;\hdots; n\}$ sao cho:
	\begin{enumerate}[i)]
		\item Tổng các phần tử của một tập không vượt quá $n$.
		\item Tổng các phần tử của các tập khác nhau là số nguyên dương khác nhau.
	\end{enumerate}
	
	\loigiai{ 
		Giả sử $k$ là số lớn nhất các tập rời nhau thỏa mãn đề bài. Ví dụ:
		\begin{itemize}
			\item Với $n=3$, có một tập con duy nhất có 2 phần tử mà tổng các phần tử không quá 3 là tập $\{1;2\}$ nên $k=1$ với tập $\{1;2\}$.
			\item Với $n=4$, có hai tập $\{1;2\},\{1;3\}$ thỏa mãn tổng các phần tử không quá 4 nhưng hai tập này không rời nhau nên $k=1$ với tập $\{1;2\}$.
			\item Với $n=5$, có các tập $\{1;2\},\{1;3\},\{1;4\},\{2;3\}$ thỏa mãn nhưng 3 tập đầu có chung phần tử nên chỉ chọn được 1 tập, do đó $k\leq 2$. Nhưng với $k=2$ chỉ có thể chọn được 2 tập $\{2;3\},\{1;4\}$ mà hai tập này có tổng bằng nhau nên cuối cùng $k=1$, với tập $\{1;2\}$
			\item Với $n=6$, trong các tập $\{1;2\},\{1;3\},\{1;4\},\{1;5\}$ chọn được 1 tập; và trong các tập $\{2;3\},\{2;4\}$ chọn được 1 trong 2 tập này. Nên $k=2$ với các tập $\{2;4\},\{1;3\}$ hoặc $\{2;3\},\{1;4\}$ nhưng chỉ cặp $\{2;4\},\{1;3\}$ cho tổng khác nhau. Vậy $k=2$ với các tập $\{2;4\},\{1;3\}$.
			\item  Với $n=7$, trong các tập $\{1;2\},\{1;3\},\{1;4\}, \{1;5\}, \{1;6\}$ chọn được 1 tập. Trong các tập $\{2;3\},\{2;4\},\{2;5\}$ chọn được 1 tập. Với 2 tập được chọn này cùng với tập $\{3;4\}$ nên $k\leq 3$, với các tập $\{3;4\},\{2;5\},\{1;6\}$. Tuy nhiên chỉ chọn được 2 trong 3 tập này do yêu cầu tổng các phần tử khác nhau nên $k\leq 2$. Với $k=2$ có thể chọn 2 tập $\{2;4\},\{1;3\}$. Vậy $k=2$ chọn 2 tập $\{2;4\},\{1;3\}$.
			\item  Với $n=7$, trong các tập $\{1;2\},\{1;3\},\{1;4\}, \{1;5\}, \{1;6\},\{1;7\}$ chọn được 1 tập. Trong các tập $\{2;3\},\{2;4\},\{2;5\},\{2;6\}$ chọn được 1 tập. Trong các tập $\{3;4\},\{3;5\}$ chọn được 1 tập. Vậy với $k=3$ với các tập $\{3;4\},\{2;6\},\{1;2\}$ chẳng hạn.
		\end{itemize}
		Tiếp tục như vậy ta có bảng sau:
		\begin{center}
			\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
				\hline 
				n& 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20 \\
				\hline
				k& 0 & 0 & 1 & 1 & 1 & 2 & 2 & 3 & 3 & 3 & 4 & 4 & 5 & 5 & 5 & 6 & 6 & 7 & 7 & 7\\
				\hline
			\end{tabular}
		\end{center}
		Theo bảng có thể dự đoán quy luật lặp lại theo chu kỳ 5 và với $n=5m+1, n=5m+2$ cho đáp số $k=2m$. Với $n=5m+3, n=5m+4, n=5m+5$ cho đáp số $k=2m+1$. Từ đó ta sẽ nghĩ cách tổng quát để phân hoạch tập $\{1;2;3;\hdots; n\}$ thành các tập có 2 phần tử thỏa mãn đề bài trong từng trường hợp và chỉ ra với số $k$ lớn hơn các số đã định thì không thể phân chia được. Ngoài ra, với hai trường hợp $n=5m+1$ và $n=5m+2$ có thể chọn chung các tập. Vậy chủ yếu làm việc với hai trường hợp $n=5m+1$ và $n=5m+3$. Ta có lời giải sau:
		
		+ Với $n=5m+1$ và $n=5m+2$ ta có thể chọn $2m$ tập gồm:
		\begin{itemize}
			\item $\{1;4m\},\{3;4m-1\},\{5;4m-2\},\hdots,\{2m+1;3m\}$ có $m$ tập.
			\item $\{2;2m\}$ có 1 tập.
			\item $\{4;3m-1\},\{6;3m-3\},\{8;3m-5\},\hdots, \{2m-2;2m+2\}$ có $(m-1)$ tập.
		\end{itemize}
		Ngoài ra nếu $k\geq 2m+1$
		thì tổng $S$ của $k$ cặp đó thỏa mãn:
		$$ S\geq (1+2)+(3+4)+\hdots +(4m+1+4m+2)=(2m+1)(4m+3)$$
		và
		$$ S\leq (5m+2+5m+1)+\hdots +(3m+3+3m+2)=(2m+1)(4m+2)$$ 
		Điều này dẫn đến mâu thuẫn. 
		
		+ Với $n=5m+3, n=5m+4$ và $n=5m+5$ ta có thể chọn $2m+1$ tập gồm:
		\begin{itemize}
			\item $\{1;4m+2\},\{3;4m+3\},\hdots,\{2m+1;3m+2\}$ có $m+1$ tập.
			\item $\{2;3m+1\}, \{4;3m\}, \hdots , \{2m;2m+2\}$ có $m$ tập.
		\end{itemize}
		Ngoài ra nếu $k\geq 2m+2$
		thì tổng $S$ của $k$ cặp đó thỏa mãn:
		$$ S\geq (1+2)+(3+4)+\hdots +(4m+3+4m+4)=(2m+2)(4m+5)$$
		và
		$$ S\leq (5m+5+5m+4)+\hdots +(3m+5+3m+4)=(2m+2)(4m+4)$$ 
		Điều này dẫn đến mâu thuẫn.
		Vậy đáp số cuối cùng là $\left[\frac{2m-1}{5}\right]. $}
\end{bt}

\begin{bt}%[Vũ Văn Trường,Dự án EX_TapChi04]%[1D0G6]
	Tại các đỉnh của một lục giác đều viết $6$ số nguyên không âm có tổng bằng $2013$. Một người thực hiện thay đổi như sau: Chọn $1$ đỉnh, thay số ở đỉnh đó bởi giá trị tuyệt đối của hiệu $2$ số viết ở $2$ đỉnh kề với đỉnh được chọn. Chứng minh rằng, có thể thực hiện như vậy một số lần sao cho các số thu được ở $6$ đỉnh đều bằng $0$.
	\loigiai{
		Đương nhiên muốn giảm các số về $0$ thì tổng các số phải giảm dần.\\
		Xét vài trường hợp cụ thể. Dễ nhất là trường hợp có $3$ số tại $3$ đỉnh xen kẽ bằng $0$, còn lại có tổng bằng $2013$. Khi đó chỉ cần tác động $3$ lần thao tác đã cho tại $3$ đỉnh khác $0$, ta thu được trạng thái $0$.\\
		Nếu có $2$ trong $3$ số tại các đỉnh xen kẽ bằng $0$, ta cũng dễ dàng thu được đáp số, cụ thể
		\begin{center}
			\begin{tikzpicture}[scale=0.85]
			\tkzDefPoints{0/0/O, 1/0/C}
			\tkzDefPointBy[rotation= center O angle 60](C)
			\tkzGetPoint{B}
			\tkzDefPointBy[rotation= center O angle 60](B)
			\tkzGetPoint{A}
			\tkzDefPointBy[rotation= center O angle 60](A)
			\tkzGetPoint{F}
			\tkzDefPointBy[rotation= center O angle 60](F)
			\tkzGetPoint{E}
			\tkzDefPointBy[rotation= center O angle 60](E)
			\tkzGetPoint{D}
			\tkzDrawSegments(A,B B,C C,D D,E E,F F,A)
			\draw(A) node[above]{\footnotesize $A$};
			\draw(B) node[above]{\footnotesize $B$};
			\draw(C) node[right]{\footnotesize $0$};
			\draw(D) node[below]{\footnotesize $D$};
			\draw(E) node[below]{\footnotesize $0$};
			\draw(F) node[left]{\footnotesize $F$};
			%Hình 2
			\coordinate (O1) at ($(O)+(4,0)$);
			\coordinate (C1) at ($(C)+(4,0)$);
			\tkzDefPointBy[rotation= center O1 angle 60](C1)
			\tkzGetPoint{B1}
			\tkzDefPointBy[rotation= center O1 angle 60](B1)
			\tkzGetPoint{A1}
			\tkzDefPointBy[rotation= center O1 angle 60](A1)
			\tkzGetPoint{F1}
			\tkzDefPointBy[rotation= center O1 angle 60](F1)
			\tkzGetPoint{E1}
			\tkzDefPointBy[rotation= center O1 angle 60](E1)
			\tkzGetPoint{D1}
			\tkzDrawSegments(A1,B1 B1,C1 C1,D1 D1,E1 E1,F1 F1,A1)
			\draw(A1) node[above]{\footnotesize $A$};
			\draw(B1) node[above]{\footnotesize $A$};
			\draw(E1) node[below]{\footnotesize $0$};
			\draw(D1) node[below]{\footnotesize $0$};
			\draw(C1) node[right]{\footnotesize $0$};
			\draw(F1) node[left]{\footnotesize $A$};
			%Hình 3
			\coordinate (O2) at ($(O1)+(4,0)$);
			\coordinate (C2) at ($(C1)+(4,0)$);
			\tkzDefPointBy[rotation= center O2 angle 60](C2)
			\tkzGetPoint{B2}
			\tkzDefPointBy[rotation= center O2 angle 60](B2)
			\tkzGetPoint{A2}
			\tkzDefPointBy[rotation= center O2 angle 60](A2)
			\tkzGetPoint{F2}
			\tkzDefPointBy[rotation= center O2 angle 60](F2)
			\tkzGetPoint{E2}
			\tkzDefPointBy[rotation= center O2 angle 60](E2)
			\tkzGetPoint{D2}
			\tkzDrawSegments(A2,B2 B2,C2 C2,D2 D2,E2 E2,F2 F2,A2)
			\draw(A2) node[above]{\footnotesize $0$};
			\draw(B2) node[above]{\footnotesize $A$};
			\draw(E2) node[below]{\footnotesize $0$};
			\draw(D2) node[below]{\footnotesize $0$};
			\draw(C2) node[right]{\footnotesize $0$};
			\draw(F2) node[left]{\footnotesize $A$};
			%Hình 4
			\coordinate (O3) at ($(O2)+(4,0)$);
			\coordinate (C3) at ($(C2)+(4,0)$);
			\tkzDefPointBy[rotation= center O3 angle 60](C3)
			\tkzGetPoint{B3}
			\tkzDefPointBy[rotation= center O3 angle 60](B3)
			\tkzGetPoint{A3}
			\tkzDefPointBy[rotation= center O3 angle 60](A3)
			\tkzGetPoint{F3}
			\tkzDefPointBy[rotation= center O3 angle 60](F3)
			\tkzGetPoint{E3}
			\tkzDefPointBy[rotation= center O3 angle 60](E3)
			\tkzGetPoint{D3}
			\tkzDrawSegments(A3,B3 B3,C3 C3,D3 D3,E3 E3,F3 F3,A3)
			\draw(A3) node[above]{\footnotesize $0$};
			\draw(B3) node[above]{\footnotesize $0$};
			\draw(E3) node[below]{\footnotesize $0$};
			\draw(D3) node[below]{\footnotesize $0$};
			\draw(C3) node[right]{\footnotesize $0$};
			\draw(F3) node[left]{\footnotesize $0$};
			\draw[->] (1.5,0)--(2.5,0); \draw[->](5.5,0)--(6.5,0); \draw[->](9.5,0)--(10.5,0);
			\tkzDrawPoints(A,B,C,D,E,F,A1,B1,C1,D1,E1,F1,A2,B2,C2,D2,E2,F2,A3,B3,C3,D3,E3,F3)
			\end{tikzpicture}
		\end{center}
		Ngoài ra, các số tại các đỉnh chỉ phụ thuộc vào các số tại $3$ đỉnh chỉ sau $1$ phép biến đổi, nên ta sẽ chỉ xem xét chủ yếu sự biến đổi dựa trên $3$ số tại $3$ đỉnh,chẳng hạn theo dõi sự biến đổi khi $A\geq C\geq E$ như sau
		\begin{center}
			\begin{tikzpicture}[scale=0.85]
			\tkzDefPoints{0/0/O, 1/0/C}
			\tkzDefPointBy[rotation= center O angle 60](C)
			\tkzGetPoint{B}
			\tkzDefPointBy[rotation= center O angle 60](B)
			\tkzGetPoint{A}
			\tkzDefPointBy[rotation= center O angle 60](A)
			\tkzGetPoint{F}
			\tkzDefPointBy[rotation= center O angle 60](F)
			\tkzGetPoint{E}
			\tkzDefPointBy[rotation= center O angle 60](E)
			\tkzGetPoint{D}
			\tkzDrawSegments(A,B B,C C,D D,E E,F F,A)
			\draw(A) node[above left=-0.1]{\footnotesize $C-E$};
			\draw(B) node[above right=-0.1]{\footnotesize $A-C$};
			\draw(C) node[right]{\footnotesize $C$};
			\draw(D) node[below right=-0.1]{\footnotesize $C-E$};
			\draw(E) node[below left=-0.1]{\footnotesize $A-C$};
			\draw(F) node[left]{\footnotesize $A-E$};
			%Hình 2
			\coordinate (O1) at ($(O)+(5,3)$);
			\coordinate (C1) at ($(C)+(5,3)$);
			\tkzDefPointBy[rotation= center O1 angle 60](C1)
			\tkzGetPoint{B1}
			\tkzDefPointBy[rotation= center O1 angle 60](B1)
			\tkzGetPoint{A1}
			\tkzDefPointBy[rotation= center O1 angle 60](A1)
			\tkzGetPoint{F1}
			\tkzDefPointBy[rotation= center O1 angle 60](F1)
			\tkzGetPoint{E1}
			\tkzDefPointBy[rotation= center O1 angle 60](E1)
			\tkzGetPoint{D1}
			\tkzDrawSegments(A1,B1 B1,C1 C1,D1 D1,E1 E1,F1 F1,A1)
			\draw(A1) node[above left=-0.1]{\footnotesize $C-E$};
			\draw(B1) node[above right=-0.1]{\footnotesize $A-C$};
			\draw(C1) node[right]{\footnotesize $C$};
			\draw(D1) node[below right=-0.1]{\footnotesize $C-E$};
			\draw(E1) node[below]{\footnotesize $E$};
			\draw(F1) node[left]{\footnotesize $A-E$};
			%Hình 3
			\coordinate (O2) at ($(O)+(5,-3)$);
			\coordinate (C2) at ($(C)+(5,-3)$);
			\tkzDefPointBy[rotation= center O2 angle 60](C2)
			\tkzGetPoint{B2}
			\tkzDefPointBy[rotation= center O2 angle 60](B2)
			\tkzGetPoint{A2}
			\tkzDefPointBy[rotation= center O2 angle 60](A2)
			\tkzGetPoint{F2}
			\tkzDefPointBy[rotation= center O2 angle 60](F2)
			\tkzGetPoint{E2}
			\tkzDefPointBy[rotation= center O2 angle 60](E2)
			\tkzGetPoint{D2}
			\tkzDrawSegments(A2,B2 B2,C2 C2,D2 D2,E2 E2,F2 F2,A2)
			\draw(A2) node[above]{\footnotesize $A$};
			\draw(B2) node[above right=-0.1]{\footnotesize $A-C$};
			\draw(C2) node[right]{\footnotesize $C$};
			\draw(D2) node[below right=-0.1]{\footnotesize $C-E$};
			\draw(E2) node[below left=-0.1]{\footnotesize $A-C$};
			\draw(F2) node[left]{\footnotesize $A-E$};
			%Hình 4
			\coordinate (O3) at ($(O)+(6.5,0)$);
			\coordinate (C3) at ($(C)+(6.5,0)$);
			\tkzDefPointBy[rotation= center O3 angle 60](C3)
			\tkzGetPoint{B3}
			\tkzDefPointBy[rotation= center O3 angle 60](B3)
			\tkzGetPoint{A3}
			\tkzDefPointBy[rotation= center O3 angle 60](A3)
			\tkzGetPoint{F3}
			\tkzDefPointBy[rotation= center O3 angle 60](F3)
			\tkzGetPoint{E3}
			\tkzDefPointBy[rotation= center O3 angle 60](E3)
			\tkzGetPoint{D3}
			\tkzDrawSegments(A3,B3 B3,C3 C3,D3 D3,E3 E3,F3 F3,A3)
			\draw(A3) node[above]{\footnotesize $A$};
			\draw(B3) node[above right=-0.1]{\footnotesize $A-C$};
			\draw(C3) node[right]{\footnotesize $C$};
			\draw(D3) node[below right=-0.1]{\footnotesize $C-E$};
			\draw(E3) node[below]{\footnotesize $E$};
			\draw(F3) node[left]{\footnotesize $A-E$};
			%Hình 4
			\coordinate (O4) at ($(O)+(11,0)$);
			\coordinate (C4) at ($(C)+(11,0)$);
			\tkzDefPointBy[rotation= center O4 angle 60](C4)
			\tkzGetPoint{B4}
			\tkzDefPointBy[rotation= center O4 angle 60](B4)
			\tkzGetPoint{A4}
			\tkzDefPointBy[rotation= center O4 angle 60](A4)
			\tkzGetPoint{F4}
			\tkzDefPointBy[rotation= center O4 angle 60](F4)
			\tkzGetPoint{E4}
			\tkzDefPointBy[rotation= center O4 angle 60](E4)
			\tkzGetPoint{D4}
			\tkzDrawSegments(A4,B4 B4,C4 C4,D4 D4,E4 E4,F4 F4,A4)
			\draw(A4) node[above]{\footnotesize $A$};
			\draw(B4) node[above right=-0.1]{\footnotesize $A-C$};
			\draw(C4) node[right]{\footnotesize $|A+E-2C|$};
			\draw(D4) node[below right=-0.1]{\footnotesize $C-E$};
			\draw(E4) node[below]{\footnotesize $E$};
			\draw(F4) node[below left]{\footnotesize $A-E$};
			\draw[->] (4.25,2)--(-0.25,-0.75); \draw[->] (4.25,-2)--(-0.25,0.75); \draw[->] (6,1.2)--(4.5,3.75); \draw[->] (5.8,-1.3)--(4.65,-3.75); \draw[->] (8,0)--(12.25,0); \draw[->] (-2.25,0)--(-3,0);
			\fill(-3.5,0) circle(1.5pt);\fill(-3.25,0) circle(1.5pt);\fill(-3.75,0) circle(1.5pt);\fill(15,0) circle(1.5pt);\fill(15.5,0) circle(1.5pt);\fill(15.25,0) circle(1.5pt);
			\tkzDrawPoints(A,B,C,D,E,F,A1,B1,C1,D1,E1,F1,A2,B2,C2,D2,E2,F2,A3,B3,C3,D3,E3,F3,A4,B4,C4,D4,E4,F4)
			\end{tikzpicture}
		\end{center}
		Ta thấy có phép biến đổi
		\begin{center}
			\begin{tikzpicture}[scale=0.85]
			\tkzDefPoints{0/0/O, 1/0/C}
			\tkzDefPointBy[rotation= center O angle 60](C)
			\tkzGetPoint{B}
			\tkzDefPointBy[rotation= center O angle 60](B)
			\tkzGetPoint{A}
			\tkzDefPointBy[rotation= center O angle 60](A)
			\tkzGetPoint{F}
			\tkzDefPointBy[rotation= center O angle 60](F)
			\tkzGetPoint{E}
			\tkzDefPointBy[rotation= center O angle 60](E)
			\tkzGetPoint{D}
			\tkzDrawSegments(A,B B,C C,D D,E E,F F,A)
			\draw(A) node[above left=-0.1]{\footnotesize $A$};
			\draw(B) node[above right=-0.1]{\footnotesize $B$};
			\draw(C) node[right]{\footnotesize $C$};
			\draw(D) node[below right=-0.1]{\footnotesize $D$};
			\draw(E) node[below left=-0.1]{\footnotesize $E$};
			\draw(F) node[left]{\footnotesize $F$};
			%Hình 2
			\coordinate (O1) at ($(O)+(6,0)$);
			\coordinate (C1) at ($(C)+(6,0)$);
			\tkzDefPointBy[rotation= center O1 angle 60](C1)
			\tkzGetPoint{B1}
			\tkzDefPointBy[rotation= center O1 angle 60](B1)
			\tkzGetPoint{A1}
			\tkzDefPointBy[rotation= center O1 angle 60](A1)
			\tkzGetPoint{F1}
			\tkzDefPointBy[rotation= center O1 angle 60](F1)
			\tkzGetPoint{E1}
			\tkzDefPointBy[rotation= center O1 angle 60](E1)
			\tkzGetPoint{D1}
			\tkzDrawSegments(A1,B1 B1,C1 C1,D1 D1,E1 E1,F1 F1,A1)
			\draw(A1) node[above left=-0.1]{\footnotesize $A$};
			\draw(B1) node[above right=-0.1]{\footnotesize $A-C$};
			\draw(C1) node[right]{\footnotesize $C$};
			\draw(D1) node[below right=-0.1]{\footnotesize $C-E$};
			\draw(E1) node[below]{\footnotesize $E$};
			\draw(F1) node[left]{\footnotesize $A-E$};
			%Hình 3
			\coordinate (O2) at ($(O)+(12,0)$);
			\coordinate (C2) at ($(C)+(12,0)$);
			\tkzDefPointBy[rotation= center O2 angle 60](C2)
			\tkzGetPoint{B2}
			\tkzDefPointBy[rotation= center O2 angle 60](B2)
			\tkzGetPoint{A2}
			\tkzDefPointBy[rotation= center O2 angle 60](A2)
			\tkzGetPoint{F2}
			\tkzDefPointBy[rotation= center O2 angle 60](F2)
			\tkzGetPoint{E2}
			\tkzDefPointBy[rotation= center O2 angle 60](E2)
			\tkzGetPoint{D2}
			\tkzDrawSegments(A2,B2 B2,C2 C2,D2 D2,E2 E2,F2 F2,A2)
			\draw(A2) node[above left=-0.1]{\footnotesize $C-E$};
			\draw(B2) node[above right=-0.1]{\footnotesize $A-C$};
			\draw(C2) node[right]{\footnotesize $C$};
			\draw(D2) node[below right=-0.1]{\footnotesize $C-E$};
			\draw(E2) node[below left=-0.1]{\footnotesize $A-C$};
			\draw(F2) node[left]{\footnotesize $A-E$};
			\draw[->] (2,0)--(3.5,0); \draw[->](8,0)--(9.5,0);
			\tkzDrawPoints(A,B,C,D,E,F,A1,B1,C1,D1,E1,F1,A2,B2,C2,D2,E2,F2)
			\end{tikzpicture}
		\end{center}
		làm giảm tính lẻ của tổng $A+C+E$ nếu không có số nào bằng $0$, là một phép biến đổi đáng lưu ý.
		Từ đây đặt ra câu hỏi: Khi có $1$ số bằng $0$ thì có đưa về trường hợp $2$ số bằng $0$ được $0$, không có số nào bằng $0$ thì thế nào? Trả lời các câu hỏi đó và xem xét biến đổi cụ thể trên, ta có lời giải sau:\\
		Trước hết, tồn tại $3$ đỉnh xen kẽ sao cho tổng là số lẻ (bài toán chỉ sử dụng tính lẻ của số $2013$ nên có thể tổng quát $2013$ thành số $n$ lẻ bất kỳ), giả sử $3$ đỉnh đó là $A, C, E$ ( được điền các số $A,C,E$ luôn)\\
		+ $A\geq C\geq E>0$. Xét biến đổi sau\\
		\begin{center}
			\begin{tikzpicture}[scale=0.85]
			\tkzDefPoints{0/0/O, 1/0/C}
			\tkzDefPointBy[rotation= center O angle 60](C)
			\tkzGetPoint{B}
			\tkzDefPointBy[rotation= center O angle 60](B)
			\tkzGetPoint{A}
			\tkzDefPointBy[rotation= center O angle 60](A)
			\tkzGetPoint{F}
			\tkzDefPointBy[rotation= center O angle 60](F)
			\tkzGetPoint{E}
			\tkzDefPointBy[rotation= center O angle 60](E)
			\tkzGetPoint{D}
			\tkzDrawSegments(A,B B,C C,D D,E E,F F,A)
			\draw(A) node[above left=-0.1]{\footnotesize $A$};
			\draw(B) node[above right=-0.1]{\footnotesize $B$};
			\draw(C) node[right]{\footnotesize $C$};
			\draw(D) node[below right=-0.1]{\footnotesize $D$};
			\draw(E) node[below left=-0.1]{\footnotesize $E$};
			\draw(F) node[left]{\footnotesize $F$};
			%Hình 2
			\coordinate (O1) at ($(O)+(6,0)$);
			\coordinate (C1) at ($(C)+(6,0)$);
			\tkzDefPointBy[rotation= center O1 angle 60](C1)
			\tkzGetPoint{B1}
			\tkzDefPointBy[rotation= center O1 angle 60](B1)
			\tkzGetPoint{A1}
			\tkzDefPointBy[rotation= center O1 angle 60](A1)
			\tkzGetPoint{F1}
			\tkzDefPointBy[rotation= center O1 angle 60](F1)
			\tkzGetPoint{E1}
			\tkzDefPointBy[rotation= center O1 angle 60](E1)
			\tkzGetPoint{D1}
			\tkzDrawSegments(A1,B1 B1,C1 C1,D1 D1,E1 E1,F1 F1,A1)
			\draw(A1) node[above left=-0.1]{\footnotesize $A$};
			\draw(B1) node[above right=-0.1]{\footnotesize $A-C$};
			\draw(C1) node[right]{\footnotesize $C$};
			\draw(D1) node[below right=-0.1]{\footnotesize $C-E$};
			\draw(E1) node[below]{\footnotesize $E$};
			\draw(F1) node[left]{\footnotesize $A-E$};
			%Hình 3
			\coordinate (O2) at ($(O)+(12,0)$);
			\coordinate (C2) at ($(C)+(12,0)$);
			\tkzDefPointBy[rotation= center O2 angle 60](C2)
			\tkzGetPoint{B2}
			\tkzDefPointBy[rotation= center O2 angle 60](B2)
			\tkzGetPoint{A2}
			\tkzDefPointBy[rotation= center O2 angle 60](A2)
			\tkzGetPoint{F2}
			\tkzDefPointBy[rotation= center O2 angle 60](F2)
			\tkzGetPoint{E2}
			\tkzDefPointBy[rotation= center O2 angle 60](E2)
			\tkzGetPoint{D2}
			\tkzDrawSegments(A2,B2 B2,C2 C2,D2 D2,E2 E2,F2 F2,A2)
			\draw(A2) node[above left=-0.1]{\footnotesize $C-E$};
			\draw(B2) node[above right=-0.1]{\footnotesize $A-C$};
			\draw(C2) node[right]{\footnotesize $C$};
			\draw(D2) node[below right=-0.1]{\footnotesize $C-E$};
			\draw(E2) node[below left=-0.1]{\footnotesize $A-C$};
			\draw(F2) node[left]{\footnotesize $A-E$};
			\draw[->] (2,0)--(3.5,0); \draw[->](8,0)--(9.5,0);
			\tkzDrawPoints(A,B,C,D,E,F,A1,B1,C1,D1,E1,F1,A2,B2,C2,D2,E2,F2)
			\end{tikzpicture}
		\end{center}
		Ta thấy phép biến đổi này làm giảm tổng $A+C+E$ thành $(C-E)+C+(A-C)=A+C-E$ và vẫn giữ nguyên tính lẻ của tổng nếu $E$ khác $0$, vậy nếu áp dụng liên tiếp thao tác này, sẽ đi đến trạng thái mà $1$ trong $3$ số $A,C,E$ bằng $0$ hoặc $2$ trong $3$ số bằng $0$\\
		+ Nếu có $2$ trong $3$ số $A,C,E$ bằng $0$. Giả sử $A>C=E=0$, xét phép biến đổi
		\begin{center}
			\begin{tikzpicture}[scale=0.85]
			\tkzDefPoints{0/0/O, 1/0/C}
			\tkzDefPointBy[rotation= center O angle 60](C)
			\tkzGetPoint{B}
			\tkzDefPointBy[rotation= center O angle 60](B)
			\tkzGetPoint{A}
			\tkzDefPointBy[rotation= center O angle 60](A)
			\tkzGetPoint{F}
			\tkzDefPointBy[rotation= center O angle 60](F)
			\tkzGetPoint{E}
			\tkzDefPointBy[rotation= center O angle 60](E)
			\tkzGetPoint{D}
			\tkzDrawSegments(A,B B,C C,D D,E E,F F,A)
			\draw(A) node[above left=-0.1]{\footnotesize $A$};
			\draw(B) node[above right=-0.1]{\footnotesize $B$};
			\draw(C) node[right]{\footnotesize $0$};
			\draw(D) node[below right=-0.1]{\footnotesize $D$};
			\draw(E) node[below left=-0.1]{\footnotesize $0$};
			\draw(F) node[left]{\footnotesize $F$};
			%Hình 2
			\coordinate (O1) at ($(O)+(5,0)$);
			\coordinate (C1) at ($(C)+(5,0)$);
			\tkzDefPointBy[rotation= center O1 angle 60](C1)
			\tkzGetPoint{B1}
			\tkzDefPointBy[rotation= center O1 angle 60](B1)
			\tkzGetPoint{A1}
			\tkzDefPointBy[rotation= center O1 angle 60](A1)
			\tkzGetPoint{F1}
			\tkzDefPointBy[rotation= center O1 angle 60](F1)
			\tkzGetPoint{E1}
			\tkzDefPointBy[rotation= center O1 angle 60](E1)
			\tkzGetPoint{D1}
			\tkzDrawSegments(A1,B1 B1,C1 C1,D1 D1,E1 E1,F1 F1,A1)
			\draw(A1) node[above left=-0.1]{\footnotesize $A$};
			\draw(B1) node[above right=-0.1]{\footnotesize $A$};
			\draw(C1) node[right]{\footnotesize $0$};
			\draw(D1) node[below right=-0.1]{\footnotesize $0$};
			\draw(E1) node[below]{\footnotesize $0$};
			\draw(F1) node[left]{\footnotesize $A$};
			%Hình 3
			\coordinate (O2) at ($(O)+(10,0)$);
			\coordinate (C2) at ($(C)+(10,0)$);
			\tkzDefPointBy[rotation= center O2 angle 60](C2)
			\tkzGetPoint{B2}
			\tkzDefPointBy[rotation= center O2 angle 60](B2)
			\tkzGetPoint{A2}
			\tkzDefPointBy[rotation= center O2 angle 60](A2)
			\tkzGetPoint{F2}
			\tkzDefPointBy[rotation= center O2 angle 60](F2)
			\tkzGetPoint{E2}
			\tkzDefPointBy[rotation= center O2 angle 60](E2)
			\tkzGetPoint{D2}
			\tkzDrawSegments(A2,B2 B2,C2 C2,D2 D2,E2 E2,F2 F2,A2)
			\draw(A2) node[above left=-0.1]{\footnotesize $0$};
			\draw(B2) node[above right=-0.1]{\footnotesize $A$};
			\draw(C2) node[right]{\footnotesize $0$};
			\draw(D2) node[below right=-0.1]{\footnotesize $0$};
			\draw(E2) node[below left=-0.1]{\footnotesize $0$};
			\draw(F2) node[left]{\footnotesize $A$};
			%Hình 3
			\coordinate (O3) at ($(O)+(15,0)$);
			\coordinate (C3) at ($(C)+(15,0)$);
			\tkzDefPointBy[rotation= center O3 angle 60](C3)
			\tkzGetPoint{B3}
			\tkzDefPointBy[rotation= center O3 angle 60](B3)
			\tkzGetPoint{A3}
			\tkzDefPointBy[rotation= center O3 angle 60](A3)
			\tkzGetPoint{F3}
			\tkzDefPointBy[rotation= center O3 angle 60](F3)
			\tkzGetPoint{E3}
			\tkzDefPointBy[rotation= center O3 angle 60](E3)
			\tkzGetPoint{D3}
			\tkzDrawSegments(A3,B3 B3,C3 C3,D3 D3,E3 E3,F3 F3,A3)
			\draw(A3) node[above left=-0.1]{\footnotesize $0$};
			\draw(B3) node[above right=-0.1]{\footnotesize $0$};
			\draw(C3) node[right]{\footnotesize $0$};
			\draw(D3) node[below right=-0.1]{\footnotesize $0$};
			\draw(E3) node[below left=-0.1]{\footnotesize $0$};
			\draw(F3) node[left]{\footnotesize $0$};
			\draw[->] (2,0)--(3,0); \draw[->](7,0)--(8,0); \draw[->](12,0)--(13,0);
			\tkzDrawPoints(A,B,C,D,E,F,A1,B1,C1,D1,E1,F1,A2,B2,C2,D2,E2,F2,A3,B3,C3,D3,E3,F3)
			\end{tikzpicture}
		\end{center}
		Ta thu được trạng thái toàn số 0
		+ $A\geq C> E=0$, thì do $A$ lẻ nên $A>C$, xét phép biến đổi
		\begin{center}
			\begin{tikzpicture}[scale=0.85]
			\tkzDefPoints{0/0/O, 1/0/C}
			\tkzDefPointBy[rotation= center O angle 60](C)
			\tkzGetPoint{B}
			\tkzDefPointBy[rotation= center O angle 60](B)
			\tkzGetPoint{A}
			\tkzDefPointBy[rotation= center O angle 60](A)
			\tkzGetPoint{F}
			\tkzDefPointBy[rotation= center O angle 60](F)
			\tkzGetPoint{E}
			\tkzDefPointBy[rotation= center O angle 60](E)
			\tkzGetPoint{D}
			\tkzDrawSegments(A,B B,C C,D D,E E,F F,A)
			\draw(A) node[above left=-0.1]{\footnotesize $A$};
			\draw(B) node[above right=-0.1]{\footnotesize $B$};
			\draw(C) node[right]{\footnotesize $C$};
			\draw(D) node[below right=-0.1]{\footnotesize $D$};
			\draw(E) node[below left=-0.1]{\footnotesize $0$};
			\draw(F) node[left]{\footnotesize $F$};
			%Hình 2
			\coordinate (O1) at ($(O)+(6,0)$);
			\coordinate (C1) at ($(C)+(6,0)$);
			\tkzDefPointBy[rotation= center O1 angle 60](C1)
			\tkzGetPoint{B1}
			\tkzDefPointBy[rotation= center O1 angle 60](B1)
			\tkzGetPoint{A1}
			\tkzDefPointBy[rotation= center O1 angle 60](A1)
			\tkzGetPoint{F1}
			\tkzDefPointBy[rotation= center O1 angle 60](F1)
			\tkzGetPoint{E1}
			\tkzDefPointBy[rotation= center O1 angle 60](E1)
			\tkzGetPoint{D1}
			\tkzDrawSegments(A1,B1 B1,C1 C1,D1 D1,E1 E1,F1 F1,A1)
			\draw(A1) node[above left=-0.1]{\footnotesize $A$};
			\draw(B1) node[above right=-0.1]{\footnotesize $A-C$};
			\draw(C1) node[right]{\footnotesize $C$};
			\draw(D1) node[below right=-0.1]{\footnotesize $C$};
			\draw(E1) node[below]{\footnotesize $0$};
			\draw(F1) node[left]{\footnotesize $A$};
			%Hình 3
			\coordinate (O2) at ($(O)+(12,0)$);
			\coordinate (C2) at ($(C)+(12,0)$);
			\tkzDefPointBy[rotation= center O2 angle 60](C2)
			\tkzGetPoint{B2}
			\tkzDefPointBy[rotation= center O2 angle 60](B2)
			\tkzGetPoint{A2}
			\tkzDefPointBy[rotation= center O2 angle 60](A2)
			\tkzGetPoint{F2}
			\tkzDefPointBy[rotation= center O2 angle 60](F2)
			\tkzGetPoint{E2}
			\tkzDefPointBy[rotation= center O2 angle 60](E2)
			\tkzGetPoint{D2}
			\tkzDrawSegments(A2,B2 B2,C2 C2,D2 D2,E2 E2,F2 F2,A2)
			\draw(A2) node[above left=-0.1]{\footnotesize $C$};
			\draw(B2) node[above right=-0.1]{\footnotesize $A-C$};
			\draw(C2) node[right]{\footnotesize $|A-2C|$};
			\draw(D2) node[below right=-0.1]{\footnotesize $C$};
			\draw(E2) node[below left=-0.1]{\footnotesize $0$};
			\draw(F2) node[left]{\footnotesize $A$};
			\draw[->] (2,0)--(4,0); \draw[->](8,0)--(10,0);
			\tkzDrawPoints(A,B,C,D,E,F,A1,B1,C1,D1,E1,F1,A2,B2,C2,D2,E2,F2)
			\end{tikzpicture}
		\end{center}
		Ta thấy phép biến đổi này làm giảm thực sự tổng $A+C+0$ thành $C+|A-2C|< A+C$ ( do $C >0$ và $C < A$), trong khi vẫn giữ cho tổng lẻ, tức là nếu tiếp tục áp dụng biến đổi này, ta sẽ đến được trạng thái mà có $2$ số bằng $0$, lúc đó áp dụng phép biến đổi cho trường hợp trên, ta thu được kết quả. Vậy ta có điều phải chứng minh.
		
	}
	
\end{bt}
