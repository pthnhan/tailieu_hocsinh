\documentclass[12pt,a4paper]{extbook}
\usepackage{extsizes}
\usepackage{amsmath,amssymb,yhmath,mathrsfs,fontawesome}
\usepackage{fancyhdr}
\usepackage{enumerate}
\usepackage{tkz-euclide}
\usepackage{tikz-3dplot}
\usepackage{tikz,tkz-tab,tkz-linknodes}
\usetikzlibrary{shapes.geometric,arrows,calc,intersections,angles,patterns,snakes,positioning}
\usetkzobj{all}
\usepackage{pgfplots}
\usepgfplotslibrary{fillbetween}
\pgfplotsset{compat=1.9}
\usepackage[top=1.5cm, bottom=1.5cm, left=1.5cm, right=1cm] {geometry}
\usepackage[hidelinks,unicode]{hyperref}
\usepackage{currfile}
\usepackage[loigiai]{ex_test}
%CÁC GÓI, LỆNH VIẾT TẮT CẦN THÊM
%CẤU TRÚC TỰ LUẬN
\usepackage{framed}
\usepackage[many]{tcolorbox}
\newtheorem{bt}{\color{violet}\fontfamily{anttlc}\selectfont\MakeUppercase{Bài}}
\newtheorem{vd}{\color{violet}\fontfamily{anttlc}\selectfont\MakeUppercase{Ví dụ}}
\def\beginbox{\begin{tcolorbox}[colframe=blue,colback=white,breakable,boxrule=0.5pt,arc=0cm]}
	\def\endbox{\end{tcolorbox}}
\AtBeginEnvironment{vd}{
	\beginbox
	\renewcommand{\loigiai}[1]{
		\renewcommand{\immini}[2]{
			\setbox\imbox=\vbox{\hbox{##2}}
			\widthimmini=\wd\imbox
			\IMleftright{##1}{##2}
		}
		\endbox
		\begin{onlysolution}
			#1
		\end{onlysolution}
		\def\endbox{}
	}
}
\AtEndEnvironment{vd}{
	\endbox
}
\newtcolorbox[auto counter]{dang}[1]{
	fonttitle=\bfseries\upshape,fontupper=\itshape,
	colframe=white!50!black,colback=yellow!10!white,
	colbacktitle=green!20!white,coltitle=blue!75!black,
	rightrule=0.25pt,
	toprule=2.5pt,
	leftrule=0.25pt,
	bottomrule=2.5pt,
	adjusted title=center,%halign title=center,
	sharp corners, breakable, 
	title={\color{blue}\faFolderO \fontfamily{qag}\bfseries\selectfont\ DẠNG~\thetcbcounter.\ #1}
	\setcounter{bt}{0}
	\setcounter{vd}{0}
	\setcounter{subsubsection}{0}
	\addcontentsline{toc}{subsection}{\color{violet}Dạng~\thetcbcounter. #1}
}
\newenvironment{tomtat}{
	\begin{tcolorbox}[boxrule=0.5pt,arc=0mm,breakable,colback=white]
	}{\end{tcolorbox}}

\theorembodyfont{\it}
\newtheorem{dl}{\fontfamily{anttlc}\selectfont Định lí}
\theoremseparator{.}
\theorembodyfont{\rm}
\newtheorem{hq}{\fontfamily{anttlc}\selectfont Hệ quả}
\newtheorem{tc}{\fontfamily{anttlc}\selectfont Tính chất}
\newtheorem{dn}{\fontfamily{anttlc}\selectfont Định nghĩa}
\theoremstyle{nonumberplain}
\newtheorem{kn}{\fontfamily{anttlc}\selectfont Khái niệm}
\theoremseparator{}
\theorembodyfont{\it}
\usepackage{stackengine}
\usepackage{scalerel}
\newcommand\dangersign[1][2ex]{%
	\renewcommand\stacktype{L}%
	\scaleto{\stackon[1.3pt]{\color{red}$\triangle$}{\fontsize{4}{0}\selectfont !}}{#1}%
}
\newtheorem{note}{{\dangersign[3ex]}}
\newtheorem{nx}{Nhận xét.}

\newtcolorbox{luuy}[1][]{enhanced,breakable,
	before skip=2mm,after skip=3mm,
	boxrule=0.4pt,left=5mm,right=2mm,top=1mm,bottom=1mm,
	colback=yellow!50,
	colframe=yellow!20!black,
	sharp corners,rounded corners=southeast,arc is angular,arc=3mm,
	underlay={%
		\path[fill=tcbcol@back!80!black] ([yshift=3mm]interior.south east)--++(-0.4,-0.1)--++(0.1,-0.2);
		\path[draw=tcbcol@frame,shorten <=-0.05mm,shorten >=-0.05mm] ([yshift=3mm]interior.south east)--++(-0.4,-0.1)--++(0.1,-0.2);
		\path[fill=yellow!50!black,draw=none] (interior.south west) rectangle node[white]{\Huge\bfseries !} ([xshift=4mm]interior.north west);
	},
	drop fuzzy shadow, #1}
%Tiêu đề chương
\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{2}
\usepackage{titlesec}
\usepackage{titletoc}
%Làm mục lục
%\patchcmd{\tableofcontents}{\contentsname}{\color{black}MỤC LỤC}{}{}
\usepackage{ifoddpage}
\titlecontents{section}
[4em]{\sffamily}
{\color{blue}\contentslabel{2.3em}\color{blue}}{}
{\titlerule*[1000pc]{.}\contentspage\\\hspace*{-3em}\vspace*{2pt}%
	\color{blue}\rule{\dimexpr\textwidth-16pt\relax}{1pt}}

\titlecontents{lsection}
[5.8em]{\sffamily}
{\color{blue}\contentslabel{2.3em}\color{blue}}{}
{\titlerule*[1000pc]{.}\contentspage\\\hspace*{-5.8em}\vspace*{2pt}%
	\color{blue}\rule{\dimexpr\textwidth\relax}{1pt}}

\titlecontents{subsection}
[8em]{\sffamily}
{\color{violet}\contentslabel{2.3em}\color{violet}}{}
{\titlerule*[1000pc]{.}\contentspage\\\hspace*{-3em}\vspace*{2pt}%
	\color{violet}\rule{\dimexpr\textwidth-55pt\relax}{1pt}}

\titlecontents{lsubsection}
[6.5em]{\sffamily}
{\color{violet}\contentslabel{2.6em}\color{violet}}{}
{\titlerule*[1000pc]{.}\contentspage\\\hspace*{-5.2em}\vspace*{2pt}%
	\color{violet}\rule{\dimexpr\textwidth -13pt\relax}{1pt}}



\makeatletter
\renewcommand*\l@part[2]{%
	\ifnum \c@tocdepth >\m@ne
	\addpenalty{-\@highpenalty}%
	\vskip 1.0em \@plus\p@
	\setlength\@tempdima{1.5em}%
	\begingroup
	\parindent \z@ \rightskip \@pnumwidth
	\parfillskip -\@pnumwidth
	\leavevmode
	\advance\leftskip\@tempdima
	\hskip -\leftskip
	\colorbox{violet}{\strut%
		\makebox[\dimexpr\textwidth-1\fboxsep-6pt\relax][l]{%
			%\fontsize{12pt}{1pt}
			\color{white}\bfseries\fontfamily{qag}\selectfont\hspace*{0.3\textwidth} PHẦN #1%
			\nobreak\hfill\nobreak\hb@xt@\@pnumwidth{\hss #2}}}\par\smallskip
	\penalty\@highpenalty
	\endgroup
	\fi}


\renewcommand*\l@chapter[2]{%
	\ifnum \c@tocdepth >\m@ne
	\addpenalty{-\@highpenalty}%
	\vskip 1.0em \@plus\p@
	\setlength\@tempdima{1.5em}%
	\begingroup
	\parindent \z@ \rightskip \@pnumwidth
	\parfillskip -\@pnumwidth
	\leavevmode
	\advance\leftskip\@tempdima
	\hskip -\leftskip
	\colorbox{violet!80}{\strut%
		\makebox[\dimexpr\textwidth-1\fboxsep-6pt\relax][l]{%
			\sffamily%\fontsize{12pt}{1pt}
			\color{white}\bfseries\selectfont CHƯƠNG #1%
			\nobreak\hfill\nobreak\hb@xt@\@pnumwidth{\hss #2}}}\par\smallskip
	\penalty\@highpenalty
	\endgroup
	\fi}

\renewcommand\thesection{\@arabic\c@section}
\renewcommand\thesubsection{\@Alph\c@subsection}
\renewcommand\thesubsubsection{\@arabic\c@subsubsection}


\titleformat{\part}[display]
{\Large\bfseries\color{red!50!blue}}{
	\centering
	\begin{tikzpicture}
	\fill[red!50!blue] (-1,-1) rectangle (1,1);
	\draw(0,1.5)node{\fontfamily{ccr}\selectfont\Large PHẦN};
	\draw(0,0)node{\color{white}\fontsize{60pt}{1pt}\selectfont\thepart};
	\end{tikzpicture}
}
{0.5em}
{\titlerule[2.5pt]\vskip3pt\titlerule\vskip4pt\centering\fontsize{60pt}{1pt}\fontfamily{qhv}\selectfont\MakeUppercase}

\titlespacing{\chapter}{0pt}{-10pt}{20pt}
\titleformat{\chapter}
{\Large\bfseries\color{red!50!blue}}{\begin{tikzpicture}[remember picture,overlay]
	\draw[double,thick,line join=round,green!50!blue] (0,0)node[above right]{\color{red!50!blue}\fontfamily{qag}\selectfont CHƯƠNG \fontsize{40 pt}{1pt}\selectfont\thechapter\ }--(4,0)--(5,1.2)--(\textwidth,1.2);
	\end{tikzpicture}
}
{5cm}
{\fontsize{23pt}{1pt}\fontfamily{qhv}\selectfont\MakeUppercase}
\titleformat{\section}{\fontfamily{qag}\selectfont\color{blue}\centering\scshape\Large\bfseries}{BÀI \fontsize{25 pt}{1pt}\selectfont\thesection.}{-1cm}{
	\setcounter{vd}{0}
	\setcounter{ex}{0}
	\setcounter{bt}{0}
	\setcounter{dl}{0}
	\setcounter{dn}{0}
	\setcounter{hq}{0}
	\setcounter{tc}{0}
	\setcounter{\tcbcounter}{0}\fontsize{18pt}{1pt}\fontfamily{qag}\selectfont\color{blue}\MakeUppercase
}

\titleformat{\subsection}{\large\bfseries\fontfamily{qag}\selectfont\color{violet}}{
	\fontfamily{qag}\large\selectfont\hspace*{-3ex}\thesubsection.\ 
}{0ex}{\bfseries\fontfamily{qag}\selectfont\color{violet}\MakeUppercase
}

\titleformat{\subsubsection}{\large\fontfamily{qag}\selectfont\color{violet}}{\thesubsubsection.\ }{0em}{\fontfamily{qag}\selectfont\color{violet}
}

\usepackage{esvect}
\def\vec{\vv}
\def\overrightarrow{\vv}


%HẾT CẤU TRÚC TỰ LUẬN
\newcommand{\hoac}[1]{\left[\begin{aligned}#1\end{aligned}\right.}
\newcommand{\heva}[1]{\left\{\begin{aligned}#1\end{aligned}\right.}
\renewcommand{\loigiaiEX}{\fontfamily{qag}\selectfont\color{violet}\faPencilSquareO~Lời giải}
\renewcommand\labelitemi{\faCheckSquareO}
\renewcommand\labelitemii{$\bullet$}
\renewcommand{\labelenumi}{\circled{\small\fontfamily{lmss}\bfseries\selectfont\arabic{enumi}}}
\newcounter{CircLabel}
\newcommand*\CircLabel{%
	\refstepcounter{CircLabel}%
	\hskip1em\llap{\circled{\small\fontfamily{lmss}\bfseries\selectfont\arabic{CircLabel}}}}%
\NewEnviron{circ_enum}[1][]{%
	\hfill
	\setcounter{CircLabel}{0}
	\def\tempbegin{\begin{taskEX}[label=\CircLabel](#1)}%
		\expandafter\tempbegin\BODY
	\end{taskEX}
}

\setlistsEX{label=\CircLabel}

\AtBeginEnvironment{listEX}{\setcounter{CircLabel}{0}}
\AtBeginEnvironment{enumEX}{\setcounter{CircLabel}{0}}
\usepackage[final]{pdfpages}%chèn trang PDF
\begin{document}
% 	\hideenviron{dapso}
%	\hideansEX{bt}% luôn ẩn lời giải
%	\hideansEX{ex}% luôn ẩn lời giải
%	\dotlineans{10}{ex}% luôn ẩn lời giải và hiện 5 dòng kẻ
%	\dotlineans{5}{bt}% luôn ẩn lời giải và hiện 5 dòng kẻ
% 	\dotlinefull{bt}
\pagenumbering{gobble}
\includepdf[pages=-]{Bia}
\tableofcontents
\pagenumbering{arabic}
\part{Đại số}
\chapter{Phép nhân và phép chia các đa thức}
\input{data/8D3-1-2-3}
\input{data/8D3-4-5}
\input{data/8D3-6-7-8}
\chapter{Bất phương trình bậc nhất một ẩn}
\input{data/8D4-1-2-3-4}
\input{data/8D4-5-6}

\part{Hình học}
\chapter{Tam giác đồng dạng}
\input{data/8H3-1-2}
\input{data/8H3-3-4-5}
\input{data/8H3-6-7}
\input{data/8H3-8-9}
\input{data/8H3-10}
\chapter{Hình lăng trụ đứng Hình chóp đều}
\input{data/8H4-5-6-7-8-9}
\input{data/8H4-10}
\end{document}
