\documentclass[12pt,a4paper,twoside]{book}
\usepackage{amsmath,amssymb}
\usepackage{xlop,polynom}
\usepackage{fontawesome}
\usepackage{icomma}
\usepackage{fancyhdr}
\usepackage{enumerate}
\usepackage{tkz-euclide}
\usepackage{tikz-3dplot}
\usepackage{tikz,tkz-tab,tkz-linknodes}
\usetikzlibrary{shapes.geometric,arrows,calc,intersections,angles,patterns,snakes}
\usetkzobj{all}
\usepackage{pgfplots}
\usepgfplotslibrary{fillbetween}
\pgfplotsset{compat=1.9}
\usepackage[top=1.5cm, bottom=1.5cm, left=2.0cm, right=2.0cm] {geometry}
\usepackage[colorlinks=true,linkcolor=blue,urlcolor=black,unicode]{hyperref}
\usepackage{bookmark}
%thêm gói
\makeatletter
\newcommand\xleftrightarrow[2][]{%
	\ext@arrow 9999{\longleftrightarrowfill@}{#1}{#2}}
\newcommand\longleftrightarrowfill@{%
	\arrowfill@\leftarrow\relbar\rightarrow}
\makeatother

%\usepackage[hidelinks,unicode]{hyperref}
\usepackage[loigiai]{ex_test}
%\usepackage[dethi]{ex_test}
\usepackage[framemethod=TikZ]{mdframed}
\theoremstyle{explain}
\renewtheorem{ex}{\color{violet}Câu}
%CÁC GÓI, LỆNH VIẾT TẮT CẦN THÊM
\usepackage{esvect}
\def\vec{\protect\vv}
\def\overrightarrow{\protect\vv}
%Lệnh của gói mathrsfs
\DeclareSymbolFont{rsfs}{U}{rsfs}{m}{n}
\DeclareSymbolFontAlphabet{\mathscr}{rsfs}
%Lệnh cung
\DeclareSymbolFont{largesymbols}{OMX}{yhex}{m}{n}
\DeclareMathAccent{\wideparen}{\mathord}{largesymbols}{"F3}
%Lệnh song song
\DeclareSymbolFont{symbolsC}{U}{txsyc}{m}{n}
\DeclareMathSymbol{\varparallel}{\mathrel}{symbolsC}{9}
\DeclareMathSymbol{\parallel}{\mathrel}{symbolsC}{9}
%Hệ
\newcommand{\hoac}[1]{ 
\left[\begin{aligned}#1\end{aligned}\right.}
\newcommand{\heva}[1]{
\left\{\begin{aligned}#1\end{aligned}\right.}
%CẤU TRÚC TỰ LUẬN
\usepackage{framed}
\usepackage[most]{tcolorbox}
\newtheorem{bt}{\color{violet}Bài}
\newtheorem{vn}{VN}
\newtheorem{vd}{\color{violet}Ví dụ}
\theorembodyfont{\it}
\newtheorem{dl}{Định lí}
\newtheorem{md}{Mệnh đề}
\newtheorem{hq}{Hệ quả}
\theoremseparator{.}
\theorembodyfont{\rm}
\newtheorem{dn}{Định nghĩa}
\newtheorem{nx}{Nhận xét}
\newtheorem{tc}{Tính chất}
\theoremstyle{nonumberplain}
\newtheorem{kn}{Khái niệm}
\newtheorem{phantich}{\color{cyan}\faQuestionCircle\ \sc Phân tích}
\AtEndEnvironment{phantich}{{\par\noindent\color{red} \faMailReply\ \sc Quay trở lại bài toán. \vspace*{-0.3\baselineskip}}}
\def\beginbox{\begin{tcolorbox}[colframe=blue,colback=white,breakable]}
\def\endbox{\end{tcolorbox}}
\AtBeginEnvironment{vd}{
\beginbox
\renewcommand{\loigiai}[1]{
\labelex
\def\labelex{}
\endbox
\begin{onlysolution}
#1
\end{onlysolution}
\def\endbox{}
}
}
\AtEndEnvironment{vd}{
\labelex
\endbox
}
\AtEndEnvironment{bt}{
\labelex
}
%Dạng toán
\newcounter{dang}\setcounter{dang}{0}
\renewcommand{\thedang}{\arabic{dang}}
\newenvironment{dang}[1][]{%
	\refstepcounter{dang}%
	\ifstrempty{#1}%
	{\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=0pt]
				\node[anchor=east,rectangle,fill=cyan]
				{\color{white}\strut \faFolderOpen\ Dạng~\thedang};}}
	}%
	{\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=0pt,text width=\textwidth-3\fboxsep]
				\node[anchor=east,rectangle,fill=cyan]
				{\color{white}\strut \faFolderOpen\ Dạng~\thedang.~#1};}}%
	}%
	\mdfsetup{innertopmargin=10pt,linecolor=blue!20,%
		linewidth=2pt,topline=true,%
		frametitleaboveskip=-\ht\strutbox
	}
	\begin{mdframed}[]\relax%
	\addcontentsline{toc}{subsection}{Dạng~\thedang.\ #1}
}
{\end{mdframed}}
%
\newtcolorbox{note}[1][]{enhanced,
before skip=2mm,after skip=3mm,
boxrule=0.4pt,left=4mm,right=2mm,top=1mm,bottom=1mm,
colback=yellow!50,
colframe=yellow!20!black,
sharp corners,rounded corners=southeast,arc is angular,arc=3mm,
underlay={%
\path[fill=tcbcol@back!80!black] ([yshift=3mm]interior.south east)--++(-0.4,-0.1)--++(0.1,-0.2);
\path[draw=tcbcol@frame,shorten <=-0.05mm,shorten >=-0.05mm] ([yshift=3mm]interior.south east)--++(-0.4,-0.1)--++(0.1,-0.2);
\path[fill=yellow!50!black,draw=none] (interior.south west) rectangle node[white]{\Huge\bfseries !} ([xshift=4mm]interior.north west);
},
drop fuzzy shadow,#1}
%HẾT CẤU TRÚC TỰ LUẬN
% Định nghĩa tick
\def\tickEX{\color{blue}\faArrowCircleRight}
%Tương thích môi trường liệt kê
\listenumerate{ex,bt,vd,dl,dn,vn,nx,tc,phantich}
\renewcommand{\labelenumi}{\alph{enumi})}
%Bài tập về nhà
\newcounter{vnso}
\def\vnso{\stepcounter{vnso}{\arabic{vnso}}}
\def\btvn{
\setcounter{vn}{0}
\newpage
\begin{center}
\textbf{BÀI TẬP VỀ NHÀ SỐ \vnso}
\end{center}
\begin{center}
\begin{tabular}{p{0.5\textwidth}p{0.47\textwidth}}
Họ và tên:\dotfill&Lớp: \dotfill\\
Ngày \dots\dots\dots\dots tháng \dotfill năm \the\year&Chữ kí PHHS:\dotfill
\end{tabular}
\end{center}
}
%
%\usepackage{background}
%\usepackage{ifoddpage}
%\backgroundsetup{%
%	scale=1,       %% change accordingly
%	angle=0,       %% change accordingly
%	opacity=.7,    %% change accordingly
%	color =white!80!black,%blue!55,  %% change accordingly
%	contents={
%		\checkoddpage
%		\ifoddpage
%		{\begin{tikzpicture}[remember picture,overlay,scale=1]
%			\node[rotate=90,font=\fontsize{20}{0}\selectfont] at ($(current page.east)+(-1.0cm,0)$) {\LaTeX\, by \textsc{NHÓM W-T-TEX-BEGINNING}};    ***How can I put my image to upper right corner of each image.***
%			\end{tikzpicture}}
%		\else
%		{\begin{tikzpicture}[remember picture,overlay,scale=1]
%			\node[rotate=90,font=\fontsize{20}{0}\selectfont] at ($(current page.west)+(1.0cm,0)$) {\LaTeX\, by \textsc{NHÓM W-T-TEX-BEGINNING}};    ***How can I put my image to upper right corner of each image.***
%			\end{tikzpicture}}
%		\fi
%	}
%}
%
%\usepackage{titlesec}
%\renewcommand{\labelenumi}{\alph{enumi})}
%\renewcommand\thesection{\@arabic\c@section}
%
%\titleformat{\section}{\selectfont\color{red!50!blue}\centering\scshape\Large\bfseries}{\S\thesection. \quad  }{-1.5em}{
%}
%\titlespacing*{\section}
%{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
%Reset lại bộ đếm qua các section
%Reset lại bộ đếm qua các section
\renewcommand\section{%
	\setcounter{vd}{0}\setcounter{dang}{0}%
	\setcounter{bt}{0}\setcounter{dn}{0}%
	\setcounter{dl}{0}\setcounter{md}{0}%
	\setcounter{hq}{0}\setcounter{nx}{0}%
	\setcounter{tc}{0}%
	\@startsection {section}{1}{\z@}%
	{-3.5ex \@plus -1ex \@minus -.2ex}%
	{2.3ex \@plus.2ex}%
	{\normalfont\Large\bfseries}}

\begin{document}
%	\tableofcontents
\Opensolutionfile{ans}[ans/ans01]
\input{1-7}
\input{8-14}
\input{15-21}%Khai báo thêm lệnh
\input{22-28}
\input{36-42}
\input{43-49}
\input{50-56}
\input{57-63}
\input{64-70}
\input{71-77}
\input{85-91}
\input{92-98}
\input{106-112}
\input{113-119}
\input{120-126}
\input{134-140}
\input{141-147}
\input{148-154}
\input{155-161}
\input{176-182}
\input{183-188}
\input{189-194}
\input{195-200}
\input{201-206}
\input{207-212}
\input{213-218}

\Closesolutionfile{ans}
\newpage

\begin{center}
	\textbf{ĐÁP ÁN}
\end{center}

\begin{multicols}{10}
	\input{ans/ans01} 
\end{multicols}

\end{document}